2025-04-02 02:08:29,939 [INFO] {'data': {'benchmark': 'facebase/benchmarks/Adience.yaml', 'img_dir': '../datasets/', 'output_dir': 'facebase/results/', 'data_dir': 'facebase/data/'}, 'heads': [{'tag': 'age', 'type': 'cjs', 'attribute': 'age', 'labels': [[0], [1], [2], [3], [4], [5], [6], [7]], 'weight': 1, 'metric': ['mae', 'cs5'], 'visual_metric': [{'tag': 'mae'}, {'tag': 'bias'}, {'tag': 'prc', 'target_class': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], 'target_class_name': 'child 0-17', 'target_class_prior': [0.1, 0.2, 0.3]}]}], 'model': {'architecture': 'resnet50', 'use_pretrained': True, 'input_size': [256, 256]}, 'optimizer': {'num_workers': 8, 'num_epochs': 10, 'batch_size': 100, 'improve_patience': 50, 'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'algo': 'adam', 'use_amp': True}, 'preprocess': {'bbox_extension': [0, 0], 'input_extension': [0.05, 0.05], 'trn': {'path': 'lib/augmentation_configs/256x256/jitter+hflip.json'}, 'val': {'path': 'lib/augmentation_configs/256x256/resize_normalize.json'}}, 'training': {'mode': 'noisy', 'base_sigma': 0.75, 'alpha': 0.1, 'beta': 0.8}}
2025-04-02 02:08:29,948 [INFO] running on: cuda:0
2025-04-02 02:08:30,312 [INFO] Params to learn:
2025-04-02 02:08:30,312 [INFO] 	 model.conv1.weight, 9408
2025-04-02 02:08:30,312 [INFO] 	 model.bn1.weight, 64
2025-04-02 02:08:30,312 [INFO] 	 model.bn1.bias, 64
2025-04-02 02:08:30,312 [INFO] 	 model.layer1.0.conv1.weight, 4096
2025-04-02 02:08:30,312 [INFO] 	 model.layer1.0.bn1.weight, 64
2025-04-02 02:08:30,313 [INFO] 	 model.layer1.0.bn1.bias, 64
2025-04-02 02:08:30,313 [INFO] 	 model.layer1.0.conv2.weight, 36864
2025-04-02 02:08:30,313 [INFO] 	 model.layer1.0.bn2.weight, 64
2025-04-02 02:08:30,313 [INFO] 	 model.layer1.0.bn2.bias, 64
2025-04-02 02:08:30,313 [INFO] 	 model.layer1.0.conv3.weight, 16384
2025-04-02 02:08:30,313 [INFO] 	 model.layer1.0.bn3.weight, 256
2025-04-02 02:08:30,313 [INFO] 	 model.layer1.0.bn3.bias, 256
2025-04-02 02:08:30,313 [INFO] 	 model.layer1.0.downsample.0.weight, 16384
2025-04-02 02:08:30,313 [INFO] 	 model.layer1.0.downsample.1.weight, 256
2025-04-02 02:08:30,313 [INFO] 	 model.layer1.0.downsample.1.bias, 256
2025-04-02 02:08:30,313 [INFO] 	 model.layer1.1.conv1.weight, 16384
2025-04-02 02:08:30,313 [INFO] 	 model.layer1.1.bn1.weight, 64
2025-04-02 02:08:30,313 [INFO] 	 model.layer1.1.bn1.bias, 64
2025-04-02 02:08:30,313 [INFO] 	 model.layer1.1.conv2.weight, 36864
2025-04-02 02:08:30,313 [INFO] 	 model.layer1.1.bn2.weight, 64
2025-04-02 02:08:30,313 [INFO] 	 model.layer1.1.bn2.bias, 64
2025-04-02 02:08:30,313 [INFO] 	 model.layer1.1.conv3.weight, 16384
2025-04-02 02:08:30,313 [INFO] 	 model.layer1.1.bn3.weight, 256
2025-04-02 02:08:30,313 [INFO] 	 model.layer1.1.bn3.bias, 256
2025-04-02 02:08:30,313 [INFO] 	 model.layer1.2.conv1.weight, 16384
2025-04-02 02:08:30,313 [INFO] 	 model.layer1.2.bn1.weight, 64
2025-04-02 02:08:30,313 [INFO] 	 model.layer1.2.bn1.bias, 64
2025-04-02 02:08:30,313 [INFO] 	 model.layer1.2.conv2.weight, 36864
2025-04-02 02:08:30,313 [INFO] 	 model.layer1.2.bn2.weight, 64
2025-04-02 02:08:30,313 [INFO] 	 model.layer1.2.bn2.bias, 64
2025-04-02 02:08:30,313 [INFO] 	 model.layer1.2.conv3.weight, 16384
2025-04-02 02:08:30,313 [INFO] 	 model.layer1.2.bn3.weight, 256
2025-04-02 02:08:30,313 [INFO] 	 model.layer1.2.bn3.bias, 256
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.0.conv1.weight, 32768
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.0.bn1.weight, 128
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.0.bn1.bias, 128
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.0.conv2.weight, 147456
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.0.bn2.weight, 128
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.0.bn2.bias, 128
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.0.conv3.weight, 65536
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.0.bn3.weight, 512
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.0.bn3.bias, 512
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.0.downsample.0.weight, 131072
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.0.downsample.1.weight, 512
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.0.downsample.1.bias, 512
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.1.conv1.weight, 65536
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.1.bn1.weight, 128
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.1.bn1.bias, 128
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.1.conv2.weight, 147456
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.1.bn2.weight, 128
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.1.bn2.bias, 128
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.1.conv3.weight, 65536
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.1.bn3.weight, 512
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.1.bn3.bias, 512
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.2.conv1.weight, 65536
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.2.bn1.weight, 128
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.2.bn1.bias, 128
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.2.conv2.weight, 147456
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.2.bn2.weight, 128
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.2.bn2.bias, 128
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.2.conv3.weight, 65536
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.2.bn3.weight, 512
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.2.bn3.bias, 512
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.3.conv1.weight, 65536
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.3.bn1.weight, 128
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.3.bn1.bias, 128
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.3.conv2.weight, 147456
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.3.bn2.weight, 128
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.3.bn2.bias, 128
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.3.conv3.weight, 65536
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.3.bn3.weight, 512
2025-04-02 02:08:30,313 [INFO] 	 model.layer2.3.bn3.bias, 512
2025-04-02 02:08:30,313 [INFO] 	 model.layer3.0.conv1.weight, 131072
2025-04-02 02:08:30,313 [INFO] 	 model.layer3.0.bn1.weight, 256
2025-04-02 02:08:30,313 [INFO] 	 model.layer3.0.bn1.bias, 256
2025-04-02 02:08:30,313 [INFO] 	 model.layer3.0.conv2.weight, 589824
2025-04-02 02:08:30,313 [INFO] 	 model.layer3.0.bn2.weight, 256
2025-04-02 02:08:30,313 [INFO] 	 model.layer3.0.bn2.bias, 256
2025-04-02 02:08:30,313 [INFO] 	 model.layer3.0.conv3.weight, 262144
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.0.bn3.weight, 1024
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.0.bn3.bias, 1024
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.0.downsample.0.weight, 524288
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.0.downsample.1.weight, 1024
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.0.downsample.1.bias, 1024
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.1.conv1.weight, 262144
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.1.bn1.weight, 256
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.1.bn1.bias, 256
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.1.conv2.weight, 589824
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.1.bn2.weight, 256
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.1.bn2.bias, 256
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.1.conv3.weight, 262144
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.1.bn3.weight, 1024
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.1.bn3.bias, 1024
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.2.conv1.weight, 262144
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.2.bn1.weight, 256
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.2.bn1.bias, 256
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.2.conv2.weight, 589824
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.2.bn2.weight, 256
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.2.bn2.bias, 256
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.2.conv3.weight, 262144
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.2.bn3.weight, 1024
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.2.bn3.bias, 1024
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.3.conv1.weight, 262144
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.3.bn1.weight, 256
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.3.bn1.bias, 256
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.3.conv2.weight, 589824
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.3.bn2.weight, 256
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.3.bn2.bias, 256
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.3.conv3.weight, 262144
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.3.bn3.weight, 1024
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.3.bn3.bias, 1024
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.4.conv1.weight, 262144
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.4.bn1.weight, 256
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.4.bn1.bias, 256
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.4.conv2.weight, 589824
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.4.bn2.weight, 256
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.4.bn2.bias, 256
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.4.conv3.weight, 262144
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.4.bn3.weight, 1024
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.4.bn3.bias, 1024
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.5.conv1.weight, 262144
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.5.bn1.weight, 256
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.5.bn1.bias, 256
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.5.conv2.weight, 589824
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.5.bn2.weight, 256
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.5.bn2.bias, 256
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.5.conv3.weight, 262144
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.5.bn3.weight, 1024
2025-04-02 02:08:30,314 [INFO] 	 model.layer3.5.bn3.bias, 1024
2025-04-02 02:08:30,314 [INFO] 	 model.layer4.0.conv1.weight, 524288
2025-04-02 02:08:30,314 [INFO] 	 model.layer4.0.bn1.weight, 512
2025-04-02 02:08:30,314 [INFO] 	 model.layer4.0.bn1.bias, 512
2025-04-02 02:08:30,314 [INFO] 	 model.layer4.0.conv2.weight, 2359296
2025-04-02 02:08:30,314 [INFO] 	 model.layer4.0.bn2.weight, 512
2025-04-02 02:08:30,314 [INFO] 	 model.layer4.0.bn2.bias, 512
2025-04-02 02:08:30,314 [INFO] 	 model.layer4.0.conv3.weight, 1048576
2025-04-02 02:08:30,314 [INFO] 	 model.layer4.0.bn3.weight, 2048
2025-04-02 02:08:30,314 [INFO] 	 model.layer4.0.bn3.bias, 2048
2025-04-02 02:08:30,314 [INFO] 	 model.layer4.0.downsample.0.weight, 2097152
2025-04-02 02:08:30,314 [INFO] 	 model.layer4.0.downsample.1.weight, 2048
2025-04-02 02:08:30,314 [INFO] 	 model.layer4.0.downsample.1.bias, 2048
2025-04-02 02:08:30,314 [INFO] 	 model.layer4.1.conv1.weight, 1048576
2025-04-02 02:08:30,314 [INFO] 	 model.layer4.1.bn1.weight, 512
2025-04-02 02:08:30,314 [INFO] 	 model.layer4.1.bn1.bias, 512
2025-04-02 02:08:30,314 [INFO] 	 model.layer4.1.conv2.weight, 2359296
2025-04-02 02:08:30,314 [INFO] 	 model.layer4.1.bn2.weight, 512
2025-04-02 02:08:30,314 [INFO] 	 model.layer4.1.bn2.bias, 512
2025-04-02 02:08:30,314 [INFO] 	 model.layer4.1.conv3.weight, 1048576
2025-04-02 02:08:30,314 [INFO] 	 model.layer4.1.bn3.weight, 2048
2025-04-02 02:08:30,314 [INFO] 	 model.layer4.1.bn3.bias, 2048
2025-04-02 02:08:30,314 [INFO] 	 model.layer4.2.conv1.weight, 1048576
2025-04-02 02:08:30,314 [INFO] 	 model.layer4.2.bn1.weight, 512
2025-04-02 02:08:30,314 [INFO] 	 model.layer4.2.bn1.bias, 512
2025-04-02 02:08:30,314 [INFO] 	 model.layer4.2.conv2.weight, 2359296
2025-04-02 02:08:30,314 [INFO] 	 model.layer4.2.bn2.weight, 512
2025-04-02 02:08:30,314 [INFO] 	 model.layer4.2.bn2.bias, 512
2025-04-02 02:08:30,314 [INFO] 	 model.layer4.2.conv3.weight, 1048576
2025-04-02 02:08:30,314 [INFO] 	 model.layer4.2.bn3.weight, 2048
2025-04-02 02:08:30,314 [INFO] 	 model.layer4.2.bn3.bias, 2048
2025-04-02 02:08:30,314 [INFO] 	 heads.age.weight, 16384
2025-04-02 02:08:30,315 [INFO] 	 heads.age.bias, 8
2025-04-02 02:08:30,315 [INFO] Number of Learnable Parameters: 23524424

2025-04-02 02:08:30,315 [INFO] Model(
  (model): ResNet(
    (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (4): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (5): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (fc): Identity()
  )
  (heads): ModuleDict(
    (age): Linear(in_features=2048, out_features=8, bias=True)
  )
)
2025-04-02 02:08:30,316 [INFO] Number of trn data 10954
2025-04-02 02:08:30,316 [INFO] Number of val data 3069
2025-04-02 02:08:30,323 [INFO] Epoch 0/9
2025-04-02 02:08:30,323 [INFO] ----------------------------------------
2025-04-02 02:08:49,764 [INFO] [trn phase]
2025-04-02 02:08:49,773 [INFO] error: 2.0616 age_error:2.0616
2025-04-02 02:08:49,773 [INFO] loss: 0.6613 age_loss:0.6613
2025-04-02 02:08:55,711 [INFO] [val phase]
2025-04-02 02:08:55,711 [INFO] error: 1.7289 age_error:1.7289
2025-04-02 02:08:55,711 [INFO] loss: 0.5510 age_loss:0.5510
2025-04-02 02:08:55,711 [INFO] Best Epoch: 0
2025-04-02 02:08:56,176 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_0.pth
2025-04-02 02:08:56,213 [INFO] Epoch 1/9
2025-04-02 02:08:56,213 [INFO] ----------------------------------------
2025-04-02 02:09:15,282 [INFO] [trn phase]
2025-04-02 02:09:15,285 [INFO] error: 1.8145 age_error:1.8145
2025-04-02 02:09:15,285 [INFO] loss: 0.5250 age_loss:0.5250
2025-04-02 02:09:21,380 [INFO] [val phase]
2025-04-02 02:09:21,380 [INFO] error: 1.4832 age_error:1.4832
2025-04-02 02:09:21,381 [INFO] loss: 0.6004 age_loss:0.6004
2025-04-02 02:09:21,381 [INFO] Best Epoch: 1
2025-04-02 02:09:21,859 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_1.pth
2025-04-02 02:09:21,907 [INFO] Epoch 2/9
2025-04-02 02:09:21,907 [INFO] ----------------------------------------
2025-04-02 02:09:40,826 [INFO] [trn phase]
2025-04-02 02:09:40,828 [INFO] error: 1.6932 age_error:1.6932
2025-04-02 02:09:40,828 [INFO] loss: 0.4731 age_loss:0.4731
2025-04-02 02:09:46,942 [INFO] [val phase]
2025-04-02 02:09:46,942 [INFO] error: 1.5679 age_error:1.5679
2025-04-02 02:09:46,942 [INFO] loss: 0.5746 age_loss:0.5746
2025-04-02 02:09:46,942 [INFO] Best Epoch: 1
2025-04-02 02:09:47,435 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_2.pth
2025-04-02 02:09:47,550 [INFO] Epoch 3/9
2025-04-02 02:09:47,550 [INFO] ----------------------------------------
2025-04-02 02:10:06,270 [INFO] [trn phase]
2025-04-02 02:10:06,274 [INFO] error: 1.5457 age_error:1.5457
2025-04-02 02:10:06,274 [INFO] loss: 0.4169 age_loss:0.4169
2025-04-02 02:10:12,402 [INFO] [val phase]
2025-04-02 02:10:12,402 [INFO] error: 1.5627 age_error:1.5627
2025-04-02 02:10:12,402 [INFO] loss: 0.5747 age_loss:0.5747
2025-04-02 02:10:12,402 [INFO] Best Epoch: 1
2025-04-02 02:10:12,892 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_3.pth
2025-04-02 02:10:12,961 [INFO] Epoch 4/9
2025-04-02 02:10:12,961 [INFO] ----------------------------------------
2025-04-02 02:10:31,802 [INFO] [trn phase]
2025-04-02 02:10:31,813 [INFO] error: 1.3880 age_error:1.3880
2025-04-02 02:10:31,813 [INFO] loss: 0.3656 age_loss:0.3656
2025-04-02 02:10:37,919 [INFO] [val phase]
2025-04-02 02:10:37,919 [INFO] error: 1.6103 age_error:1.6103
2025-04-02 02:10:37,919 [INFO] loss: 0.6180 age_loss:0.6180
2025-04-02 02:10:37,919 [INFO] Best Epoch: 1
2025-04-02 02:10:38,416 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_4.pth
2025-04-02 02:10:38,495 [INFO] Epoch 5/9
2025-04-02 02:10:38,495 [INFO] ----------------------------------------
2025-04-02 02:10:57,300 [INFO] [trn phase]
2025-04-02 02:10:57,302 [INFO] error: 1.2377 age_error:1.2377
2025-04-02 02:10:57,302 [INFO] loss: 0.3140 age_loss:0.3140
2025-04-02 02:11:03,348 [INFO] [val phase]
2025-04-02 02:11:03,348 [INFO] error: 1.4542 age_error:1.4542
2025-04-02 02:11:03,348 [INFO] loss: 0.6533 age_loss:0.6533
2025-04-02 02:11:03,348 [INFO] Best Epoch: 5
2025-04-02 02:11:03,848 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_5.pth
2025-04-02 02:11:03,938 [INFO] Epoch 6/9
2025-04-02 02:11:03,938 [INFO] ----------------------------------------
2025-04-02 02:11:22,779 [INFO] [trn phase]
2025-04-02 02:11:22,781 [INFO] error: 1.0931 age_error:1.0931
2025-04-02 02:11:22,781 [INFO] loss: 0.2639 age_loss:0.2639
2025-04-02 02:11:28,939 [INFO] [val phase]
2025-04-02 02:11:28,939 [INFO] error: 1.4914 age_error:1.4914
2025-04-02 02:11:28,939 [INFO] loss: 0.6737 age_loss:0.6737
2025-04-02 02:11:28,939 [INFO] Best Epoch: 5
2025-04-02 02:11:29,434 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_6.pth
2025-04-02 02:11:29,590 [INFO] Epoch 7/9
2025-04-02 02:11:29,590 [INFO] ----------------------------------------
2025-04-02 02:11:48,327 [INFO] [trn phase]
2025-04-02 02:11:48,329 [INFO] error: 0.9895 age_error:0.9895
2025-04-02 02:11:48,329 [INFO] loss: 0.2327 age_loss:0.2327
2025-04-02 02:11:54,415 [INFO] [val phase]
2025-04-02 02:11:54,415 [INFO] error: 1.4285 age_error:1.4285
2025-04-02 02:11:54,415 [INFO] loss: 0.7000 age_loss:0.7000
2025-04-02 02:11:54,415 [INFO] Best Epoch: 7
2025-04-02 02:11:54,906 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_7.pth
2025-04-02 02:11:55,016 [INFO] Epoch 8/9
2025-04-02 02:11:55,017 [INFO] ----------------------------------------
2025-04-02 02:12:13,929 [INFO] [trn phase]
2025-04-02 02:12:13,940 [INFO] error: 0.9295 age_error:0.9295
2025-04-02 02:12:13,940 [INFO] loss: 0.2125 age_loss:0.2125
2025-04-02 02:12:20,041 [INFO] [val phase]
2025-04-02 02:12:20,041 [INFO] error: 1.4242 age_error:1.4242
2025-04-02 02:12:20,041 [INFO] loss: 0.7469 age_loss:0.7469
2025-04-02 02:12:20,041 [INFO] Best Epoch: 8
2025-04-02 02:12:20,523 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_8.pth
2025-04-02 02:12:20,645 [INFO] Epoch 9/9
2025-04-02 02:12:20,645 [INFO] ----------------------------------------
2025-04-02 02:12:39,318 [INFO] [trn phase]
2025-04-02 02:12:39,321 [INFO] error: 0.8334 age_error:0.8334
2025-04-02 02:12:39,321 [INFO] loss: 0.1853 age_loss:0.1853
2025-04-02 02:12:45,449 [INFO] [val phase]
2025-04-02 02:12:45,449 [INFO] error: 1.4558 age_error:1.4558
2025-04-02 02:12:45,449 [INFO] loss: 0.7807 age_loss:0.7807
2025-04-02 02:12:45,449 [INFO] Best Epoch: 8
2025-04-02 02:12:45,935 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_9.pth
2025-04-02 02:12:46,126 [INFO] Training complete in 4m 16s
2025-04-02 02:12:46,126 [INFO] Best epoch: 8
2025-04-02 02:13:15,453 [INFO] Model evalution:
2025-04-02 02:13:15,453 [INFO] [trn set]
2025-04-02 02:13:15,454 [INFO] age (mae): 0.7729
2025-04-02 02:13:15,454 [INFO] [val set]
2025-04-02 02:13:15,454 [INFO] age (mae): 1.4236
2025-04-02 02:13:15,454 [INFO] [tst set]
2025-04-02 02:13:15,454 [INFO] age (mae): 1.0935
2025-04-02 02:32:49,092 [INFO] {'data': {'benchmark': 'facebase/benchmarks/Adience.yaml', 'img_dir': '../datasets/', 'output_dir': 'facebase/results/', 'data_dir': 'facebase/data/'}, 'heads': [{'tag': 'age', 'type': 'cjs', 'attribute': 'age', 'labels': [[0], [1], [2], [3], [4], [5], [6], [7]], 'weight': 1, 'metric': ['mae', 'cs5'], 'visual_metric': [{'tag': 'mae'}, {'tag': 'bias'}, {'tag': 'prc', 'target_class': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], 'target_class_name': 'child 0-17', 'target_class_prior': [0.1, 0.2, 0.3]}]}], 'model': {'architecture': 'resnet50', 'use_pretrained': True, 'input_size': [256, 256]}, 'optimizer': {'num_workers': 8, 'num_epochs': 15, 'batch_size': 100, 'improve_patience': 50, 'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'algo': 'adam', 'use_amp': True}, 'preprocess': {'bbox_extension': [0, 0], 'input_extension': [0.05, 0.05], 'trn': {'path': 'lib/augmentation_configs/256x256/jitter+hflip.json'}, 'val': {'path': 'lib/augmentation_configs/256x256/resize_normalize.json'}}, 'training': {'mode': 'noisy', 'base_sigma': 0.75, 'alpha': 0.1, 'beta': 0.8}}
2025-04-02 02:32:49,112 [INFO] running on: cuda:0
2025-04-02 02:32:49,483 [INFO] Model(
  (model): ResNet(
    (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (4): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (5): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (fc): Identity()
  )
  (heads): ModuleDict(
    (age): Linear(in_features=2048, out_features=8, bias=True)
  )
)
2025-04-02 02:32:49,484 [INFO] Number of trn data 10954
2025-04-02 02:32:49,484 [INFO] Number of val data 3069
2025-04-02 02:32:49,796 [INFO] Epoch 10/14
2025-04-02 02:32:49,796 [INFO] ----------------------------------------
2025-04-02 02:33:09,311 [INFO] [trn phase]
2025-04-02 02:33:09,311 [INFO] error: 0.7345 age_error:0.7345
2025-04-02 02:33:09,311 [INFO] loss: 0.1448 age_loss:0.1448
2025-04-02 02:33:15,492 [INFO] [val phase]
2025-04-02 02:33:15,492 [INFO] error: 1.4282 age_error:1.4282
2025-04-02 02:33:15,492 [INFO] loss: 0.7198 age_loss:0.7198
2025-04-02 02:33:15,492 [INFO] Best Epoch: 8
2025-04-02 02:33:15,979 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_10.pth
2025-04-02 02:33:16,116 [INFO] Epoch 11/14
2025-04-02 02:33:16,116 [INFO] ----------------------------------------
2025-04-02 02:33:34,804 [INFO] [trn phase]
2025-04-02 02:33:34,806 [INFO] error: 0.6537 age_error:0.6537
2025-04-02 02:33:34,806 [INFO] loss: 0.1240 age_loss:0.1240
2025-04-02 02:33:40,844 [INFO] [val phase]
2025-04-02 02:33:40,845 [INFO] error: 1.3949 age_error:1.3949
2025-04-02 02:33:40,845 [INFO] loss: 0.7644 age_loss:0.7644
2025-04-02 02:33:40,845 [INFO] Best Epoch: 11
2025-04-02 02:33:41,335 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_11.pth
2025-04-02 02:33:41,487 [INFO] Epoch 12/14
2025-04-02 02:33:41,487 [INFO] ----------------------------------------
2025-04-02 02:33:59,918 [INFO] [trn phase]
2025-04-02 02:33:59,921 [INFO] error: 0.5890 age_error:0.5890
2025-04-02 02:33:59,921 [INFO] loss: 0.1057 age_loss:0.1057
2025-04-02 02:34:05,992 [INFO] [val phase]
2025-04-02 02:34:05,992 [INFO] error: 1.3399 age_error:1.3399
2025-04-02 02:34:05,992 [INFO] loss: 0.7792 age_loss:0.7792
2025-04-02 02:34:05,992 [INFO] Best Epoch: 12
2025-04-02 02:34:06,487 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_12.pth
2025-04-02 02:34:06,711 [INFO] Epoch 13/14
2025-04-02 02:34:06,711 [INFO] ----------------------------------------
2025-04-02 02:34:25,425 [INFO] [trn phase]
2025-04-02 02:34:25,428 [INFO] error: 0.5257 age_error:0.5257
2025-04-02 02:34:25,428 [INFO] loss: 0.0917 age_loss:0.0917
2025-04-02 02:34:31,546 [INFO] [val phase]
2025-04-02 02:34:31,546 [INFO] error: 1.3666 age_error:1.3666
2025-04-02 02:34:31,546 [INFO] loss: 0.7588 age_loss:0.7588
2025-04-02 02:34:31,546 [INFO] Best Epoch: 12
2025-04-02 02:34:32,046 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_13.pth
2025-04-02 02:34:32,225 [INFO] Epoch 14/14
2025-04-02 02:34:32,225 [INFO] ----------------------------------------
2025-04-02 02:34:50,842 [INFO] [trn phase]
2025-04-02 02:34:50,844 [INFO] error: 0.4881 age_error:0.4881
2025-04-02 02:34:50,845 [INFO] loss: 0.0805 age_loss:0.0805
2025-04-02 02:34:57,015 [INFO] [val phase]
2025-04-02 02:34:57,015 [INFO] error: 1.3337 age_error:1.3337
2025-04-02 02:34:57,015 [INFO] loss: 0.7558 age_loss:0.7558
2025-04-02 02:34:57,015 [INFO] Best Epoch: 14
2025-04-02 02:34:57,505 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_14.pth
2025-04-02 02:34:57,699 [INFO] Training complete in 2m 8s
2025-04-02 02:34:57,699 [INFO] Best epoch: 14
2025-04-02 02:35:27,123 [INFO] Model evalution:
2025-04-02 02:35:27,124 [INFO] [trn set]
2025-04-02 02:35:27,124 [INFO] age (mae): 0.4340
2025-04-02 02:35:27,124 [INFO] [val set]
2025-04-02 02:35:27,124 [INFO] age (mae): 1.3327
2025-04-02 02:35:27,124 [INFO] [tst set]
2025-04-02 02:35:27,124 [INFO] age (mae): 0.9258
2025-04-02 02:46:25,990 [INFO] {'data': {'benchmark': 'facebase/benchmarks/Adience.yaml', 'img_dir': '../datasets/', 'output_dir': 'facebase/results/', 'data_dir': 'facebase/data/'}, 'heads': [{'tag': 'age', 'type': 'cjs', 'attribute': 'age', 'labels': [[0], [1], [2], [3], [4], [5], [6], [7]], 'weight': 1, 'metric': ['mae', 'cs5'], 'visual_metric': [{'tag': 'mae'}, {'tag': 'bias'}, {'tag': 'prc', 'target_class': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], 'target_class_name': 'child 0-17', 'target_class_prior': [0.1, 0.2, 0.3]}]}], 'model': {'architecture': 'resnet50', 'use_pretrained': True, 'input_size': [256, 256]}, 'optimizer': {'num_workers': 8, 'num_epochs': 20, 'batch_size': 100, 'improve_patience': 50, 'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'algo': 'adam', 'use_amp': True}, 'preprocess': {'bbox_extension': [0, 0], 'input_extension': [0.05, 0.05], 'trn': {'path': 'lib/augmentation_configs/256x256/jitter+hflip.json'}, 'val': {'path': 'lib/augmentation_configs/256x256/resize_normalize.json'}}, 'training': {'mode': 'noisy', 'base_sigma': 0.75, 'alpha': 0.1, 'beta': 0.8}}
2025-04-02 02:46:26,009 [INFO] running on: cuda:0
2025-04-02 02:46:26,356 [INFO] Model(
  (model): ResNet(
    (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (4): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (5): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (fc): Identity()
  )
  (heads): ModuleDict(
    (age): Linear(in_features=2048, out_features=8, bias=True)
  )
)
2025-04-02 02:46:26,357 [INFO] Number of trn data 10954
2025-04-02 02:46:26,357 [INFO] Number of val data 3069
2025-04-02 02:46:26,701 [INFO] Epoch 15/19
2025-04-02 02:46:26,701 [INFO] ----------------------------------------
2025-04-02 02:46:46,296 [INFO] [trn phase]
2025-04-02 02:46:46,296 [INFO] error: 0.3846 age_error:0.3846
2025-04-02 02:46:46,296 [INFO] loss: 0.0511 age_loss:0.0511
2025-04-02 02:46:52,460 [INFO] [val phase]
2025-04-02 02:46:52,460 [INFO] error: 1.3464 age_error:1.3464
2025-04-02 02:46:52,460 [INFO] loss: 0.7240 age_loss:0.7240
2025-04-02 02:46:52,460 [INFO] Best Epoch: 14
2025-04-02 02:46:52,940 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_15.pth
2025-04-02 02:46:53,146 [INFO] Epoch 16/19
2025-04-02 02:46:53,147 [INFO] ----------------------------------------
2025-04-02 02:47:11,598 [INFO] [trn phase]
2025-04-02 02:47:11,600 [INFO] error: 0.3369 age_error:0.3369
2025-04-02 02:47:11,600 [INFO] loss: 0.0432 age_loss:0.0432
2025-04-02 02:47:17,685 [INFO] [val phase]
2025-04-02 02:47:17,685 [INFO] error: 1.3369 age_error:1.3369
2025-04-02 02:47:17,685 [INFO] loss: 0.7713 age_loss:0.7713
2025-04-02 02:47:17,685 [INFO] Best Epoch: 14
2025-04-02 02:47:18,201 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_16.pth
2025-04-02 02:47:18,420 [INFO] Epoch 17/19
2025-04-02 02:47:18,421 [INFO] ----------------------------------------
2025-04-02 02:47:37,358 [INFO] [trn phase]
2025-04-02 02:47:37,358 [INFO] error: 0.2903 age_error:0.2903
2025-04-02 02:47:37,358 [INFO] loss: 0.0347 age_loss:0.0347
2025-04-02 02:47:43,412 [INFO] [val phase]
2025-04-02 02:47:43,412 [INFO] error: 1.3255 age_error:1.3255
2025-04-02 02:47:43,412 [INFO] loss: 0.8083 age_loss:0.8083
2025-04-02 02:47:43,412 [INFO] Best Epoch: 17
2025-04-02 02:47:43,970 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_17.pth
2025-04-02 02:47:44,206 [INFO] Epoch 18/19
2025-04-02 02:47:44,206 [INFO] ----------------------------------------
2025-04-02 02:48:02,623 [INFO] [trn phase]
2025-04-02 02:48:02,626 [INFO] error: 0.2647 age_error:0.2647
2025-04-02 02:48:02,626 [INFO] loss: 0.0314 age_loss:0.0314
2025-04-02 02:48:08,685 [INFO] [val phase]
2025-04-02 02:48:08,685 [INFO] error: 1.3337 age_error:1.3337
2025-04-02 02:48:08,685 [INFO] loss: 0.7425 age_loss:0.7425
2025-04-02 02:48:08,685 [INFO] Best Epoch: 17
2025-04-02 02:48:09,191 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_18.pth
2025-04-02 02:48:09,440 [INFO] Epoch 19/19
2025-04-02 02:48:09,440 [INFO] ----------------------------------------
2025-04-02 02:48:27,823 [INFO] [trn phase]
2025-04-02 02:48:27,826 [INFO] error: 0.2352 age_error:0.2352
2025-04-02 02:48:27,826 [INFO] loss: 0.0276 age_loss:0.0276
2025-04-02 02:48:33,865 [INFO] [val phase]
2025-04-02 02:48:33,865 [INFO] error: 1.3372 age_error:1.3372
2025-04-02 02:48:33,865 [INFO] loss: 0.7817 age_loss:0.7817
2025-04-02 02:48:33,865 [INFO] Best Epoch: 17
2025-04-02 02:48:34,357 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_19.pth
2025-04-02 02:48:34,618 [INFO] Training complete in 2m 8s
2025-04-02 02:48:34,618 [INFO] Best epoch: 17
2025-04-02 02:49:04,151 [INFO] Model evalution:
2025-04-02 02:49:04,151 [INFO] [trn set]
2025-04-02 02:49:04,152 [INFO] age (mae): 0.3947
2025-04-02 02:49:04,152 [INFO] [val set]
2025-04-02 02:49:04,152 [INFO] age (mae): 1.3255
2025-04-02 02:49:04,152 [INFO] [tst set]
2025-04-02 02:49:04,152 [INFO] age (mae): 0.9068
2025-04-02 03:00:06,823 [INFO] {'data': {'benchmark': 'facebase/benchmarks/Adience.yaml', 'img_dir': '../datasets/', 'output_dir': 'facebase/results/', 'data_dir': 'facebase/data/'}, 'heads': [{'tag': 'age', 'type': 'cjs', 'attribute': 'age', 'labels': [[0], [1], [2], [3], [4], [5], [6], [7]], 'weight': 1, 'metric': ['mae', 'cs5'], 'visual_metric': [{'tag': 'mae'}, {'tag': 'bias'}, {'tag': 'prc', 'target_class': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], 'target_class_name': 'child 0-17', 'target_class_prior': [0.1, 0.2, 0.3]}]}], 'model': {'architecture': 'resnet50', 'use_pretrained': True, 'input_size': [256, 256]}, 'optimizer': {'num_workers': 8, 'num_epochs': 25, 'batch_size': 100, 'improve_patience': 50, 'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'algo': 'adam', 'use_amp': True}, 'preprocess': {'bbox_extension': [0, 0], 'input_extension': [0.05, 0.05], 'trn': {'path': 'lib/augmentation_configs/256x256/jitter+hflip.json'}, 'val': {'path': 'lib/augmentation_configs/256x256/resize_normalize.json'}}, 'training': {'mode': 'noisy', 'base_sigma': 0.75, 'alpha': 0.1, 'beta': 0.8}}
2025-04-02 03:00:06,841 [INFO] running on: cuda:0
2025-04-02 03:00:07,212 [INFO] Model(
  (model): ResNet(
    (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (4): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (5): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (fc): Identity()
  )
  (heads): ModuleDict(
    (age): Linear(in_features=2048, out_features=8, bias=True)
  )
)
2025-04-02 03:00:07,212 [INFO] Number of trn data 10954
2025-04-02 03:00:07,212 [INFO] Number of val data 3069
2025-04-02 03:00:07,584 [INFO] Epoch 20/24
2025-04-02 03:00:07,584 [INFO] ----------------------------------------
2025-04-02 03:00:27,208 [INFO] [trn phase]
2025-04-02 03:00:27,208 [INFO] error: 0.2006 age_error:0.2006
2025-04-02 03:00:27,208 [INFO] loss: 0.0204 age_loss:0.0204
2025-04-02 03:00:33,475 [INFO] [val phase]
2025-04-02 03:00:33,476 [INFO] error: 1.3236 age_error:1.3236
2025-04-02 03:00:33,476 [INFO] loss: 0.7182 age_loss:0.7182
2025-04-02 03:00:33,476 [INFO] Best Epoch: 20
2025-04-02 03:00:33,953 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_20.pth
2025-04-02 03:00:34,226 [INFO] Epoch 21/24
2025-04-02 03:00:34,226 [INFO] ----------------------------------------
2025-04-02 03:00:52,836 [INFO] [trn phase]
2025-04-02 03:00:52,838 [INFO] error: 0.1821 age_error:0.1821
2025-04-02 03:00:52,838 [INFO] loss: 0.0181 age_loss:0.0181
2025-04-02 03:00:58,903 [INFO] [val phase]
2025-04-02 03:00:58,903 [INFO] error: 1.3043 age_error:1.3043
2025-04-02 03:00:58,903 [INFO] loss: 0.7715 age_loss:0.7715
2025-04-02 03:00:58,903 [INFO] Best Epoch: 21
2025-04-02 03:00:59,400 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_21.pth
2025-04-02 03:00:59,686 [INFO] Epoch 22/24
2025-04-02 03:00:59,686 [INFO] ----------------------------------------
2025-04-02 03:01:18,435 [INFO] [trn phase]
2025-04-02 03:01:18,437 [INFO] error: 0.1585 age_error:0.1585
2025-04-02 03:01:18,437 [INFO] loss: 0.0159 age_loss:0.0159
2025-04-02 03:01:24,527 [INFO] [val phase]
2025-04-02 03:01:24,527 [INFO] error: 1.3148 age_error:1.3148
2025-04-02 03:01:24,527 [INFO] loss: 0.7504 age_loss:0.7504
2025-04-02 03:01:24,527 [INFO] Best Epoch: 21
2025-04-02 03:01:25,024 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_22.pth
2025-04-02 03:01:25,388 [INFO] Epoch 23/24
2025-04-02 03:01:25,388 [INFO] ----------------------------------------
2025-04-02 03:01:43,827 [INFO] [trn phase]
2025-04-02 03:01:43,830 [INFO] error: 0.1555 age_error:0.1555
2025-04-02 03:01:43,830 [INFO] loss: 0.0153 age_loss:0.0153
2025-04-02 03:01:49,904 [INFO] [val phase]
2025-04-02 03:01:49,904 [INFO] error: 1.3236 age_error:1.3236
2025-04-02 03:01:49,904 [INFO] loss: 0.7138 age_loss:0.7138
2025-04-02 03:01:49,904 [INFO] Best Epoch: 21
2025-04-02 03:01:50,418 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_23.pth
2025-04-02 03:01:50,745 [INFO] Epoch 24/24
2025-04-02 03:01:50,745 [INFO] ----------------------------------------
2025-04-02 03:02:09,339 [INFO] [trn phase]
2025-04-02 03:02:09,342 [INFO] error: 0.1688 age_error:0.1688
2025-04-02 03:02:09,342 [INFO] loss: 0.0176 age_loss:0.0176
2025-04-02 03:02:15,416 [INFO] [val phase]
2025-04-02 03:02:15,416 [INFO] error: 1.3405 age_error:1.3405
2025-04-02 03:02:15,416 [INFO] loss: 0.7909 age_loss:0.7909
2025-04-02 03:02:15,416 [INFO] Best Epoch: 21
2025-04-02 03:02:15,909 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_24.pth
2025-04-02 03:02:16,251 [INFO] Training complete in 2m 9s
2025-04-02 03:02:16,251 [INFO] Best epoch: 21
2025-04-02 03:02:45,896 [INFO] Model evalution:
2025-04-02 03:02:45,896 [INFO] [trn set]
2025-04-02 03:02:45,896 [INFO] age (mae): 0.3785
2025-04-02 03:02:45,896 [INFO] [val set]
2025-04-02 03:02:45,896 [INFO] age (mae): 1.3007
2025-04-02 03:02:45,896 [INFO] [tst set]
2025-04-02 03:02:45,896 [INFO] age (mae): 0.9274
2025-04-02 03:13:49,298 [INFO] {'data': {'benchmark': 'facebase/benchmarks/Adience.yaml', 'img_dir': '../datasets/', 'output_dir': 'facebase/results/', 'data_dir': 'facebase/data/'}, 'heads': [{'tag': 'age', 'type': 'cjs', 'attribute': 'age', 'labels': [[0], [1], [2], [3], [4], [5], [6], [7]], 'weight': 1, 'metric': ['mae', 'cs5'], 'visual_metric': [{'tag': 'mae'}, {'tag': 'bias'}, {'tag': 'prc', 'target_class': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], 'target_class_name': 'child 0-17', 'target_class_prior': [0.1, 0.2, 0.3]}]}], 'model': {'architecture': 'resnet50', 'use_pretrained': True, 'input_size': [256, 256]}, 'optimizer': {'num_workers': 8, 'num_epochs': 30, 'batch_size': 100, 'improve_patience': 50, 'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'algo': 'adam', 'use_amp': True}, 'preprocess': {'bbox_extension': [0, 0], 'input_extension': [0.05, 0.05], 'trn': {'path': 'lib/augmentation_configs/256x256/jitter+hflip.json'}, 'val': {'path': 'lib/augmentation_configs/256x256/resize_normalize.json'}}, 'training': {'mode': 'noisy', 'base_sigma': 0.75, 'alpha': 0.1, 'beta': 0.8}}
2025-04-02 03:13:49,317 [INFO] running on: cuda:0
2025-04-02 03:13:49,701 [INFO] Model(
  (model): ResNet(
    (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (4): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (5): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (fc): Identity()
  )
  (heads): ModuleDict(
    (age): Linear(in_features=2048, out_features=8, bias=True)
  )
)
2025-04-02 03:13:49,701 [INFO] Number of trn data 10954
2025-04-02 03:13:49,701 [INFO] Number of val data 3069
2025-04-02 03:13:50,089 [INFO] Epoch 25/29
2025-04-02 03:13:50,089 [INFO] ----------------------------------------
2025-04-02 03:14:09,570 [INFO] [trn phase]
2025-04-02 03:14:09,570 [INFO] error: 0.1661 age_error:0.1661
2025-04-02 03:14:09,570 [INFO] loss: 0.0145 age_loss:0.0145
2025-04-02 03:14:15,749 [INFO] [val phase]
2025-04-02 03:14:15,749 [INFO] error: 1.3017 age_error:1.3017
2025-04-02 03:14:15,749 [INFO] loss: 0.6814 age_loss:0.6814
2025-04-02 03:14:15,749 [INFO] Best Epoch: 25
2025-04-02 03:14:16,241 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_25.pth
2025-04-02 03:14:16,582 [INFO] Epoch 26/29
2025-04-02 03:14:16,582 [INFO] ----------------------------------------
2025-04-02 03:14:34,958 [INFO] [trn phase]
2025-04-02 03:14:34,961 [INFO] error: 0.1559 age_error:0.1559
2025-04-02 03:14:34,961 [INFO] loss: 0.0139 age_loss:0.0139
2025-04-02 03:14:41,066 [INFO] [val phase]
2025-04-02 03:14:41,066 [INFO] error: 1.3190 age_error:1.3190
2025-04-02 03:14:41,066 [INFO] loss: 0.7365 age_loss:0.7365
2025-04-02 03:14:41,066 [INFO] Best Epoch: 25
2025-04-02 03:14:41,561 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_26.pth
2025-04-02 03:14:41,927 [INFO] Epoch 27/29
2025-04-02 03:14:41,927 [INFO] ----------------------------------------
2025-04-02 03:15:01,116 [INFO] [trn phase]
2025-04-02 03:15:01,116 [INFO] error: 0.1548 age_error:0.1548
2025-04-02 03:15:01,116 [INFO] loss: 0.0139 age_loss:0.0139
2025-04-02 03:15:07,195 [INFO] [val phase]
2025-04-02 03:15:07,195 [INFO] error: 1.3069 age_error:1.3069
2025-04-02 03:15:07,195 [INFO] loss: 0.7010 age_loss:0.7010
2025-04-02 03:15:07,195 [INFO] Best Epoch: 25
2025-04-02 03:15:07,753 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_27.pth
2025-04-02 03:15:08,130 [INFO] Epoch 28/29
2025-04-02 03:15:08,130 [INFO] ----------------------------------------
2025-04-02 03:15:26,431 [INFO] [trn phase]
2025-04-02 03:15:26,433 [INFO] error: 0.1504 age_error:0.1504
2025-04-02 03:15:26,433 [INFO] loss: 0.0130 age_loss:0.0130
2025-04-02 03:15:32,495 [INFO] [val phase]
2025-04-02 03:15:32,495 [INFO] error: 1.3112 age_error:1.3112
2025-04-02 03:15:32,495 [INFO] loss: 0.6986 age_loss:0.6986
2025-04-02 03:15:32,495 [INFO] Best Epoch: 25
2025-04-02 03:15:32,988 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_28.pth
2025-04-02 03:15:33,383 [INFO] Epoch 29/29
2025-04-02 03:15:33,383 [INFO] ----------------------------------------
2025-04-02 03:15:52,194 [INFO] [trn phase]
2025-04-02 03:15:52,197 [INFO] error: 0.1771 age_error:0.1771
2025-04-02 03:15:52,197 [INFO] loss: 0.0167 age_loss:0.0167
2025-04-02 03:15:58,249 [INFO] [val phase]
2025-04-02 03:15:58,249 [INFO] error: 1.3311 age_error:1.3311
2025-04-02 03:15:58,258 [INFO] loss: 0.7379 age_loss:0.7379
2025-04-02 03:15:58,258 [INFO] Best Epoch: 25
2025-04-02 03:15:58,756 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_29.pth
2025-04-02 03:15:59,155 [INFO] Training complete in 2m 9s
2025-04-02 03:15:59,155 [INFO] Best epoch: 25
2025-04-02 03:16:28,788 [INFO] Model evalution:
2025-04-02 03:16:28,788 [INFO] [trn set]
2025-04-02 03:16:28,788 [INFO] age (mae): 0.3794
2025-04-02 03:16:28,788 [INFO] [val set]
2025-04-02 03:16:28,788 [INFO] age (mae): 1.2890
2025-04-02 03:16:28,788 [INFO] [tst set]
2025-04-02 03:16:28,788 [INFO] age (mae): 0.9380
2025-04-02 03:27:32,977 [INFO] {'data': {'benchmark': 'facebase/benchmarks/Adience.yaml', 'img_dir': '../datasets/', 'output_dir': 'facebase/results/', 'data_dir': 'facebase/data/'}, 'heads': [{'tag': 'age', 'type': 'cjs', 'attribute': 'age', 'labels': [[0], [1], [2], [3], [4], [5], [6], [7]], 'weight': 1, 'metric': ['mae', 'cs5'], 'visual_metric': [{'tag': 'mae'}, {'tag': 'bias'}, {'tag': 'prc', 'target_class': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], 'target_class_name': 'child 0-17', 'target_class_prior': [0.1, 0.2, 0.3]}]}], 'model': {'architecture': 'resnet50', 'use_pretrained': True, 'input_size': [256, 256]}, 'optimizer': {'num_workers': 8, 'num_epochs': 35, 'batch_size': 100, 'improve_patience': 50, 'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'algo': 'adam', 'use_amp': True}, 'preprocess': {'bbox_extension': [0, 0], 'input_extension': [0.05, 0.05], 'trn': {'path': 'lib/augmentation_configs/256x256/jitter+hflip.json'}, 'val': {'path': 'lib/augmentation_configs/256x256/resize_normalize.json'}}, 'training': {'mode': 'noisy', 'base_sigma': 0.75, 'alpha': 0.1, 'beta': 0.8}}
2025-04-02 03:27:32,996 [INFO] running on: cuda:0
2025-04-02 03:27:33,372 [INFO] Model(
  (model): ResNet(
    (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (4): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (5): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (fc): Identity()
  )
  (heads): ModuleDict(
    (age): Linear(in_features=2048, out_features=8, bias=True)
  )
)
2025-04-02 03:27:33,372 [INFO] Number of trn data 10954
2025-04-02 03:27:33,372 [INFO] Number of val data 3069
2025-04-02 03:27:33,774 [INFO] Epoch 30/34
2025-04-02 03:27:33,774 [INFO] ----------------------------------------
2025-04-02 03:27:53,461 [INFO] [trn phase]
2025-04-02 03:27:53,461 [INFO] error: 0.1846 age_error:0.1846
2025-04-02 03:27:53,461 [INFO] loss: 0.0149 age_loss:0.0149
2025-04-02 03:27:59,719 [INFO] [val phase]
2025-04-02 03:27:59,719 [INFO] error: 1.3219 age_error:1.3219
2025-04-02 03:27:59,719 [INFO] loss: 0.6540 age_loss:0.6540
2025-04-02 03:27:59,719 [INFO] Best Epoch: 25
2025-04-02 03:28:00,206 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_30.pth
2025-04-02 03:28:00,618 [INFO] Epoch 31/34
2025-04-02 03:28:00,618 [INFO] ----------------------------------------
2025-04-02 03:28:19,078 [INFO] [trn phase]
2025-04-02 03:28:19,080 [INFO] error: 0.1829 age_error:0.1829
2025-04-02 03:28:19,080 [INFO] loss: 0.0138 age_loss:0.0138
2025-04-02 03:28:25,355 [INFO] [val phase]
2025-04-02 03:28:25,356 [INFO] error: 1.3327 age_error:1.3327
2025-04-02 03:28:25,356 [INFO] loss: 0.7061 age_loss:0.7061
2025-04-02 03:28:25,356 [INFO] Best Epoch: 25
2025-04-02 03:28:25,848 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_31.pth
2025-04-02 03:28:26,274 [INFO] Epoch 32/34
2025-04-02 03:28:26,274 [INFO] ----------------------------------------
2025-04-02 03:28:44,753 [INFO] [trn phase]
2025-04-02 03:28:44,753 [INFO] error: 0.1887 age_error:0.1887
2025-04-02 03:28:44,753 [INFO] loss: 0.0152 age_loss:0.0152
2025-04-02 03:28:50,809 [INFO] [val phase]
2025-04-02 03:28:50,809 [INFO] error: 1.3079 age_error:1.3079
2025-04-02 03:28:50,809 [INFO] loss: 0.6866 age_loss:0.6866
2025-04-02 03:28:50,809 [INFO] Best Epoch: 25
2025-04-02 03:28:51,304 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_32.pth
2025-04-02 03:28:51,818 [INFO] Epoch 33/34
2025-04-02 03:28:51,818 [INFO] ----------------------------------------
2025-04-02 03:29:10,434 [INFO] [trn phase]
2025-04-02 03:29:10,437 [INFO] error: 0.1945 age_error:0.1945
2025-04-02 03:29:10,437 [INFO] loss: 0.0176 age_loss:0.0176
2025-04-02 03:29:16,535 [INFO] [val phase]
2025-04-02 03:29:16,535 [INFO] error: 1.2900 age_error:1.2900
2025-04-02 03:29:16,535 [INFO] loss: 0.6908 age_loss:0.6908
2025-04-02 03:29:16,535 [INFO] Best Epoch: 33
2025-04-02 03:29:17,025 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_33.pth
2025-04-02 03:29:17,482 [INFO] Epoch 34/34
2025-04-02 03:29:17,482 [INFO] ----------------------------------------
2025-04-02 03:29:36,154 [INFO] [trn phase]
2025-04-02 03:29:36,157 [INFO] error: 0.2096 age_error:0.2096
2025-04-02 03:29:36,157 [INFO] loss: 0.0188 age_loss:0.0188
2025-04-02 03:29:42,204 [INFO] [val phase]
2025-04-02 03:29:42,204 [INFO] error: 1.4021 age_error:1.4021
2025-04-02 03:29:42,212 [INFO] loss: 0.7190 age_loss:0.7190
2025-04-02 03:29:42,213 [INFO] Best Epoch: 33
2025-04-02 03:29:42,704 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_34.pth
2025-04-02 03:29:43,175 [INFO] Training complete in 2m 10s
2025-04-02 03:29:43,175 [INFO] Best epoch: 33
2025-04-02 03:30:13,070 [INFO] Model evalution:
2025-04-02 03:30:13,070 [INFO] [trn set]
2025-04-02 03:30:13,070 [INFO] age (mae): 0.3431
2025-04-02 03:30:13,070 [INFO] [val set]
2025-04-02 03:30:13,070 [INFO] age (mae): 1.2616
2025-04-02 03:30:13,070 [INFO] [tst set]
2025-04-02 03:30:13,070 [INFO] age (mae): 0.8742
2025-04-02 03:41:20,251 [INFO] {'data': {'benchmark': 'facebase/benchmarks/Adience.yaml', 'img_dir': '../datasets/', 'output_dir': 'facebase/results/', 'data_dir': 'facebase/data/'}, 'heads': [{'tag': 'age', 'type': 'cjs', 'attribute': 'age', 'labels': [[0], [1], [2], [3], [4], [5], [6], [7]], 'weight': 1, 'metric': ['mae', 'cs5'], 'visual_metric': [{'tag': 'mae'}, {'tag': 'bias'}, {'tag': 'prc', 'target_class': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], 'target_class_name': 'child 0-17', 'target_class_prior': [0.1, 0.2, 0.3]}]}], 'model': {'architecture': 'resnet50', 'use_pretrained': True, 'input_size': [256, 256]}, 'optimizer': {'num_workers': 8, 'num_epochs': 40, 'batch_size': 100, 'improve_patience': 50, 'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'algo': 'adam', 'use_amp': True}, 'preprocess': {'bbox_extension': [0, 0], 'input_extension': [0.05, 0.05], 'trn': {'path': 'lib/augmentation_configs/256x256/jitter+hflip.json'}, 'val': {'path': 'lib/augmentation_configs/256x256/resize_normalize.json'}}, 'training': {'mode': 'noisy', 'base_sigma': 0.75, 'alpha': 0.1, 'beta': 0.8}}
2025-04-02 03:41:20,269 [INFO] running on: cuda:0
2025-04-02 03:41:20,656 [INFO] Model(
  (model): ResNet(
    (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (4): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (5): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (fc): Identity()
  )
  (heads): ModuleDict(
    (age): Linear(in_features=2048, out_features=8, bias=True)
  )
)
2025-04-02 03:41:20,657 [INFO] Number of trn data 10954
2025-04-02 03:41:20,657 [INFO] Number of val data 3069
2025-04-02 03:41:21,099 [INFO] Epoch 35/39
2025-04-02 03:41:21,099 [INFO] ----------------------------------------
2025-04-02 03:41:40,724 [INFO] [trn phase]
2025-04-02 03:41:40,724 [INFO] error: 0.2418 age_error:0.2418
2025-04-02 03:41:40,724 [INFO] loss: 0.0201 age_loss:0.0201
2025-04-02 03:41:46,908 [INFO] [val phase]
2025-04-02 03:41:46,908 [INFO] error: 1.3337 age_error:1.3337
2025-04-02 03:41:46,908 [INFO] loss: 0.6238 age_loss:0.6238
2025-04-02 03:41:46,908 [INFO] Best Epoch: 33
2025-04-02 03:41:47,403 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_35.pth
2025-04-02 03:41:47,878 [INFO] Epoch 36/39
2025-04-02 03:41:47,878 [INFO] ----------------------------------------
2025-04-02 03:42:06,215 [INFO] [trn phase]
2025-04-02 03:42:06,217 [INFO] error: 0.2295 age_error:0.2295
2025-04-02 03:42:06,217 [INFO] loss: 0.0179 age_loss:0.0179
2025-04-02 03:42:12,289 [INFO] [val phase]
2025-04-02 03:42:12,289 [INFO] error: 1.2750 age_error:1.2750
2025-04-02 03:42:12,289 [INFO] loss: 0.6756 age_loss:0.6756
2025-04-02 03:42:12,289 [INFO] Best Epoch: 36
2025-04-02 03:42:12,777 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_36.pth
2025-04-02 03:42:13,269 [INFO] Epoch 37/39
2025-04-02 03:42:13,269 [INFO] ----------------------------------------
2025-04-02 03:42:31,813 [INFO] [trn phase]
2025-04-02 03:42:31,816 [INFO] error: 0.2557 age_error:0.2557
2025-04-02 03:42:31,816 [INFO] loss: 0.0226 age_loss:0.0226
2025-04-02 03:42:37,871 [INFO] [val phase]
2025-04-02 03:42:37,871 [INFO] error: 1.3483 age_error:1.3483
2025-04-02 03:42:37,871 [INFO] loss: 0.7219 age_loss:0.7219
2025-04-02 03:42:37,871 [INFO] Best Epoch: 36
2025-04-02 03:42:38,369 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_37.pth
2025-04-02 03:42:38,948 [INFO] Epoch 38/39
2025-04-02 03:42:38,948 [INFO] ----------------------------------------
2025-04-02 03:42:57,431 [INFO] [trn phase]
2025-04-02 03:42:57,433 [INFO] error: 0.2561 age_error:0.2561
2025-04-02 03:42:57,434 [INFO] loss: 0.0260 age_loss:0.0260
2025-04-02 03:43:03,589 [INFO] [val phase]
2025-04-02 03:43:03,589 [INFO] error: 1.2972 age_error:1.2972
2025-04-02 03:43:03,589 [INFO] loss: 0.6853 age_loss:0.6853
2025-04-02 03:43:03,589 [INFO] Best Epoch: 36
2025-04-02 03:43:04,087 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_38.pth
2025-04-02 03:43:04,611 [INFO] Epoch 39/39
2025-04-02 03:43:04,612 [INFO] ----------------------------------------
2025-04-02 03:43:23,269 [INFO] [trn phase]
2025-04-02 03:43:23,269 [INFO] error: 0.2575 age_error:0.2575
2025-04-02 03:43:23,269 [INFO] loss: 0.0240 age_loss:0.0240
2025-04-02 03:43:29,339 [INFO] [val phase]
2025-04-02 03:43:29,339 [INFO] error: 1.3454 age_error:1.3454
2025-04-02 03:43:29,339 [INFO] loss: 0.6584 age_loss:0.6584
2025-04-02 03:43:29,339 [INFO] Best Epoch: 36
2025-04-02 03:43:29,834 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_39.pth
2025-04-02 03:43:30,368 [INFO] Training complete in 2m 10s
2025-04-02 03:43:30,368 [INFO] Best epoch: 36
2025-04-02 03:44:00,004 [INFO] Model evalution:
2025-04-02 03:44:00,004 [INFO] [trn set]
2025-04-02 03:44:00,004 [INFO] age (mae): 0.3561
2025-04-02 03:44:00,004 [INFO] [val set]
2025-04-02 03:44:00,004 [INFO] age (mae): 1.2108
2025-04-02 03:44:00,004 [INFO] [tst set]
2025-04-02 03:44:00,004 [INFO] age (mae): 0.8820
2025-04-02 03:55:10,438 [INFO] {'data': {'benchmark': 'facebase/benchmarks/Adience.yaml', 'img_dir': '../datasets/', 'output_dir': 'facebase/results/', 'data_dir': 'facebase/data/'}, 'heads': [{'tag': 'age', 'type': 'cjs', 'attribute': 'age', 'labels': [[0], [1], [2], [3], [4], [5], [6], [7]], 'weight': 1, 'metric': ['mae', 'cs5'], 'visual_metric': [{'tag': 'mae'}, {'tag': 'bias'}, {'tag': 'prc', 'target_class': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], 'target_class_name': 'child 0-17', 'target_class_prior': [0.1, 0.2, 0.3]}]}], 'model': {'architecture': 'resnet50', 'use_pretrained': True, 'input_size': [256, 256]}, 'optimizer': {'num_workers': 8, 'num_epochs': 45, 'batch_size': 100, 'improve_patience': 50, 'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'algo': 'adam', 'use_amp': True}, 'preprocess': {'bbox_extension': [0, 0], 'input_extension': [0.05, 0.05], 'trn': {'path': 'lib/augmentation_configs/256x256/jitter+hflip.json'}, 'val': {'path': 'lib/augmentation_configs/256x256/resize_normalize.json'}}, 'training': {'mode': 'noisy', 'base_sigma': 0.75, 'alpha': 0.1, 'beta': 0.8}}
2025-04-02 03:55:10,456 [INFO] running on: cuda:0
2025-04-02 03:55:10,841 [INFO] Model(
  (model): ResNet(
    (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (4): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (5): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (fc): Identity()
  )
  (heads): ModuleDict(
    (age): Linear(in_features=2048, out_features=8, bias=True)
  )
)
2025-04-02 03:55:10,841 [INFO] Number of trn data 10954
2025-04-02 03:55:10,841 [INFO] Number of val data 3069
2025-04-02 03:55:11,308 [INFO] Epoch 40/44
2025-04-02 03:55:11,309 [INFO] ----------------------------------------
2025-04-02 03:55:30,967 [INFO] [trn phase]
2025-04-02 03:55:30,967 [INFO] error: 0.3401 age_error:0.3401
2025-04-02 03:55:30,967 [INFO] loss: 0.0352 age_loss:0.0352
2025-04-02 03:55:37,189 [INFO] [val phase]
2025-04-02 03:55:37,189 [INFO] error: 1.3773 age_error:1.3773
2025-04-02 03:55:37,189 [INFO] loss: 0.6349 age_loss:0.6349
2025-04-02 03:55:37,189 [INFO] Best Epoch: 36
2025-04-02 03:55:37,677 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_40.pth
2025-04-02 03:55:38,228 [INFO] Epoch 41/44
2025-04-02 03:55:38,228 [INFO] ----------------------------------------
2025-04-02 03:55:56,727 [INFO] [trn phase]
2025-04-02 03:55:56,729 [INFO] error: 0.3671 age_error:0.3671
2025-04-02 03:55:56,729 [INFO] loss: 0.0444 age_loss:0.0444
2025-04-02 03:56:02,832 [INFO] [val phase]
2025-04-02 03:56:02,833 [INFO] error: 1.3594 age_error:1.3594
2025-04-02 03:56:02,833 [INFO] loss: 0.7063 age_loss:0.7063
2025-04-02 03:56:02,833 [INFO] Best Epoch: 36
2025-04-02 03:56:03,331 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_41.pth
2025-04-02 03:56:03,889 [INFO] Epoch 42/44
2025-04-02 03:56:03,889 [INFO] ----------------------------------------
2025-04-02 03:56:22,580 [INFO] [trn phase]
2025-04-02 03:56:22,583 [INFO] error: 0.3905 age_error:0.3905
2025-04-02 03:56:22,583 [INFO] loss: 0.0504 age_loss:0.0504
2025-04-02 03:56:28,813 [INFO] [val phase]
2025-04-02 03:56:28,813 [INFO] error: 1.3382 age_error:1.3382
2025-04-02 03:56:28,813 [INFO] loss: 0.6569 age_loss:0.6569
2025-04-02 03:56:28,813 [INFO] Best Epoch: 36
2025-04-02 03:56:29,314 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_42.pth
2025-04-02 03:56:29,966 [INFO] Epoch 43/44
2025-04-02 03:56:29,966 [INFO] ----------------------------------------
2025-04-02 03:56:48,522 [INFO] [trn phase]
2025-04-02 03:56:48,525 [INFO] error: 0.4077 age_error:0.4077
2025-04-02 03:56:48,525 [INFO] loss: 0.0491 age_loss:0.0491
2025-04-02 03:56:54,655 [INFO] [val phase]
2025-04-02 03:56:54,655 [INFO] error: 1.3754 age_error:1.3754
2025-04-02 03:56:54,655 [INFO] loss: 0.6420 age_loss:0.6420
2025-04-02 03:56:54,655 [INFO] Best Epoch: 36
2025-04-02 03:56:55,158 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_43.pth
2025-04-02 03:56:55,764 [INFO] Epoch 44/44
2025-04-02 03:56:55,764 [INFO] ----------------------------------------
2025-04-02 03:57:14,206 [INFO] [trn phase]
2025-04-02 03:57:14,209 [INFO] error: 0.3631 age_error:0.3631
2025-04-02 03:57:14,209 [INFO] loss: 0.0410 age_loss:0.0410
2025-04-02 03:57:20,264 [INFO] [val phase]
2025-04-02 03:57:20,264 [INFO] error: 1.3223 age_error:1.3223
2025-04-02 03:57:20,264 [INFO] loss: 0.6505 age_loss:0.6505
2025-04-02 03:57:20,264 [INFO] Best Epoch: 36
2025-04-02 03:57:20,758 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_44.pth
2025-04-02 03:57:21,387 [INFO] Training complete in 2m 11s
2025-04-02 03:57:21,387 [INFO] Best epoch: 36
2025-04-02 03:57:50,704 [INFO] Model evalution:
2025-04-02 03:57:50,704 [INFO] [trn set]
2025-04-02 03:57:50,704 [INFO] age (mae): 0.3510
2025-04-02 03:57:50,704 [INFO] [val set]
2025-04-02 03:57:50,704 [INFO] age (mae): 1.1760
2025-04-02 03:57:50,704 [INFO] [tst set]
2025-04-02 03:57:50,704 [INFO] age (mae): 0.8820
2025-04-02 04:09:00,952 [INFO] {'data': {'benchmark': 'facebase/benchmarks/Adience.yaml', 'img_dir': '../datasets/', 'output_dir': 'facebase/results/', 'data_dir': 'facebase/data/'}, 'heads': [{'tag': 'age', 'type': 'cjs', 'attribute': 'age', 'labels': [[0], [1], [2], [3], [4], [5], [6], [7]], 'weight': 1, 'metric': ['mae', 'cs5'], 'visual_metric': [{'tag': 'mae'}, {'tag': 'bias'}, {'tag': 'prc', 'target_class': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], 'target_class_name': 'child 0-17', 'target_class_prior': [0.1, 0.2, 0.3]}]}], 'model': {'architecture': 'resnet50', 'use_pretrained': True, 'input_size': [256, 256]}, 'optimizer': {'num_workers': 8, 'num_epochs': 50, 'batch_size': 100, 'improve_patience': 50, 'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'algo': 'adam', 'use_amp': True}, 'preprocess': {'bbox_extension': [0, 0], 'input_extension': [0.05, 0.05], 'trn': {'path': 'lib/augmentation_configs/256x256/jitter+hflip.json'}, 'val': {'path': 'lib/augmentation_configs/256x256/resize_normalize.json'}}, 'training': {'mode': 'noisy', 'base_sigma': 0.75, 'alpha': 0.1, 'beta': 0.8}}
2025-04-02 04:09:00,971 [INFO] running on: cuda:0
2025-04-02 04:09:01,339 [INFO] Model(
  (model): ResNet(
    (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (4): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (5): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (fc): Identity()
  )
  (heads): ModuleDict(
    (age): Linear(in_features=2048, out_features=8, bias=True)
  )
)
2025-04-02 04:09:01,339 [INFO] Number of trn data 10954
2025-04-02 04:09:01,339 [INFO] Number of val data 3069
2025-04-02 04:09:01,839 [INFO] Epoch 45/49
2025-04-02 04:09:01,839 [INFO] ----------------------------------------
2025-04-02 04:09:21,389 [INFO] [trn phase]
2025-04-02 04:09:21,389 [INFO] error: 0.3559 age_error:0.3559
2025-04-02 04:09:21,389 [INFO] loss: 0.0370 age_loss:0.0370
2025-04-02 04:09:27,607 [INFO] [val phase]
2025-04-02 04:09:27,607 [INFO] error: 1.3992 age_error:1.3992
2025-04-02 04:09:27,607 [INFO] loss: 0.6109 age_loss:0.6109
2025-04-02 04:09:27,607 [INFO] Best Epoch: 36
2025-04-02 04:09:28,087 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_45.pth
2025-04-02 04:09:28,730 [INFO] Epoch 46/49
2025-04-02 04:09:28,730 [INFO] ----------------------------------------
2025-04-02 04:09:47,723 [INFO] [trn phase]
2025-04-02 04:09:47,725 [INFO] error: 0.3599 age_error:0.3599
2025-04-02 04:09:47,725 [INFO] loss: 0.0355 age_loss:0.0355
2025-04-02 04:09:53,775 [INFO] [val phase]
2025-04-02 04:09:53,775 [INFO] error: 1.3591 age_error:1.3591
2025-04-02 04:09:53,775 [INFO] loss: 0.7158 age_loss:0.7158
2025-04-02 04:09:53,775 [INFO] Best Epoch: 36
2025-04-02 04:09:54,267 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_46.pth
2025-04-02 04:09:54,929 [INFO] Epoch 47/49
2025-04-02 04:09:54,929 [INFO] ----------------------------------------
2025-04-02 04:10:13,337 [INFO] [trn phase]
2025-04-02 04:10:13,339 [INFO] error: 0.3431 age_error:0.3431
2025-04-02 04:10:13,340 [INFO] loss: 0.0307 age_loss:0.0307
2025-04-02 04:10:19,399 [INFO] [val phase]
2025-04-02 04:10:19,400 [INFO] error: 1.3379 age_error:1.3379
2025-04-02 04:10:19,400 [INFO] loss: 0.6502 age_loss:0.6502
2025-04-02 04:10:19,400 [INFO] Best Epoch: 36
2025-04-02 04:10:19,900 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_47.pth
2025-04-02 04:10:20,630 [INFO] Epoch 48/49
2025-04-02 04:10:20,630 [INFO] ----------------------------------------
2025-04-02 04:10:39,418 [INFO] [trn phase]
2025-04-02 04:10:39,421 [INFO] error: 0.3335 age_error:0.3335
2025-04-02 04:10:39,421 [INFO] loss: 0.0290 age_loss:0.0290
2025-04-02 04:10:45,741 [INFO] [val phase]
2025-04-02 04:10:45,741 [INFO] error: 1.3359 age_error:1.3359
2025-04-02 04:10:45,741 [INFO] loss: 0.5957 age_loss:0.5957
2025-04-02 04:10:45,741 [INFO] Best Epoch: 36
2025-04-02 04:10:46,239 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_48.pth
2025-04-02 04:10:46,925 [INFO] Epoch 49/49
2025-04-02 04:10:46,925 [INFO] ----------------------------------------
2025-04-02 04:11:05,355 [INFO] [trn phase]
2025-04-02 04:11:05,358 [INFO] error: 0.2941 age_error:0.2941
2025-04-02 04:11:05,358 [INFO] loss: 0.0220 age_loss:0.0220
2025-04-02 04:11:11,489 [INFO] [val phase]
2025-04-02 04:11:11,490 [INFO] error: 1.2994 age_error:1.2994
2025-04-02 04:11:11,490 [INFO] loss: 0.6262 age_loss:0.6262
2025-04-02 04:11:11,490 [INFO] Best Epoch: 36
2025-04-02 04:11:11,988 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split0/checkpoint_49.pth
2025-04-02 04:11:12,667 [INFO] Training complete in 2m 11s
2025-04-02 04:11:12,668 [INFO] Best epoch: 36
2025-04-02 04:11:42,351 [INFO] Model evalution:
2025-04-02 04:11:42,351 [INFO] [trn set]
2025-04-02 04:11:42,351 [INFO] age (mae): 0.3513
2025-04-02 04:11:42,351 [INFO] [val set]
2025-04-02 04:11:42,351 [INFO] age (mae): 1.1476
2025-04-02 04:11:42,351 [INFO] [tst set]
2025-04-02 04:11:42,351 [INFO] age (mae): 0.8820
