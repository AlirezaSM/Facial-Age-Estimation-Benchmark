2025-04-02 02:28:12,896 [INFO] {'data': {'benchmark': 'facebase/benchmarks/Adience.yaml', 'img_dir': '../datasets/', 'output_dir': 'facebase/results/', 'data_dir': 'facebase/data/'}, 'heads': [{'tag': 'age', 'type': 'cjs', 'attribute': 'age', 'labels': [[0], [1], [2], [3], [4], [5], [6], [7]], 'weight': 1, 'metric': ['mae', 'cs5'], 'visual_metric': [{'tag': 'mae'}, {'tag': 'bias'}, {'tag': 'prc', 'target_class': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], 'target_class_name': 'child 0-17', 'target_class_prior': [0.1, 0.2, 0.3]}]}], 'model': {'architecture': 'resnet50', 'use_pretrained': True, 'input_size': [256, 256]}, 'optimizer': {'num_workers': 8, 'num_epochs': 10, 'batch_size': 100, 'improve_patience': 50, 'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'algo': 'adam', 'use_amp': True}, 'preprocess': {'bbox_extension': [0, 0], 'input_extension': [0.05, 0.05], 'trn': {'path': 'lib/augmentation_configs/256x256/jitter+hflip.json'}, 'val': {'path': 'lib/augmentation_configs/256x256/resize_normalize.json'}}, 'training': {'mode': 'noisy', 'base_sigma': 0.75, 'alpha': 0.1, 'beta': 0.8}}
2025-04-02 02:28:12,906 [INFO] running on: cuda:0
2025-04-02 02:28:13,258 [INFO] Params to learn:
2025-04-02 02:28:13,258 [INFO] 	 model.conv1.weight, 9408
2025-04-02 02:28:13,258 [INFO] 	 model.bn1.weight, 64
2025-04-02 02:28:13,258 [INFO] 	 model.bn1.bias, 64
2025-04-02 02:28:13,258 [INFO] 	 model.layer1.0.conv1.weight, 4096
2025-04-02 02:28:13,258 [INFO] 	 model.layer1.0.bn1.weight, 64
2025-04-02 02:28:13,258 [INFO] 	 model.layer1.0.bn1.bias, 64
2025-04-02 02:28:13,258 [INFO] 	 model.layer1.0.conv2.weight, 36864
2025-04-02 02:28:13,258 [INFO] 	 model.layer1.0.bn2.weight, 64
2025-04-02 02:28:13,258 [INFO] 	 model.layer1.0.bn2.bias, 64
2025-04-02 02:28:13,258 [INFO] 	 model.layer1.0.conv3.weight, 16384
2025-04-02 02:28:13,258 [INFO] 	 model.layer1.0.bn3.weight, 256
2025-04-02 02:28:13,258 [INFO] 	 model.layer1.0.bn3.bias, 256
2025-04-02 02:28:13,258 [INFO] 	 model.layer1.0.downsample.0.weight, 16384
2025-04-02 02:28:13,258 [INFO] 	 model.layer1.0.downsample.1.weight, 256
2025-04-02 02:28:13,258 [INFO] 	 model.layer1.0.downsample.1.bias, 256
2025-04-02 02:28:13,258 [INFO] 	 model.layer1.1.conv1.weight, 16384
2025-04-02 02:28:13,258 [INFO] 	 model.layer1.1.bn1.weight, 64
2025-04-02 02:28:13,258 [INFO] 	 model.layer1.1.bn1.bias, 64
2025-04-02 02:28:13,258 [INFO] 	 model.layer1.1.conv2.weight, 36864
2025-04-02 02:28:13,258 [INFO] 	 model.layer1.1.bn2.weight, 64
2025-04-02 02:28:13,258 [INFO] 	 model.layer1.1.bn2.bias, 64
2025-04-02 02:28:13,258 [INFO] 	 model.layer1.1.conv3.weight, 16384
2025-04-02 02:28:13,258 [INFO] 	 model.layer1.1.bn3.weight, 256
2025-04-02 02:28:13,258 [INFO] 	 model.layer1.1.bn3.bias, 256
2025-04-02 02:28:13,258 [INFO] 	 model.layer1.2.conv1.weight, 16384
2025-04-02 02:28:13,258 [INFO] 	 model.layer1.2.bn1.weight, 64
2025-04-02 02:28:13,258 [INFO] 	 model.layer1.2.bn1.bias, 64
2025-04-02 02:28:13,258 [INFO] 	 model.layer1.2.conv2.weight, 36864
2025-04-02 02:28:13,258 [INFO] 	 model.layer1.2.bn2.weight, 64
2025-04-02 02:28:13,258 [INFO] 	 model.layer1.2.bn2.bias, 64
2025-04-02 02:28:13,258 [INFO] 	 model.layer1.2.conv3.weight, 16384
2025-04-02 02:28:13,258 [INFO] 	 model.layer1.2.bn3.weight, 256
2025-04-02 02:28:13,258 [INFO] 	 model.layer1.2.bn3.bias, 256
2025-04-02 02:28:13,258 [INFO] 	 model.layer2.0.conv1.weight, 32768
2025-04-02 02:28:13,258 [INFO] 	 model.layer2.0.bn1.weight, 128
2025-04-02 02:28:13,258 [INFO] 	 model.layer2.0.bn1.bias, 128
2025-04-02 02:28:13,258 [INFO] 	 model.layer2.0.conv2.weight, 147456
2025-04-02 02:28:13,258 [INFO] 	 model.layer2.0.bn2.weight, 128
2025-04-02 02:28:13,258 [INFO] 	 model.layer2.0.bn2.bias, 128
2025-04-02 02:28:13,258 [INFO] 	 model.layer2.0.conv3.weight, 65536
2025-04-02 02:28:13,258 [INFO] 	 model.layer2.0.bn3.weight, 512
2025-04-02 02:28:13,258 [INFO] 	 model.layer2.0.bn3.bias, 512
2025-04-02 02:28:13,258 [INFO] 	 model.layer2.0.downsample.0.weight, 131072
2025-04-02 02:28:13,258 [INFO] 	 model.layer2.0.downsample.1.weight, 512
2025-04-02 02:28:13,258 [INFO] 	 model.layer2.0.downsample.1.bias, 512
2025-04-02 02:28:13,258 [INFO] 	 model.layer2.1.conv1.weight, 65536
2025-04-02 02:28:13,258 [INFO] 	 model.layer2.1.bn1.weight, 128
2025-04-02 02:28:13,259 [INFO] 	 model.layer2.1.bn1.bias, 128
2025-04-02 02:28:13,259 [INFO] 	 model.layer2.1.conv2.weight, 147456
2025-04-02 02:28:13,259 [INFO] 	 model.layer2.1.bn2.weight, 128
2025-04-02 02:28:13,259 [INFO] 	 model.layer2.1.bn2.bias, 128
2025-04-02 02:28:13,259 [INFO] 	 model.layer2.1.conv3.weight, 65536
2025-04-02 02:28:13,259 [INFO] 	 model.layer2.1.bn3.weight, 512
2025-04-02 02:28:13,259 [INFO] 	 model.layer2.1.bn3.bias, 512
2025-04-02 02:28:13,259 [INFO] 	 model.layer2.2.conv1.weight, 65536
2025-04-02 02:28:13,259 [INFO] 	 model.layer2.2.bn1.weight, 128
2025-04-02 02:28:13,259 [INFO] 	 model.layer2.2.bn1.bias, 128
2025-04-02 02:28:13,259 [INFO] 	 model.layer2.2.conv2.weight, 147456
2025-04-02 02:28:13,259 [INFO] 	 model.layer2.2.bn2.weight, 128
2025-04-02 02:28:13,259 [INFO] 	 model.layer2.2.bn2.bias, 128
2025-04-02 02:28:13,259 [INFO] 	 model.layer2.2.conv3.weight, 65536
2025-04-02 02:28:13,259 [INFO] 	 model.layer2.2.bn3.weight, 512
2025-04-02 02:28:13,259 [INFO] 	 model.layer2.2.bn3.bias, 512
2025-04-02 02:28:13,259 [INFO] 	 model.layer2.3.conv1.weight, 65536
2025-04-02 02:28:13,259 [INFO] 	 model.layer2.3.bn1.weight, 128
2025-04-02 02:28:13,259 [INFO] 	 model.layer2.3.bn1.bias, 128
2025-04-02 02:28:13,259 [INFO] 	 model.layer2.3.conv2.weight, 147456
2025-04-02 02:28:13,259 [INFO] 	 model.layer2.3.bn2.weight, 128
2025-04-02 02:28:13,259 [INFO] 	 model.layer2.3.bn2.bias, 128
2025-04-02 02:28:13,259 [INFO] 	 model.layer2.3.conv3.weight, 65536
2025-04-02 02:28:13,259 [INFO] 	 model.layer2.3.bn3.weight, 512
2025-04-02 02:28:13,259 [INFO] 	 model.layer2.3.bn3.bias, 512
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.0.conv1.weight, 131072
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.0.bn1.weight, 256
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.0.bn1.bias, 256
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.0.conv2.weight, 589824
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.0.bn2.weight, 256
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.0.bn2.bias, 256
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.0.conv3.weight, 262144
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.0.bn3.weight, 1024
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.0.bn3.bias, 1024
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.0.downsample.0.weight, 524288
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.0.downsample.1.weight, 1024
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.0.downsample.1.bias, 1024
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.1.conv1.weight, 262144
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.1.bn1.weight, 256
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.1.bn1.bias, 256
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.1.conv2.weight, 589824
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.1.bn2.weight, 256
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.1.bn2.bias, 256
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.1.conv3.weight, 262144
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.1.bn3.weight, 1024
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.1.bn3.bias, 1024
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.2.conv1.weight, 262144
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.2.bn1.weight, 256
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.2.bn1.bias, 256
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.2.conv2.weight, 589824
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.2.bn2.weight, 256
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.2.bn2.bias, 256
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.2.conv3.weight, 262144
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.2.bn3.weight, 1024
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.2.bn3.bias, 1024
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.3.conv1.weight, 262144
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.3.bn1.weight, 256
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.3.bn1.bias, 256
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.3.conv2.weight, 589824
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.3.bn2.weight, 256
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.3.bn2.bias, 256
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.3.conv3.weight, 262144
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.3.bn3.weight, 1024
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.3.bn3.bias, 1024
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.4.conv1.weight, 262144
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.4.bn1.weight, 256
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.4.bn1.bias, 256
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.4.conv2.weight, 589824
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.4.bn2.weight, 256
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.4.bn2.bias, 256
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.4.conv3.weight, 262144
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.4.bn3.weight, 1024
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.4.bn3.bias, 1024
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.5.conv1.weight, 262144
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.5.bn1.weight, 256
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.5.bn1.bias, 256
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.5.conv2.weight, 589824
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.5.bn2.weight, 256
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.5.bn2.bias, 256
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.5.conv3.weight, 262144
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.5.bn3.weight, 1024
2025-04-02 02:28:13,259 [INFO] 	 model.layer3.5.bn3.bias, 1024
2025-04-02 02:28:13,260 [INFO] 	 model.layer4.0.conv1.weight, 524288
2025-04-02 02:28:13,260 [INFO] 	 model.layer4.0.bn1.weight, 512
2025-04-02 02:28:13,260 [INFO] 	 model.layer4.0.bn1.bias, 512
2025-04-02 02:28:13,260 [INFO] 	 model.layer4.0.conv2.weight, 2359296
2025-04-02 02:28:13,260 [INFO] 	 model.layer4.0.bn2.weight, 512
2025-04-02 02:28:13,260 [INFO] 	 model.layer4.0.bn2.bias, 512
2025-04-02 02:28:13,260 [INFO] 	 model.layer4.0.conv3.weight, 1048576
2025-04-02 02:28:13,260 [INFO] 	 model.layer4.0.bn3.weight, 2048
2025-04-02 02:28:13,260 [INFO] 	 model.layer4.0.bn3.bias, 2048
2025-04-02 02:28:13,260 [INFO] 	 model.layer4.0.downsample.0.weight, 2097152
2025-04-02 02:28:13,260 [INFO] 	 model.layer4.0.downsample.1.weight, 2048
2025-04-02 02:28:13,260 [INFO] 	 model.layer4.0.downsample.1.bias, 2048
2025-04-02 02:28:13,260 [INFO] 	 model.layer4.1.conv1.weight, 1048576
2025-04-02 02:28:13,260 [INFO] 	 model.layer4.1.bn1.weight, 512
2025-04-02 02:28:13,260 [INFO] 	 model.layer4.1.bn1.bias, 512
2025-04-02 02:28:13,260 [INFO] 	 model.layer4.1.conv2.weight, 2359296
2025-04-02 02:28:13,260 [INFO] 	 model.layer4.1.bn2.weight, 512
2025-04-02 02:28:13,260 [INFO] 	 model.layer4.1.bn2.bias, 512
2025-04-02 02:28:13,260 [INFO] 	 model.layer4.1.conv3.weight, 1048576
2025-04-02 02:28:13,260 [INFO] 	 model.layer4.1.bn3.weight, 2048
2025-04-02 02:28:13,260 [INFO] 	 model.layer4.1.bn3.bias, 2048
2025-04-02 02:28:13,260 [INFO] 	 model.layer4.2.conv1.weight, 1048576
2025-04-02 02:28:13,260 [INFO] 	 model.layer4.2.bn1.weight, 512
2025-04-02 02:28:13,260 [INFO] 	 model.layer4.2.bn1.bias, 512
2025-04-02 02:28:13,260 [INFO] 	 model.layer4.2.conv2.weight, 2359296
2025-04-02 02:28:13,260 [INFO] 	 model.layer4.2.bn2.weight, 512
2025-04-02 02:28:13,260 [INFO] 	 model.layer4.2.bn2.bias, 512
2025-04-02 02:28:13,260 [INFO] 	 model.layer4.2.conv3.weight, 1048576
2025-04-02 02:28:13,260 [INFO] 	 model.layer4.2.bn3.weight, 2048
2025-04-02 02:28:13,260 [INFO] 	 model.layer4.2.bn3.bias, 2048
2025-04-02 02:28:13,260 [INFO] 	 heads.age.weight, 16384
2025-04-02 02:28:13,260 [INFO] 	 heads.age.bias, 8
2025-04-02 02:28:13,260 [INFO] Number of Learnable Parameters: 23524424

2025-04-02 02:28:13,261 [INFO] Model(
  (model): ResNet(
    (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (4): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (5): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (fc): Identity()
  )
  (heads): ModuleDict(
    (age): Linear(in_features=2048, out_features=8, bias=True)
  )
)
2025-04-02 02:28:13,261 [INFO] Number of trn data 9643
2025-04-02 02:28:13,261 [INFO] Number of val data 3679
2025-04-02 02:28:13,268 [INFO] Epoch 0/9
2025-04-02 02:28:13,268 [INFO] ----------------------------------------
2025-04-02 02:28:30,369 [INFO] [trn phase]
2025-04-02 02:28:30,369 [INFO] error: 2.0208 age_error:2.0208
2025-04-02 02:28:30,369 [INFO] loss: 0.6607 age_loss:0.6607
2025-04-02 02:28:37,466 [INFO] [val phase]
2025-04-02 02:28:37,466 [INFO] error: 1.9500 age_error:1.9500
2025-04-02 02:28:37,466 [INFO] loss: 0.6298 age_loss:0.6298
2025-04-02 02:28:37,466 [INFO] Best Epoch: 0
2025-04-02 02:28:37,964 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_0.pth
2025-04-02 02:28:37,999 [INFO] Epoch 1/9
2025-04-02 02:28:37,999 [INFO] ----------------------------------------
2025-04-02 02:28:54,248 [INFO] [trn phase]
2025-04-02 02:28:54,249 [INFO] error: 1.8268 age_error:1.8268
2025-04-02 02:28:54,249 [INFO] loss: 0.5204 age_loss:0.5204
2025-04-02 02:29:01,474 [INFO] [val phase]
2025-04-02 02:29:01,474 [INFO] error: 1.8665 age_error:1.8665
2025-04-02 02:29:01,474 [INFO] loss: 0.6366 age_loss:0.6366
2025-04-02 02:29:01,474 [INFO] Best Epoch: 1
2025-04-02 02:29:01,999 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_1.pth
2025-04-02 02:29:02,046 [INFO] Epoch 2/9
2025-04-02 02:29:02,047 [INFO] ----------------------------------------
2025-04-02 02:29:18,184 [INFO] [trn phase]
2025-04-02 02:29:18,186 [INFO] error: 1.6634 age_error:1.6634
2025-04-02 02:29:18,186 [INFO] loss: 0.4630 age_loss:0.4630
2025-04-02 02:29:25,315 [INFO] [val phase]
2025-04-02 02:29:25,315 [INFO] error: 1.7779 age_error:1.7779
2025-04-02 02:29:25,315 [INFO] loss: 0.6413 age_loss:0.6413
2025-04-02 02:29:25,315 [INFO] Best Epoch: 2
2025-04-02 02:29:25,838 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_2.pth
2025-04-02 02:29:25,949 [INFO] Epoch 3/9
2025-04-02 02:29:25,949 [INFO] ----------------------------------------
2025-04-02 02:29:42,269 [INFO] [trn phase]
2025-04-02 02:29:42,271 [INFO] error: 1.5237 age_error:1.5237
2025-04-02 02:29:42,271 [INFO] loss: 0.4102 age_loss:0.4102
2025-04-02 02:29:49,350 [INFO] [val phase]
2025-04-02 02:29:49,350 [INFO] error: 1.8005 age_error:1.8005
2025-04-02 02:29:49,350 [INFO] loss: 0.6518 age_loss:0.6518
2025-04-02 02:29:49,351 [INFO] Best Epoch: 2
2025-04-02 02:29:49,888 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_3.pth
2025-04-02 02:29:49,955 [INFO] Epoch 4/9
2025-04-02 02:29:49,955 [INFO] ----------------------------------------
2025-04-02 02:30:06,188 [INFO] [trn phase]
2025-04-02 02:30:06,190 [INFO] error: 1.3940 age_error:1.3940
2025-04-02 02:30:06,190 [INFO] loss: 0.3596 age_loss:0.3596
2025-04-02 02:30:13,280 [INFO] [val phase]
2025-04-02 02:30:13,280 [INFO] error: 1.6757 age_error:1.6757
2025-04-02 02:30:13,280 [INFO] loss: 0.6801 age_loss:0.6801
2025-04-02 02:30:13,280 [INFO] Best Epoch: 4
2025-04-02 02:30:13,810 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_4.pth
2025-04-02 02:30:13,888 [INFO] Epoch 5/9
2025-04-02 02:30:13,888 [INFO] ----------------------------------------
2025-04-02 02:30:30,099 [INFO] [trn phase]
2025-04-02 02:30:30,099 [INFO] error: 1.2320 age_error:1.2320
2025-04-02 02:30:30,099 [INFO] loss: 0.3144 age_loss:0.3144
2025-04-02 02:30:37,219 [INFO] [val phase]
2025-04-02 02:30:37,219 [INFO] error: 1.6165 age_error:1.6165
2025-04-02 02:30:37,219 [INFO] loss: 0.7110 age_loss:0.7110
2025-04-02 02:30:37,219 [INFO] Best Epoch: 5
2025-04-02 02:30:37,746 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_5.pth
2025-04-02 02:30:37,834 [INFO] Epoch 6/9
2025-04-02 02:30:37,834 [INFO] ----------------------------------------
2025-04-02 02:30:54,163 [INFO] [trn phase]
2025-04-02 02:30:54,165 [INFO] error: 1.0854 age_error:1.0854
2025-04-02 02:30:54,165 [INFO] loss: 0.2611 age_loss:0.2611
2025-04-02 02:31:01,255 [INFO] [val phase]
2025-04-02 02:31:01,255 [INFO] error: 1.7611 age_error:1.7611
2025-04-02 02:31:01,255 [INFO] loss: 0.7567 age_loss:0.7567
2025-04-02 02:31:01,255 [INFO] Best Epoch: 5
2025-04-02 02:31:01,790 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_6.pth
2025-04-02 02:31:01,953 [INFO] Epoch 7/9
2025-04-02 02:31:01,953 [INFO] ----------------------------------------
2025-04-02 02:31:18,598 [INFO] [trn phase]
2025-04-02 02:31:18,601 [INFO] error: 1.0091 age_error:1.0091
2025-04-02 02:31:18,602 [INFO] loss: 0.2353 age_loss:0.2353
2025-04-02 02:31:25,712 [INFO] [val phase]
2025-04-02 02:31:25,712 [INFO] error: 1.5463 age_error:1.5463
2025-04-02 02:31:25,712 [INFO] loss: 0.7515 age_loss:0.7515
2025-04-02 02:31:25,712 [INFO] Best Epoch: 7
2025-04-02 02:31:26,248 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_7.pth
2025-04-02 02:31:26,358 [INFO] Epoch 8/9
2025-04-02 02:31:26,358 [INFO] ----------------------------------------
2025-04-02 02:31:43,023 [INFO] [trn phase]
2025-04-02 02:31:43,023 [INFO] error: 0.9300 age_error:0.9300
2025-04-02 02:31:43,023 [INFO] loss: 0.2162 age_loss:0.2162
2025-04-02 02:31:50,239 [INFO] [val phase]
2025-04-02 02:31:50,239 [INFO] error: 1.5371 age_error:1.5371
2025-04-02 02:31:50,239 [INFO] loss: 0.7743 age_loss:0.7743
2025-04-02 02:31:50,239 [INFO] Best Epoch: 8
2025-04-02 02:31:50,765 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_8.pth
2025-04-02 02:31:50,883 [INFO] Epoch 9/9
2025-04-02 02:31:50,883 [INFO] ----------------------------------------
2025-04-02 02:32:07,193 [INFO] [trn phase]
2025-04-02 02:32:07,196 [INFO] error: 0.8296 age_error:0.8296
2025-04-02 02:32:07,196 [INFO] loss: 0.1824 age_loss:0.1824
2025-04-02 02:32:14,311 [INFO] [val phase]
2025-04-02 02:32:14,311 [INFO] error: 1.5667 age_error:1.5667
2025-04-02 02:32:14,311 [INFO] loss: 0.8091 age_loss:0.8091
2025-04-02 02:32:14,311 [INFO] Best Epoch: 8
2025-04-02 02:32:14,845 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_9.pth
2025-04-02 02:32:15,033 [INFO] Training complete in 4m 2s
2025-04-02 02:32:15,033 [INFO] Best epoch: 8
2025-04-02 02:32:44,915 [INFO] Model evalution:
2025-04-02 02:32:44,915 [INFO] [trn set]
2025-04-02 02:32:44,915 [INFO] age (mae): 0.7781
2025-04-02 02:32:44,915 [INFO] [val set]
2025-04-02 02:32:44,915 [INFO] age (mae): 1.5374
2025-04-02 02:32:44,915 [INFO] [tst set]
2025-04-02 02:32:44,915 [INFO] age (mae): 1.1055
2025-04-02 02:43:49,486 [INFO] {'data': {'benchmark': 'facebase/benchmarks/Adience.yaml', 'img_dir': '../datasets/', 'output_dir': 'facebase/results/', 'data_dir': 'facebase/data/'}, 'heads': [{'tag': 'age', 'type': 'cjs', 'attribute': 'age', 'labels': [[0], [1], [2], [3], [4], [5], [6], [7]], 'weight': 1, 'metric': ['mae', 'cs5'], 'visual_metric': [{'tag': 'mae'}, {'tag': 'bias'}, {'tag': 'prc', 'target_class': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], 'target_class_name': 'child 0-17', 'target_class_prior': [0.1, 0.2, 0.3]}]}], 'model': {'architecture': 'resnet50', 'use_pretrained': True, 'input_size': [256, 256]}, 'optimizer': {'num_workers': 8, 'num_epochs': 15, 'batch_size': 100, 'improve_patience': 50, 'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'algo': 'adam', 'use_amp': True}, 'preprocess': {'bbox_extension': [0, 0], 'input_extension': [0.05, 0.05], 'trn': {'path': 'lib/augmentation_configs/256x256/jitter+hflip.json'}, 'val': {'path': 'lib/augmentation_configs/256x256/resize_normalize.json'}}, 'training': {'mode': 'noisy', 'base_sigma': 0.75, 'alpha': 0.1, 'beta': 0.8}}
2025-04-02 02:43:49,506 [INFO] running on: cuda:0
2025-04-02 02:43:49,879 [INFO] Model(
  (model): ResNet(
    (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (4): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (5): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (fc): Identity()
  )
  (heads): ModuleDict(
    (age): Linear(in_features=2048, out_features=8, bias=True)
  )
)
2025-04-02 02:43:49,879 [INFO] Number of trn data 9643
2025-04-02 02:43:49,880 [INFO] Number of val data 3679
2025-04-02 02:43:50,194 [INFO] Epoch 10/14
2025-04-02 02:43:50,194 [INFO] ----------------------------------------
2025-04-02 02:44:07,472 [INFO] [trn phase]
2025-04-02 02:44:07,472 [INFO] error: 0.7449 age_error:0.7449
2025-04-02 02:44:07,472 [INFO] loss: 0.1525 age_loss:0.1525
2025-04-02 02:44:14,665 [INFO] [val phase]
2025-04-02 02:44:14,665 [INFO] error: 1.4857 age_error:1.4857
2025-04-02 02:44:14,665 [INFO] loss: 0.7823 age_loss:0.7823
2025-04-02 02:44:14,665 [INFO] Best Epoch: 10
2025-04-02 02:44:15,180 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_10.pth
2025-04-02 02:44:15,316 [INFO] Epoch 11/14
2025-04-02 02:44:15,316 [INFO] ----------------------------------------
2025-04-02 02:44:31,696 [INFO] [trn phase]
2025-04-02 02:44:31,698 [INFO] error: 0.6820 age_error:0.6820
2025-04-02 02:44:31,698 [INFO] loss: 0.1335 age_loss:0.1335
2025-04-02 02:44:38,791 [INFO] [val phase]
2025-04-02 02:44:38,791 [INFO] error: 1.4482 age_error:1.4482
2025-04-02 02:44:38,791 [INFO] loss: 0.8052 age_loss:0.8052
2025-04-02 02:44:38,791 [INFO] Best Epoch: 11
2025-04-02 02:44:39,316 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_11.pth
2025-04-02 02:44:39,467 [INFO] Epoch 12/14
2025-04-02 02:44:39,467 [INFO] ----------------------------------------
2025-04-02 02:44:55,586 [INFO] [trn phase]
2025-04-02 02:44:55,586 [INFO] error: 0.5912 age_error:0.5912
2025-04-02 02:44:55,586 [INFO] loss: 0.1054 age_loss:0.1054
2025-04-02 02:45:02,707 [INFO] [val phase]
2025-04-02 02:45:02,707 [INFO] error: 1.4806 age_error:1.4806
2025-04-02 02:45:02,707 [INFO] loss: 0.8216 age_loss:0.8216
2025-04-02 02:45:02,707 [INFO] Best Epoch: 11
2025-04-02 02:45:03,237 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_12.pth
2025-04-02 02:45:03,464 [INFO] Epoch 13/14
2025-04-02 02:45:03,464 [INFO] ----------------------------------------
2025-04-02 02:45:19,871 [INFO] [trn phase]
2025-04-02 02:45:19,873 [INFO] error: 0.5309 age_error:0.5309
2025-04-02 02:45:19,873 [INFO] loss: 0.0929 age_loss:0.0929
2025-04-02 02:45:26,965 [INFO] [val phase]
2025-04-02 02:45:26,965 [INFO] error: 1.5216 age_error:1.5216
2025-04-02 02:45:26,965 [INFO] loss: 0.8059 age_loss:0.8059
2025-04-02 02:45:26,965 [INFO] Best Epoch: 11
2025-04-02 02:45:27,515 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_13.pth
2025-04-02 02:45:27,694 [INFO] Epoch 14/14
2025-04-02 02:45:27,694 [INFO] ----------------------------------------
2025-04-02 02:45:44,212 [INFO] [trn phase]
2025-04-02 02:45:44,215 [INFO] error: 0.4923 age_error:0.4923
2025-04-02 02:45:44,215 [INFO] loss: 0.0832 age_loss:0.0832
2025-04-02 02:45:51,285 [INFO] [val phase]
2025-04-02 02:45:51,285 [INFO] error: 1.4849 age_error:1.4849
2025-04-02 02:45:51,285 [INFO] loss: 0.8032 age_loss:0.8032
2025-04-02 02:45:51,285 [INFO] Best Epoch: 11
2025-04-02 02:45:51,820 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_14.pth
2025-04-02 02:45:52,013 [INFO] Training complete in 2m 2s
2025-04-02 02:45:52,013 [INFO] Best epoch: 11
2025-04-02 02:46:21,728 [INFO] Model evalution:
2025-04-02 02:46:21,729 [INFO] [trn set]
2025-04-02 02:46:21,729 [INFO] age (mae): 0.5538
2025-04-02 02:46:21,729 [INFO] [val set]
2025-04-02 02:46:21,729 [INFO] age (mae): 1.4496
2025-04-02 02:46:21,729 [INFO] [tst set]
2025-04-02 02:46:21,729 [INFO] age (mae): 0.9397
2025-04-02 02:57:29,870 [INFO] {'data': {'benchmark': 'facebase/benchmarks/Adience.yaml', 'img_dir': '../datasets/', 'output_dir': 'facebase/results/', 'data_dir': 'facebase/data/'}, 'heads': [{'tag': 'age', 'type': 'cjs', 'attribute': 'age', 'labels': [[0], [1], [2], [3], [4], [5], [6], [7]], 'weight': 1, 'metric': ['mae', 'cs5'], 'visual_metric': [{'tag': 'mae'}, {'tag': 'bias'}, {'tag': 'prc', 'target_class': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], 'target_class_name': 'child 0-17', 'target_class_prior': [0.1, 0.2, 0.3]}]}], 'model': {'architecture': 'resnet50', 'use_pretrained': True, 'input_size': [256, 256]}, 'optimizer': {'num_workers': 8, 'num_epochs': 20, 'batch_size': 100, 'improve_patience': 50, 'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'algo': 'adam', 'use_amp': True}, 'preprocess': {'bbox_extension': [0, 0], 'input_extension': [0.05, 0.05], 'trn': {'path': 'lib/augmentation_configs/256x256/jitter+hflip.json'}, 'val': {'path': 'lib/augmentation_configs/256x256/resize_normalize.json'}}, 'training': {'mode': 'noisy', 'base_sigma': 0.75, 'alpha': 0.1, 'beta': 0.8}}
2025-04-02 02:57:29,889 [INFO] running on: cuda:0
2025-04-02 02:57:30,254 [INFO] Model(
  (model): ResNet(
    (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (4): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (5): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (fc): Identity()
  )
  (heads): ModuleDict(
    (age): Linear(in_features=2048, out_features=8, bias=True)
  )
)
2025-04-02 02:57:30,254 [INFO] Number of trn data 9643
2025-04-02 02:57:30,254 [INFO] Number of val data 3679
2025-04-02 02:57:30,586 [INFO] Epoch 15/19
2025-04-02 02:57:30,586 [INFO] ----------------------------------------
2025-04-02 02:57:47,861 [INFO] [trn phase]
2025-04-02 02:57:47,861 [INFO] error: 0.4074 age_error:0.4074
2025-04-02 02:57:47,861 [INFO] loss: 0.0574 age_loss:0.0574
2025-04-02 02:57:55,038 [INFO] [val phase]
2025-04-02 02:57:55,038 [INFO] error: 1.4640 age_error:1.4640
2025-04-02 02:57:55,038 [INFO] loss: 0.8173 age_loss:0.8173
2025-04-02 02:57:55,038 [INFO] Best Epoch: 11
2025-04-02 02:57:55,557 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_15.pth
2025-04-02 02:57:55,767 [INFO] Epoch 16/19
2025-04-02 02:57:55,767 [INFO] ----------------------------------------
2025-04-02 02:58:12,140 [INFO] [trn phase]
2025-04-02 02:58:12,142 [INFO] error: 0.3539 age_error:0.3539
2025-04-02 02:58:12,142 [INFO] loss: 0.0444 age_loss:0.0444
2025-04-02 02:58:19,235 [INFO] [val phase]
2025-04-02 02:58:19,235 [INFO] error: 1.4224 age_error:1.4224
2025-04-02 02:58:19,235 [INFO] loss: 0.7955 age_loss:0.7955
2025-04-02 02:58:19,235 [INFO] Best Epoch: 16
2025-04-02 02:58:19,762 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_16.pth
2025-04-02 02:58:19,982 [INFO] Epoch 17/19
2025-04-02 02:58:19,982 [INFO] ----------------------------------------
2025-04-02 02:58:36,171 [INFO] [trn phase]
2025-04-02 02:58:36,174 [INFO] error: 0.2896 age_error:0.2896
2025-04-02 02:58:36,174 [INFO] loss: 0.0358 age_loss:0.0358
2025-04-02 02:58:43,334 [INFO] [val phase]
2025-04-02 02:58:43,334 [INFO] error: 1.4180 age_error:1.4180
2025-04-02 02:58:43,334 [INFO] loss: 0.8275 age_loss:0.8275
2025-04-02 02:58:43,334 [INFO] Best Epoch: 17
2025-04-02 02:58:43,876 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_17.pth
2025-04-02 02:58:44,171 [INFO] Epoch 18/19
2025-04-02 02:58:44,171 [INFO] ----------------------------------------
2025-04-02 02:59:00,478 [INFO] [trn phase]
2025-04-02 02:59:00,480 [INFO] error: 0.2578 age_error:0.2578
2025-04-02 02:59:00,481 [INFO] loss: 0.0309 age_loss:0.0309
2025-04-02 02:59:07,586 [INFO] [val phase]
2025-04-02 02:59:07,586 [INFO] error: 1.4425 age_error:1.4425
2025-04-02 02:59:07,586 [INFO] loss: 0.8208 age_loss:0.8208
2025-04-02 02:59:07,586 [INFO] Best Epoch: 17
2025-04-02 02:59:08,110 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_18.pth
2025-04-02 02:59:08,369 [INFO] Epoch 19/19
2025-04-02 02:59:08,369 [INFO] ----------------------------------------
2025-04-02 02:59:24,801 [INFO] [trn phase]
2025-04-02 02:59:24,804 [INFO] error: 0.2329 age_error:0.2329
2025-04-02 02:59:24,804 [INFO] loss: 0.0272 age_loss:0.0272
2025-04-02 02:59:31,919 [INFO] [val phase]
2025-04-02 02:59:31,919 [INFO] error: 1.4925 age_error:1.4925
2025-04-02 02:59:31,919 [INFO] loss: 0.8127 age_loss:0.8127
2025-04-02 02:59:31,919 [INFO] Best Epoch: 17
2025-04-02 02:59:32,445 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_19.pth
2025-04-02 02:59:32,701 [INFO] Training complete in 2m 2s
2025-04-02 02:59:32,701 [INFO] Best epoch: 17
2025-04-02 03:00:02,620 [INFO] Model evalution:
2025-04-02 03:00:02,620 [INFO] [trn set]
2025-04-02 03:00:02,620 [INFO] age (mae): 0.4032
2025-04-02 03:00:02,620 [INFO] [val set]
2025-04-02 03:00:02,620 [INFO] age (mae): 1.4172
2025-04-02 03:00:02,620 [INFO] [tst set]
2025-04-02 03:00:02,620 [INFO] age (mae): 0.8820
2025-04-02 03:11:11,604 [INFO] {'data': {'benchmark': 'facebase/benchmarks/Adience.yaml', 'img_dir': '../datasets/', 'output_dir': 'facebase/results/', 'data_dir': 'facebase/data/'}, 'heads': [{'tag': 'age', 'type': 'cjs', 'attribute': 'age', 'labels': [[0], [1], [2], [3], [4], [5], [6], [7]], 'weight': 1, 'metric': ['mae', 'cs5'], 'visual_metric': [{'tag': 'mae'}, {'tag': 'bias'}, {'tag': 'prc', 'target_class': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], 'target_class_name': 'child 0-17', 'target_class_prior': [0.1, 0.2, 0.3]}]}], 'model': {'architecture': 'resnet50', 'use_pretrained': True, 'input_size': [256, 256]}, 'optimizer': {'num_workers': 8, 'num_epochs': 25, 'batch_size': 100, 'improve_patience': 50, 'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'algo': 'adam', 'use_amp': True}, 'preprocess': {'bbox_extension': [0, 0], 'input_extension': [0.05, 0.05], 'trn': {'path': 'lib/augmentation_configs/256x256/jitter+hflip.json'}, 'val': {'path': 'lib/augmentation_configs/256x256/resize_normalize.json'}}, 'training': {'mode': 'noisy', 'base_sigma': 0.75, 'alpha': 0.1, 'beta': 0.8}}
2025-04-02 03:11:11,623 [INFO] running on: cuda:0
2025-04-02 03:11:11,976 [INFO] Model(
  (model): ResNet(
    (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (4): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (5): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (fc): Identity()
  )
  (heads): ModuleDict(
    (age): Linear(in_features=2048, out_features=8, bias=True)
  )
)
2025-04-02 03:11:11,976 [INFO] Number of trn data 9643
2025-04-02 03:11:11,976 [INFO] Number of val data 3679
2025-04-02 03:11:12,331 [INFO] Epoch 20/24
2025-04-02 03:11:12,331 [INFO] ----------------------------------------
2025-04-02 03:11:29,743 [INFO] [trn phase]
2025-04-02 03:11:29,743 [INFO] error: 0.2155 age_error:0.2155
2025-04-02 03:11:29,743 [INFO] loss: 0.0232 age_loss:0.0232
2025-04-02 03:11:36,864 [INFO] [val phase]
2025-04-02 03:11:36,864 [INFO] error: 1.4392 age_error:1.4392
2025-04-02 03:11:36,864 [INFO] loss: 0.8026 age_loss:0.8026
2025-04-02 03:11:36,864 [INFO] Best Epoch: 17
2025-04-02 03:11:37,383 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_20.pth
2025-04-02 03:11:37,648 [INFO] Epoch 21/24
2025-04-02 03:11:37,648 [INFO] ----------------------------------------
2025-04-02 03:11:53,885 [INFO] [trn phase]
2025-04-02 03:11:53,887 [INFO] error: 0.1911 age_error:0.1911
2025-04-02 03:11:53,887 [INFO] loss: 0.0192 age_loss:0.0192
2025-04-02 03:12:01,111 [INFO] [val phase]
2025-04-02 03:12:01,111 [INFO] error: 1.4023 age_error:1.4023
2025-04-02 03:12:01,111 [INFO] loss: 0.7749 age_loss:0.7749
2025-04-02 03:12:01,111 [INFO] Best Epoch: 21
2025-04-02 03:12:01,646 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_21.pth
2025-04-02 03:12:01,937 [INFO] Epoch 22/24
2025-04-02 03:12:01,937 [INFO] ----------------------------------------
2025-04-02 03:12:18,360 [INFO] [trn phase]
2025-04-02 03:12:18,362 [INFO] error: 0.1582 age_error:0.1582
2025-04-02 03:12:18,362 [INFO] loss: 0.0160 age_loss:0.0160
2025-04-02 03:12:25,607 [INFO] [val phase]
2025-04-02 03:12:25,607 [INFO] error: 1.4254 age_error:1.4254
2025-04-02 03:12:25,607 [INFO] loss: 0.7895 age_loss:0.7895
2025-04-02 03:12:25,607 [INFO] Best Epoch: 21
2025-04-02 03:12:26,147 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_22.pth
2025-04-02 03:12:26,517 [INFO] Epoch 23/24
2025-04-02 03:12:26,518 [INFO] ----------------------------------------
2025-04-02 03:12:42,915 [INFO] [trn phase]
2025-04-02 03:12:42,917 [INFO] error: 0.1432 age_error:0.1432
2025-04-02 03:12:42,917 [INFO] loss: 0.0156 age_loss:0.0156
2025-04-02 03:12:50,107 [INFO] [val phase]
2025-04-02 03:12:50,107 [INFO] error: 1.3987 age_error:1.3987
2025-04-02 03:12:50,107 [INFO] loss: 0.8175 age_loss:0.8175
2025-04-02 03:12:50,107 [INFO] Best Epoch: 23
2025-04-02 03:12:50,642 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_23.pth
2025-04-02 03:12:50,947 [INFO] Epoch 24/24
2025-04-02 03:12:50,947 [INFO] ----------------------------------------
2025-04-02 03:13:07,279 [INFO] [trn phase]
2025-04-02 03:13:07,281 [INFO] error: 0.1379 age_error:0.1379
2025-04-02 03:13:07,282 [INFO] loss: 0.0141 age_loss:0.0141
2025-04-02 03:13:14,396 [INFO] [val phase]
2025-04-02 03:13:14,396 [INFO] error: 1.4719 age_error:1.4719
2025-04-02 03:13:14,396 [INFO] loss: 0.7732 age_loss:0.7732
2025-04-02 03:13:14,396 [INFO] Best Epoch: 23
2025-04-02 03:13:14,936 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_24.pth
2025-04-02 03:13:15,258 [INFO] Training complete in 2m 3s
2025-04-02 03:13:15,258 [INFO] Best epoch: 23
2025-04-02 03:13:45,117 [INFO] Model evalution:
2025-04-02 03:13:45,117 [INFO] [trn set]
2025-04-02 03:13:45,117 [INFO] age (mae): 0.3742
2025-04-02 03:13:45,117 [INFO] [val set]
2025-04-02 03:13:45,117 [INFO] age (mae): 1.3944
2025-04-02 03:13:45,117 [INFO] [tst set]
2025-04-02 03:13:45,117 [INFO] age (mae): 0.8420
2025-04-02 03:24:55,735 [INFO] {'data': {'benchmark': 'facebase/benchmarks/Adience.yaml', 'img_dir': '../datasets/', 'output_dir': 'facebase/results/', 'data_dir': 'facebase/data/'}, 'heads': [{'tag': 'age', 'type': 'cjs', 'attribute': 'age', 'labels': [[0], [1], [2], [3], [4], [5], [6], [7]], 'weight': 1, 'metric': ['mae', 'cs5'], 'visual_metric': [{'tag': 'mae'}, {'tag': 'bias'}, {'tag': 'prc', 'target_class': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], 'target_class_name': 'child 0-17', 'target_class_prior': [0.1, 0.2, 0.3]}]}], 'model': {'architecture': 'resnet50', 'use_pretrained': True, 'input_size': [256, 256]}, 'optimizer': {'num_workers': 8, 'num_epochs': 30, 'batch_size': 100, 'improve_patience': 50, 'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'algo': 'adam', 'use_amp': True}, 'preprocess': {'bbox_extension': [0, 0], 'input_extension': [0.05, 0.05], 'trn': {'path': 'lib/augmentation_configs/256x256/jitter+hflip.json'}, 'val': {'path': 'lib/augmentation_configs/256x256/resize_normalize.json'}}, 'training': {'mode': 'noisy', 'base_sigma': 0.75, 'alpha': 0.1, 'beta': 0.8}}
2025-04-02 03:24:55,754 [INFO] running on: cuda:0
2025-04-02 03:24:56,115 [INFO] Model(
  (model): ResNet(
    (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (4): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (5): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (fc): Identity()
  )
  (heads): ModuleDict(
    (age): Linear(in_features=2048, out_features=8, bias=True)
  )
)
2025-04-02 03:24:56,116 [INFO] Number of trn data 9643
2025-04-02 03:24:56,116 [INFO] Number of val data 3679
2025-04-02 03:24:56,488 [INFO] Epoch 25/29
2025-04-02 03:24:56,488 [INFO] ----------------------------------------
2025-04-02 03:25:13,754 [INFO] [trn phase]
2025-04-02 03:25:13,754 [INFO] error: 0.1602 age_error:0.1602
2025-04-02 03:25:13,754 [INFO] loss: 0.0146 age_loss:0.0146
2025-04-02 03:25:20,917 [INFO] [val phase]
2025-04-02 03:25:20,917 [INFO] error: 1.3990 age_error:1.3990
2025-04-02 03:25:20,917 [INFO] loss: 0.7826 age_loss:0.7826
2025-04-02 03:25:20,917 [INFO] Best Epoch: 23
2025-04-02 03:25:21,435 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_25.pth
2025-04-02 03:25:21,774 [INFO] Epoch 26/29
2025-04-02 03:25:21,774 [INFO] ----------------------------------------
2025-04-02 03:25:38,062 [INFO] [trn phase]
2025-04-02 03:25:38,064 [INFO] error: 0.1641 age_error:0.1641
2025-04-02 03:25:38,064 [INFO] loss: 0.0146 age_loss:0.0146
2025-04-02 03:25:45,181 [INFO] [val phase]
2025-04-02 03:25:45,181 [INFO] error: 1.3933 age_error:1.3933
2025-04-02 03:25:45,181 [INFO] loss: 0.7468 age_loss:0.7468
2025-04-02 03:25:45,181 [INFO] Best Epoch: 26
2025-04-02 03:25:45,706 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_26.pth
2025-04-02 03:25:46,059 [INFO] Epoch 27/29
2025-04-02 03:25:46,059 [INFO] ----------------------------------------
2025-04-02 03:26:02,235 [INFO] [trn phase]
2025-04-02 03:26:02,237 [INFO] error: 0.1407 age_error:0.1407
2025-04-02 03:26:02,237 [INFO] loss: 0.0129 age_loss:0.0129
2025-04-02 03:26:09,317 [INFO] [val phase]
2025-04-02 03:26:09,317 [INFO] error: 1.4191 age_error:1.4191
2025-04-02 03:26:09,317 [INFO] loss: 0.7457 age_loss:0.7457
2025-04-02 03:26:09,317 [INFO] Best Epoch: 26
2025-04-02 03:26:09,842 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_27.pth
2025-04-02 03:26:10,275 [INFO] Epoch 28/29
2025-04-02 03:26:10,275 [INFO] ----------------------------------------
2025-04-02 03:26:26,643 [INFO] [trn phase]
2025-04-02 03:26:26,645 [INFO] error: 0.1329 age_error:0.1329
2025-04-02 03:26:26,645 [INFO] loss: 0.0127 age_loss:0.0127
2025-04-02 03:26:33,749 [INFO] [val phase]
2025-04-02 03:26:33,749 [INFO] error: 1.3996 age_error:1.3996
2025-04-02 03:26:33,749 [INFO] loss: 0.7922 age_loss:0.7922
2025-04-02 03:26:33,749 [INFO] Best Epoch: 26
2025-04-02 03:26:34,275 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_28.pth
2025-04-02 03:26:34,668 [INFO] Epoch 29/29
2025-04-02 03:26:34,668 [INFO] ----------------------------------------
2025-04-02 03:26:51,180 [INFO] [trn phase]
2025-04-02 03:26:51,182 [INFO] error: 0.1490 age_error:0.1490
2025-04-02 03:26:51,182 [INFO] loss: 0.0133 age_loss:0.0133
2025-04-02 03:26:58,253 [INFO] [val phase]
2025-04-02 03:26:58,253 [INFO] error: 1.4564 age_error:1.4564
2025-04-02 03:26:58,253 [INFO] loss: 0.7257 age_loss:0.7257
2025-04-02 03:26:58,253 [INFO] Best Epoch: 26
2025-04-02 03:26:58,792 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_29.pth
2025-04-02 03:26:59,200 [INFO] Training complete in 2m 3s
2025-04-02 03:26:59,200 [INFO] Best epoch: 26
2025-04-02 03:27:28,733 [INFO] Model evalution:
2025-04-02 03:27:28,733 [INFO] [trn set]
2025-04-02 03:27:28,733 [INFO] age (mae): 0.3334
2025-04-02 03:27:28,733 [INFO] [val set]
2025-04-02 03:27:28,733 [INFO] age (mae): 1.3773
2025-04-02 03:27:28,733 [INFO] [tst set]
2025-04-02 03:27:28,733 [INFO] age (mae): 0.8347
2025-04-02 03:38:41,822 [INFO] {'data': {'benchmark': 'facebase/benchmarks/Adience.yaml', 'img_dir': '../datasets/', 'output_dir': 'facebase/results/', 'data_dir': 'facebase/data/'}, 'heads': [{'tag': 'age', 'type': 'cjs', 'attribute': 'age', 'labels': [[0], [1], [2], [3], [4], [5], [6], [7]], 'weight': 1, 'metric': ['mae', 'cs5'], 'visual_metric': [{'tag': 'mae'}, {'tag': 'bias'}, {'tag': 'prc', 'target_class': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], 'target_class_name': 'child 0-17', 'target_class_prior': [0.1, 0.2, 0.3]}]}], 'model': {'architecture': 'resnet50', 'use_pretrained': True, 'input_size': [256, 256]}, 'optimizer': {'num_workers': 8, 'num_epochs': 35, 'batch_size': 100, 'improve_patience': 50, 'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'algo': 'adam', 'use_amp': True}, 'preprocess': {'bbox_extension': [0, 0], 'input_extension': [0.05, 0.05], 'trn': {'path': 'lib/augmentation_configs/256x256/jitter+hflip.json'}, 'val': {'path': 'lib/augmentation_configs/256x256/resize_normalize.json'}}, 'training': {'mode': 'noisy', 'base_sigma': 0.75, 'alpha': 0.1, 'beta': 0.8}}
2025-04-02 03:38:41,840 [INFO] running on: cuda:0
2025-04-02 03:38:42,218 [INFO] Model(
  (model): ResNet(
    (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (4): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (5): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (fc): Identity()
  )
  (heads): ModuleDict(
    (age): Linear(in_features=2048, out_features=8, bias=True)
  )
)
2025-04-02 03:38:42,219 [INFO] Number of trn data 9643
2025-04-02 03:38:42,219 [INFO] Number of val data 3679
2025-04-02 03:38:42,613 [INFO] Epoch 30/34
2025-04-02 03:38:42,613 [INFO] ----------------------------------------
2025-04-02 03:38:59,922 [INFO] [trn phase]
2025-04-02 03:38:59,922 [INFO] error: 0.1627 age_error:0.1627
2025-04-02 03:38:59,922 [INFO] loss: 0.0135 age_loss:0.0135
2025-04-02 03:39:07,111 [INFO] [val phase]
2025-04-02 03:39:07,111 [INFO] error: 1.4031 age_error:1.4031
2025-04-02 03:39:07,111 [INFO] loss: 0.7814 age_loss:0.7814
2025-04-02 03:39:07,111 [INFO] Best Epoch: 26
2025-04-02 03:39:07,630 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_30.pth
2025-04-02 03:39:08,048 [INFO] Epoch 31/34
2025-04-02 03:39:08,049 [INFO] ----------------------------------------
2025-04-02 03:39:24,301 [INFO] [trn phase]
2025-04-02 03:39:24,303 [INFO] error: 0.1952 age_error:0.1952
2025-04-02 03:39:24,303 [INFO] loss: 0.0156 age_loss:0.0156
2025-04-02 03:39:31,560 [INFO] [val phase]
2025-04-02 03:39:31,560 [INFO] error: 1.4012 age_error:1.4012
2025-04-02 03:39:31,560 [INFO] loss: 0.7638 age_loss:0.7638
2025-04-02 03:39:31,560 [INFO] Best Epoch: 26
2025-04-02 03:39:32,096 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_31.pth
2025-04-02 03:39:32,528 [INFO] Epoch 32/34
2025-04-02 03:39:32,528 [INFO] ----------------------------------------
2025-04-02 03:39:48,647 [INFO] [trn phase]
2025-04-02 03:39:48,649 [INFO] error: 0.1623 age_error:0.1623
2025-04-02 03:39:48,650 [INFO] loss: 0.0127 age_loss:0.0127
2025-04-02 03:39:55,753 [INFO] [val phase]
2025-04-02 03:39:55,754 [INFO] error: 1.4360 age_error:1.4360
2025-04-02 03:39:55,754 [INFO] loss: 0.8353 age_loss:0.8353
2025-04-02 03:39:55,754 [INFO] Best Epoch: 26
2025-04-02 03:39:56,289 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_32.pth
2025-04-02 03:39:56,792 [INFO] Epoch 33/34
2025-04-02 03:39:56,792 [INFO] ----------------------------------------
2025-04-02 03:40:13,241 [INFO] [trn phase]
2025-04-02 03:40:13,243 [INFO] error: 0.1819 age_error:0.1819
2025-04-02 03:40:13,243 [INFO] loss: 0.0151 age_loss:0.0151
2025-04-02 03:40:20,410 [INFO] [val phase]
2025-04-02 03:40:20,410 [INFO] error: 1.3933 age_error:1.3933
2025-04-02 03:40:20,410 [INFO] loss: 0.7200 age_loss:0.7200
2025-04-02 03:40:20,410 [INFO] Best Epoch: 26
2025-04-02 03:40:20,942 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_33.pth
2025-04-02 03:40:21,396 [INFO] Epoch 34/34
2025-04-02 03:40:21,396 [INFO] ----------------------------------------
2025-04-02 03:40:37,675 [INFO] [trn phase]
2025-04-02 03:40:37,677 [INFO] error: 0.1983 age_error:0.1983
2025-04-02 03:40:37,677 [INFO] loss: 0.0170 age_loss:0.0170
2025-04-02 03:40:44,843 [INFO] [val phase]
2025-04-02 03:40:44,843 [INFO] error: 1.4303 age_error:1.4303
2025-04-02 03:40:44,843 [INFO] loss: 0.7365 age_loss:0.7365
2025-04-02 03:40:44,843 [INFO] Best Epoch: 26
2025-04-02 03:40:45,374 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_34.pth
2025-04-02 03:40:45,844 [INFO] Training complete in 2m 4s
2025-04-02 03:40:45,844 [INFO] Best epoch: 26
2025-04-02 03:41:16,086 [INFO] Model evalution:
2025-04-02 03:41:16,086 [INFO] [trn set]
2025-04-02 03:41:16,086 [INFO] age (mae): 0.3273
2025-04-02 03:41:16,086 [INFO] [val set]
2025-04-02 03:41:16,086 [INFO] age (mae): 1.3558
2025-04-02 03:41:16,086 [INFO] [tst set]
2025-04-02 03:41:16,086 [INFO] age (mae): 0.8347
2025-04-02 03:52:31,158 [INFO] {'data': {'benchmark': 'facebase/benchmarks/Adience.yaml', 'img_dir': '../datasets/', 'output_dir': 'facebase/results/', 'data_dir': 'facebase/data/'}, 'heads': [{'tag': 'age', 'type': 'cjs', 'attribute': 'age', 'labels': [[0], [1], [2], [3], [4], [5], [6], [7]], 'weight': 1, 'metric': ['mae', 'cs5'], 'visual_metric': [{'tag': 'mae'}, {'tag': 'bias'}, {'tag': 'prc', 'target_class': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], 'target_class_name': 'child 0-17', 'target_class_prior': [0.1, 0.2, 0.3]}]}], 'model': {'architecture': 'resnet50', 'use_pretrained': True, 'input_size': [256, 256]}, 'optimizer': {'num_workers': 8, 'num_epochs': 40, 'batch_size': 100, 'improve_patience': 50, 'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'algo': 'adam', 'use_amp': True}, 'preprocess': {'bbox_extension': [0, 0], 'input_extension': [0.05, 0.05], 'trn': {'path': 'lib/augmentation_configs/256x256/jitter+hflip.json'}, 'val': {'path': 'lib/augmentation_configs/256x256/resize_normalize.json'}}, 'training': {'mode': 'noisy', 'base_sigma': 0.75, 'alpha': 0.1, 'beta': 0.8}}
2025-04-02 03:52:31,176 [INFO] running on: cuda:0
2025-04-02 03:52:31,540 [INFO] Model(
  (model): ResNet(
    (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (4): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (5): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (fc): Identity()
  )
  (heads): ModuleDict(
    (age): Linear(in_features=2048, out_features=8, bias=True)
  )
)
2025-04-02 03:52:31,541 [INFO] Number of trn data 9643
2025-04-02 03:52:31,541 [INFO] Number of val data 3679
2025-04-02 03:52:31,965 [INFO] Epoch 35/39
2025-04-02 03:52:31,965 [INFO] ----------------------------------------
2025-04-02 03:52:49,291 [INFO] [trn phase]
2025-04-02 03:52:49,291 [INFO] error: 0.1963 age_error:0.1963
2025-04-02 03:52:49,291 [INFO] loss: 0.0158 age_loss:0.0158
2025-04-02 03:52:56,434 [INFO] [val phase]
2025-04-02 03:52:56,435 [INFO] error: 1.3876 age_error:1.3876
2025-04-02 03:52:56,435 [INFO] loss: 0.6990 age_loss:0.6990
2025-04-02 03:52:56,435 [INFO] Best Epoch: 35
2025-04-02 03:52:56,955 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_35.pth
2025-04-02 03:52:57,435 [INFO] Epoch 36/39
2025-04-02 03:52:57,435 [INFO] ----------------------------------------
2025-04-02 03:53:14,074 [INFO] [trn phase]
2025-04-02 03:53:14,076 [INFO] error: 0.2092 age_error:0.2092
2025-04-02 03:53:14,077 [INFO] loss: 0.0160 age_loss:0.0160
2025-04-02 03:53:21,173 [INFO] [val phase]
2025-04-02 03:53:21,173 [INFO] error: 1.3705 age_error:1.3705
2025-04-02 03:53:21,173 [INFO] loss: 0.7341 age_loss:0.7341
2025-04-02 03:53:21,173 [INFO] Best Epoch: 36
2025-04-02 03:53:21,705 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_36.pth
2025-04-02 03:53:22,204 [INFO] Epoch 37/39
2025-04-02 03:53:22,204 [INFO] ----------------------------------------
2025-04-02 03:53:38,505 [INFO] [trn phase]
2025-04-02 03:53:38,508 [INFO] error: 0.2013 age_error:0.2013
2025-04-02 03:53:38,508 [INFO] loss: 0.0154 age_loss:0.0154
2025-04-02 03:53:45,665 [INFO] [val phase]
2025-04-02 03:53:45,665 [INFO] error: 1.4001 age_error:1.4001
2025-04-02 03:53:45,665 [INFO] loss: 0.7425 age_loss:0.7425
2025-04-02 03:53:45,665 [INFO] Best Epoch: 36
2025-04-02 03:53:46,206 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_37.pth
2025-04-02 03:53:46,788 [INFO] Epoch 38/39
2025-04-02 03:53:46,788 [INFO] ----------------------------------------
2025-04-02 03:54:03,153 [INFO] [trn phase]
2025-04-02 03:54:03,155 [INFO] error: 0.2287 age_error:0.2287
2025-04-02 03:54:03,155 [INFO] loss: 0.0216 age_loss:0.0216
2025-04-02 03:54:10,229 [INFO] [val phase]
2025-04-02 03:54:10,229 [INFO] error: 1.4004 age_error:1.4004
2025-04-02 03:54:10,229 [INFO] loss: 0.6763 age_loss:0.6763
2025-04-02 03:54:10,229 [INFO] Best Epoch: 36
2025-04-02 03:54:10,759 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_38.pth
2025-04-02 03:54:11,291 [INFO] Epoch 39/39
2025-04-02 03:54:11,291 [INFO] ----------------------------------------
2025-04-02 03:54:27,623 [INFO] [trn phase]
2025-04-02 03:54:27,625 [INFO] error: 0.2415 age_error:0.2415
2025-04-02 03:54:27,625 [INFO] loss: 0.0227 age_loss:0.0227
2025-04-02 03:54:34,739 [INFO] [val phase]
2025-04-02 03:54:34,739 [INFO] error: 1.4656 age_error:1.4656
2025-04-02 03:54:34,739 [INFO] loss: 0.7094 age_loss:0.7094
2025-04-02 03:54:34,739 [INFO] Best Epoch: 36
2025-04-02 03:54:35,275 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_39.pth
2025-04-02 03:54:35,820 [INFO] Training complete in 2m 4s
2025-04-02 03:54:35,820 [INFO] Best epoch: 36
2025-04-02 03:55:05,752 [INFO] Model evalution:
2025-04-02 03:55:05,752 [INFO] [trn set]
2025-04-02 03:55:05,752 [INFO] age (mae): 0.3289
2025-04-02 03:55:05,752 [INFO] [val set]
2025-04-02 03:55:05,752 [INFO] age (mae): 1.2982
2025-04-02 03:55:05,753 [INFO] [tst set]
2025-04-02 03:55:05,753 [INFO] age (mae): 0.7922
2025-04-02 04:06:22,313 [INFO] {'data': {'benchmark': 'facebase/benchmarks/Adience.yaml', 'img_dir': '../datasets/', 'output_dir': 'facebase/results/', 'data_dir': 'facebase/data/'}, 'heads': [{'tag': 'age', 'type': 'cjs', 'attribute': 'age', 'labels': [[0], [1], [2], [3], [4], [5], [6], [7]], 'weight': 1, 'metric': ['mae', 'cs5'], 'visual_metric': [{'tag': 'mae'}, {'tag': 'bias'}, {'tag': 'prc', 'target_class': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], 'target_class_name': 'child 0-17', 'target_class_prior': [0.1, 0.2, 0.3]}]}], 'model': {'architecture': 'resnet50', 'use_pretrained': True, 'input_size': [256, 256]}, 'optimizer': {'num_workers': 8, 'num_epochs': 45, 'batch_size': 100, 'improve_patience': 50, 'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'algo': 'adam', 'use_amp': True}, 'preprocess': {'bbox_extension': [0, 0], 'input_extension': [0.05, 0.05], 'trn': {'path': 'lib/augmentation_configs/256x256/jitter+hflip.json'}, 'val': {'path': 'lib/augmentation_configs/256x256/resize_normalize.json'}}, 'training': {'mode': 'noisy', 'base_sigma': 0.75, 'alpha': 0.1, 'beta': 0.8}}
2025-04-02 04:06:22,332 [INFO] running on: cuda:0
2025-04-02 04:06:22,707 [INFO] Model(
  (model): ResNet(
    (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (4): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (5): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (fc): Identity()
  )
  (heads): ModuleDict(
    (age): Linear(in_features=2048, out_features=8, bias=True)
  )
)
2025-04-02 04:06:22,708 [INFO] Number of trn data 9643
2025-04-02 04:06:22,708 [INFO] Number of val data 3679
2025-04-02 04:06:23,158 [INFO] Epoch 40/44
2025-04-02 04:06:23,158 [INFO] ----------------------------------------
2025-04-02 04:06:40,471 [INFO] [trn phase]
2025-04-02 04:06:40,472 [INFO] error: 0.2965 age_error:0.2965
2025-04-02 04:06:40,472 [INFO] loss: 0.0286 age_loss:0.0286
2025-04-02 04:06:47,590 [INFO] [val phase]
2025-04-02 04:06:47,590 [INFO] error: 1.4208 age_error:1.4208
2025-04-02 04:06:47,590 [INFO] loss: 0.6898 age_loss:0.6898
2025-04-02 04:06:47,590 [INFO] Best Epoch: 36
2025-04-02 04:06:48,111 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_40.pth
2025-04-02 04:06:48,658 [INFO] Epoch 41/44
2025-04-02 04:06:48,658 [INFO] ----------------------------------------
2025-04-02 04:07:04,823 [INFO] [trn phase]
2025-04-02 04:07:04,825 [INFO] error: 0.2704 age_error:0.2704
2025-04-02 04:07:04,825 [INFO] loss: 0.0257 age_loss:0.0257
2025-04-02 04:07:11,933 [INFO] [val phase]
2025-04-02 04:07:11,933 [INFO] error: 1.3724 age_error:1.3724
2025-04-02 04:07:11,933 [INFO] loss: 0.7065 age_loss:0.7065
2025-04-02 04:07:11,933 [INFO] Best Epoch: 36
2025-04-02 04:07:12,471 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_41.pth
2025-04-02 04:07:13,043 [INFO] Epoch 42/44
2025-04-02 04:07:13,043 [INFO] ----------------------------------------
2025-04-02 04:07:29,088 [INFO] [trn phase]
2025-04-02 04:07:29,091 [INFO] error: 0.2746 age_error:0.2746
2025-04-02 04:07:29,091 [INFO] loss: 0.0262 age_loss:0.0262
2025-04-02 04:07:36,384 [INFO] [val phase]
2025-04-02 04:07:36,384 [INFO] error: 1.3857 age_error:1.3857
2025-04-02 04:07:36,384 [INFO] loss: 0.6809 age_loss:0.6809
2025-04-02 04:07:36,384 [INFO] Best Epoch: 36
2025-04-02 04:07:36,924 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_42.pth
2025-04-02 04:07:37,578 [INFO] Epoch 43/44
2025-04-02 04:07:37,579 [INFO] ----------------------------------------
2025-04-02 04:07:53,990 [INFO] [trn phase]
2025-04-02 04:07:53,992 [INFO] error: 0.3004 age_error:0.3004
2025-04-02 04:07:53,992 [INFO] loss: 0.0294 age_loss:0.0294
2025-04-02 04:08:01,078 [INFO] [val phase]
2025-04-02 04:08:01,078 [INFO] error: 1.4091 age_error:1.4091
2025-04-02 04:08:01,078 [INFO] loss: 0.6845 age_loss:0.6845
2025-04-02 04:08:01,078 [INFO] Best Epoch: 36
2025-04-02 04:08:01,615 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_43.pth
2025-04-02 04:08:02,214 [INFO] Epoch 44/44
2025-04-02 04:08:02,214 [INFO] ----------------------------------------
2025-04-02 04:08:18,649 [INFO] [trn phase]
2025-04-02 04:08:18,652 [INFO] error: 0.2909 age_error:0.2909
2025-04-02 04:08:18,652 [INFO] loss: 0.0291 age_loss:0.0291
2025-04-02 04:08:25,791 [INFO] [val phase]
2025-04-02 04:08:25,791 [INFO] error: 1.4499 age_error:1.4499
2025-04-02 04:08:25,791 [INFO] loss: 0.6638 age_loss:0.6638
2025-04-02 04:08:25,791 [INFO] Best Epoch: 36
2025-04-02 04:08:26,322 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_44.pth
2025-04-02 04:08:26,934 [INFO] Training complete in 2m 4s
2025-04-02 04:08:26,934 [INFO] Best epoch: 36
2025-04-02 04:08:56,722 [INFO] Model evalution:
2025-04-02 04:08:56,722 [INFO] [trn set]
2025-04-02 04:08:56,722 [INFO] age (mae): 0.3227
2025-04-02 04:08:56,722 [INFO] [val set]
2025-04-02 04:08:56,722 [INFO] age (mae): 1.2596
2025-04-02 04:08:56,722 [INFO] [tst set]
2025-04-02 04:08:56,722 [INFO] age (mae): 0.7922
2025-04-02 04:20:16,102 [INFO] {'data': {'benchmark': 'facebase/benchmarks/Adience.yaml', 'img_dir': '../datasets/', 'output_dir': 'facebase/results/', 'data_dir': 'facebase/data/'}, 'heads': [{'tag': 'age', 'type': 'cjs', 'attribute': 'age', 'labels': [[0], [1], [2], [3], [4], [5], [6], [7]], 'weight': 1, 'metric': ['mae', 'cs5'], 'visual_metric': [{'tag': 'mae'}, {'tag': 'bias'}, {'tag': 'prc', 'target_class': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], 'target_class_name': 'child 0-17', 'target_class_prior': [0.1, 0.2, 0.3]}]}], 'model': {'architecture': 'resnet50', 'use_pretrained': True, 'input_size': [256, 256]}, 'optimizer': {'num_workers': 8, 'num_epochs': 50, 'batch_size': 100, 'improve_patience': 50, 'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'algo': 'adam', 'use_amp': True}, 'preprocess': {'bbox_extension': [0, 0], 'input_extension': [0.05, 0.05], 'trn': {'path': 'lib/augmentation_configs/256x256/jitter+hflip.json'}, 'val': {'path': 'lib/augmentation_configs/256x256/resize_normalize.json'}}, 'training': {'mode': 'noisy', 'base_sigma': 0.75, 'alpha': 0.1, 'beta': 0.8}}
2025-04-02 04:20:16,113 [INFO] running on: cuda:0
2025-04-02 04:20:16,465 [INFO] Model(
  (model): ResNet(
    (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (4): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (5): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (fc): Identity()
  )
  (heads): ModuleDict(
    (age): Linear(in_features=2048, out_features=8, bias=True)
  )
)
2025-04-02 04:20:16,465 [INFO] Number of trn data 9643
2025-04-02 04:20:16,465 [INFO] Number of val data 3679
2025-04-02 04:20:16,931 [INFO] Epoch 45/49
2025-04-02 04:20:16,931 [INFO] ----------------------------------------
2025-04-02 04:20:34,129 [INFO] [trn phase]
2025-04-02 04:20:34,130 [INFO] error: 0.3320 age_error:0.3320
2025-04-02 04:20:34,130 [INFO] loss: 0.0323 age_loss:0.0323
2025-04-02 04:20:41,351 [INFO] [val phase]
2025-04-02 04:20:41,351 [INFO] error: 1.4387 age_error:1.4387
2025-04-02 04:20:41,351 [INFO] loss: 0.6170 age_loss:0.6170
2025-04-02 04:20:41,351 [INFO] Best Epoch: 36
2025-04-02 04:20:41,872 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_45.pth
2025-04-02 04:20:42,506 [INFO] Epoch 46/49
2025-04-02 04:20:42,507 [INFO] ----------------------------------------
2025-04-02 04:20:58,818 [INFO] [trn phase]
2025-04-02 04:20:58,820 [INFO] error: 0.3163 age_error:0.3163
2025-04-02 04:20:58,820 [INFO] loss: 0.0297 age_loss:0.0297
2025-04-02 04:21:05,947 [INFO] [val phase]
2025-04-02 04:21:05,947 [INFO] error: 1.3672 age_error:1.3672
2025-04-02 04:21:05,947 [INFO] loss: 0.6411 age_loss:0.6411
2025-04-02 04:21:05,947 [INFO] Best Epoch: 46
2025-04-02 04:21:06,471 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_46.pth
2025-04-02 04:21:07,109 [INFO] Epoch 47/49
2025-04-02 04:21:07,109 [INFO] ----------------------------------------
2025-04-02 04:21:23,156 [INFO] [trn phase]
2025-04-02 04:21:23,158 [INFO] error: 0.3041 age_error:0.3041
2025-04-02 04:21:23,158 [INFO] loss: 0.0274 age_loss:0.0274
2025-04-02 04:21:30,224 [INFO] [val phase]
2025-04-02 04:21:30,224 [INFO] error: 1.3960 age_error:1.3960
2025-04-02 04:21:30,224 [INFO] loss: 0.6244 age_loss:0.6244
2025-04-02 04:21:30,224 [INFO] Best Epoch: 46
2025-04-02 04:21:30,764 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_47.pth
2025-04-02 04:21:31,486 [INFO] Epoch 48/49
2025-04-02 04:21:31,486 [INFO] ----------------------------------------
2025-04-02 04:21:47,802 [INFO] [trn phase]
2025-04-02 04:21:47,805 [INFO] error: 0.3229 age_error:0.3229
2025-04-02 04:21:47,805 [INFO] loss: 0.0289 age_loss:0.0289
2025-04-02 04:21:54,946 [INFO] [val phase]
2025-04-02 04:21:54,946 [INFO] error: 1.3898 age_error:1.3898
2025-04-02 04:21:54,946 [INFO] loss: 0.6156 age_loss:0.6156
2025-04-02 04:21:54,946 [INFO] Best Epoch: 46
2025-04-02 04:21:55,479 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_48.pth
2025-04-02 04:21:56,144 [INFO] Epoch 49/49
2025-04-02 04:21:56,144 [INFO] ----------------------------------------
2025-04-02 04:22:12,343 [INFO] [trn phase]
2025-04-02 04:22:12,346 [INFO] error: 0.2942 age_error:0.2942
2025-04-02 04:22:12,346 [INFO] loss: 0.0235 age_loss:0.0235
2025-04-02 04:22:19,465 [INFO] [val phase]
2025-04-02 04:22:19,465 [INFO] error: 1.5121 age_error:1.5121
2025-04-02 04:22:19,465 [INFO] loss: 0.6372 age_loss:0.6372
2025-04-02 04:22:19,465 [INFO] Best Epoch: 46
2025-04-02 04:22:19,997 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split4/checkpoint_49.pth
2025-04-02 04:22:20,674 [INFO] Training complete in 2m 4s
2025-04-02 04:22:20,674 [INFO] Best epoch: 46
2025-04-02 04:22:50,932 [INFO] Model evalution:
2025-04-02 04:22:50,933 [INFO] [trn set]
2025-04-02 04:22:50,933 [INFO] age (mae): 0.3424
2025-04-02 04:22:50,933 [INFO] [val set]
2025-04-02 04:22:50,933 [INFO] age (mae): 1.2316
2025-04-02 04:22:50,933 [INFO] [tst set]
2025-04-02 04:22:50,933 [INFO] age (mae): 0.8272
