2025-04-02 02:18:23,455 [INFO] {'data': {'benchmark': 'facebase/benchmarks/Adience.yaml', 'img_dir': '../datasets/', 'output_dir': 'facebase/results/', 'data_dir': 'facebase/data/'}, 'heads': [{'tag': 'age', 'type': 'cjs', 'attribute': 'age', 'labels': [[0], [1], [2], [3], [4], [5], [6], [7]], 'weight': 1, 'metric': ['mae', 'cs5'], 'visual_metric': [{'tag': 'mae'}, {'tag': 'bias'}, {'tag': 'prc', 'target_class': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], 'target_class_name': 'child 0-17', 'target_class_prior': [0.1, 0.2, 0.3]}]}], 'model': {'architecture': 'resnet50', 'use_pretrained': True, 'input_size': [256, 256]}, 'optimizer': {'num_workers': 8, 'num_epochs': 10, 'batch_size': 100, 'improve_patience': 50, 'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'algo': 'adam', 'use_amp': True}, 'preprocess': {'bbox_extension': [0, 0], 'input_extension': [0.05, 0.05], 'trn': {'path': 'lib/augmentation_configs/256x256/jitter+hflip.json'}, 'val': {'path': 'lib/augmentation_configs/256x256/resize_normalize.json'}}, 'training': {'mode': 'noisy', 'base_sigma': 0.75, 'alpha': 0.1, 'beta': 0.8}}
2025-04-02 02:18:23,465 [INFO] running on: cuda:0
2025-04-02 02:18:23,838 [INFO] Params to learn:
2025-04-02 02:18:23,838 [INFO] 	 model.conv1.weight, 9408
2025-04-02 02:18:23,838 [INFO] 	 model.bn1.weight, 64
2025-04-02 02:18:23,838 [INFO] 	 model.bn1.bias, 64
2025-04-02 02:18:23,839 [INFO] 	 model.layer1.0.conv1.weight, 4096
2025-04-02 02:18:23,839 [INFO] 	 model.layer1.0.bn1.weight, 64
2025-04-02 02:18:23,839 [INFO] 	 model.layer1.0.bn1.bias, 64
2025-04-02 02:18:23,839 [INFO] 	 model.layer1.0.conv2.weight, 36864
2025-04-02 02:18:23,839 [INFO] 	 model.layer1.0.bn2.weight, 64
2025-04-02 02:18:23,839 [INFO] 	 model.layer1.0.bn2.bias, 64
2025-04-02 02:18:23,839 [INFO] 	 model.layer1.0.conv3.weight, 16384
2025-04-02 02:18:23,839 [INFO] 	 model.layer1.0.bn3.weight, 256
2025-04-02 02:18:23,839 [INFO] 	 model.layer1.0.bn3.bias, 256
2025-04-02 02:18:23,839 [INFO] 	 model.layer1.0.downsample.0.weight, 16384
2025-04-02 02:18:23,839 [INFO] 	 model.layer1.0.downsample.1.weight, 256
2025-04-02 02:18:23,839 [INFO] 	 model.layer1.0.downsample.1.bias, 256
2025-04-02 02:18:23,839 [INFO] 	 model.layer1.1.conv1.weight, 16384
2025-04-02 02:18:23,839 [INFO] 	 model.layer1.1.bn1.weight, 64
2025-04-02 02:18:23,839 [INFO] 	 model.layer1.1.bn1.bias, 64
2025-04-02 02:18:23,839 [INFO] 	 model.layer1.1.conv2.weight, 36864
2025-04-02 02:18:23,839 [INFO] 	 model.layer1.1.bn2.weight, 64
2025-04-02 02:18:23,839 [INFO] 	 model.layer1.1.bn2.bias, 64
2025-04-02 02:18:23,839 [INFO] 	 model.layer1.1.conv3.weight, 16384
2025-04-02 02:18:23,839 [INFO] 	 model.layer1.1.bn3.weight, 256
2025-04-02 02:18:23,839 [INFO] 	 model.layer1.1.bn3.bias, 256
2025-04-02 02:18:23,839 [INFO] 	 model.layer1.2.conv1.weight, 16384
2025-04-02 02:18:23,839 [INFO] 	 model.layer1.2.bn1.weight, 64
2025-04-02 02:18:23,839 [INFO] 	 model.layer1.2.bn1.bias, 64
2025-04-02 02:18:23,839 [INFO] 	 model.layer1.2.conv2.weight, 36864
2025-04-02 02:18:23,839 [INFO] 	 model.layer1.2.bn2.weight, 64
2025-04-02 02:18:23,839 [INFO] 	 model.layer1.2.bn2.bias, 64
2025-04-02 02:18:23,839 [INFO] 	 model.layer1.2.conv3.weight, 16384
2025-04-02 02:18:23,839 [INFO] 	 model.layer1.2.bn3.weight, 256
2025-04-02 02:18:23,839 [INFO] 	 model.layer1.2.bn3.bias, 256
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.0.conv1.weight, 32768
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.0.bn1.weight, 128
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.0.bn1.bias, 128
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.0.conv2.weight, 147456
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.0.bn2.weight, 128
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.0.bn2.bias, 128
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.0.conv3.weight, 65536
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.0.bn3.weight, 512
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.0.bn3.bias, 512
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.0.downsample.0.weight, 131072
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.0.downsample.1.weight, 512
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.0.downsample.1.bias, 512
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.1.conv1.weight, 65536
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.1.bn1.weight, 128
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.1.bn1.bias, 128
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.1.conv2.weight, 147456
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.1.bn2.weight, 128
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.1.bn2.bias, 128
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.1.conv3.weight, 65536
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.1.bn3.weight, 512
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.1.bn3.bias, 512
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.2.conv1.weight, 65536
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.2.bn1.weight, 128
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.2.bn1.bias, 128
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.2.conv2.weight, 147456
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.2.bn2.weight, 128
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.2.bn2.bias, 128
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.2.conv3.weight, 65536
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.2.bn3.weight, 512
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.2.bn3.bias, 512
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.3.conv1.weight, 65536
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.3.bn1.weight, 128
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.3.bn1.bias, 128
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.3.conv2.weight, 147456
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.3.bn2.weight, 128
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.3.bn2.bias, 128
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.3.conv3.weight, 65536
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.3.bn3.weight, 512
2025-04-02 02:18:23,839 [INFO] 	 model.layer2.3.bn3.bias, 512
2025-04-02 02:18:23,839 [INFO] 	 model.layer3.0.conv1.weight, 131072
2025-04-02 02:18:23,839 [INFO] 	 model.layer3.0.bn1.weight, 256
2025-04-02 02:18:23,839 [INFO] 	 model.layer3.0.bn1.bias, 256
2025-04-02 02:18:23,839 [INFO] 	 model.layer3.0.conv2.weight, 589824
2025-04-02 02:18:23,839 [INFO] 	 model.layer3.0.bn2.weight, 256
2025-04-02 02:18:23,839 [INFO] 	 model.layer3.0.bn2.bias, 256
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.0.conv3.weight, 262144
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.0.bn3.weight, 1024
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.0.bn3.bias, 1024
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.0.downsample.0.weight, 524288
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.0.downsample.1.weight, 1024
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.0.downsample.1.bias, 1024
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.1.conv1.weight, 262144
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.1.bn1.weight, 256
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.1.bn1.bias, 256
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.1.conv2.weight, 589824
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.1.bn2.weight, 256
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.1.bn2.bias, 256
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.1.conv3.weight, 262144
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.1.bn3.weight, 1024
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.1.bn3.bias, 1024
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.2.conv1.weight, 262144
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.2.bn1.weight, 256
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.2.bn1.bias, 256
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.2.conv2.weight, 589824
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.2.bn2.weight, 256
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.2.bn2.bias, 256
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.2.conv3.weight, 262144
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.2.bn3.weight, 1024
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.2.bn3.bias, 1024
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.3.conv1.weight, 262144
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.3.bn1.weight, 256
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.3.bn1.bias, 256
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.3.conv2.weight, 589824
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.3.bn2.weight, 256
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.3.bn2.bias, 256
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.3.conv3.weight, 262144
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.3.bn3.weight, 1024
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.3.bn3.bias, 1024
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.4.conv1.weight, 262144
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.4.bn1.weight, 256
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.4.bn1.bias, 256
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.4.conv2.weight, 589824
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.4.bn2.weight, 256
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.4.bn2.bias, 256
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.4.conv3.weight, 262144
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.4.bn3.weight, 1024
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.4.bn3.bias, 1024
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.5.conv1.weight, 262144
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.5.bn1.weight, 256
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.5.bn1.bias, 256
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.5.conv2.weight, 589824
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.5.bn2.weight, 256
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.5.bn2.bias, 256
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.5.conv3.weight, 262144
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.5.bn3.weight, 1024
2025-04-02 02:18:23,840 [INFO] 	 model.layer3.5.bn3.bias, 1024
2025-04-02 02:18:23,840 [INFO] 	 model.layer4.0.conv1.weight, 524288
2025-04-02 02:18:23,840 [INFO] 	 model.layer4.0.bn1.weight, 512
2025-04-02 02:18:23,840 [INFO] 	 model.layer4.0.bn1.bias, 512
2025-04-02 02:18:23,840 [INFO] 	 model.layer4.0.conv2.weight, 2359296
2025-04-02 02:18:23,840 [INFO] 	 model.layer4.0.bn2.weight, 512
2025-04-02 02:18:23,840 [INFO] 	 model.layer4.0.bn2.bias, 512
2025-04-02 02:18:23,840 [INFO] 	 model.layer4.0.conv3.weight, 1048576
2025-04-02 02:18:23,840 [INFO] 	 model.layer4.0.bn3.weight, 2048
2025-04-02 02:18:23,840 [INFO] 	 model.layer4.0.bn3.bias, 2048
2025-04-02 02:18:23,840 [INFO] 	 model.layer4.0.downsample.0.weight, 2097152
2025-04-02 02:18:23,840 [INFO] 	 model.layer4.0.downsample.1.weight, 2048
2025-04-02 02:18:23,840 [INFO] 	 model.layer4.0.downsample.1.bias, 2048
2025-04-02 02:18:23,840 [INFO] 	 model.layer4.1.conv1.weight, 1048576
2025-04-02 02:18:23,840 [INFO] 	 model.layer4.1.bn1.weight, 512
2025-04-02 02:18:23,840 [INFO] 	 model.layer4.1.bn1.bias, 512
2025-04-02 02:18:23,840 [INFO] 	 model.layer4.1.conv2.weight, 2359296
2025-04-02 02:18:23,840 [INFO] 	 model.layer4.1.bn2.weight, 512
2025-04-02 02:18:23,840 [INFO] 	 model.layer4.1.bn2.bias, 512
2025-04-02 02:18:23,840 [INFO] 	 model.layer4.1.conv3.weight, 1048576
2025-04-02 02:18:23,840 [INFO] 	 model.layer4.1.bn3.weight, 2048
2025-04-02 02:18:23,840 [INFO] 	 model.layer4.1.bn3.bias, 2048
2025-04-02 02:18:23,840 [INFO] 	 model.layer4.2.conv1.weight, 1048576
2025-04-02 02:18:23,840 [INFO] 	 model.layer4.2.bn1.weight, 512
2025-04-02 02:18:23,840 [INFO] 	 model.layer4.2.bn1.bias, 512
2025-04-02 02:18:23,840 [INFO] 	 model.layer4.2.conv2.weight, 2359296
2025-04-02 02:18:23,840 [INFO] 	 model.layer4.2.bn2.weight, 512
2025-04-02 02:18:23,840 [INFO] 	 model.layer4.2.bn2.bias, 512
2025-04-02 02:18:23,840 [INFO] 	 model.layer4.2.conv3.weight, 1048576
2025-04-02 02:18:23,840 [INFO] 	 model.layer4.2.bn3.weight, 2048
2025-04-02 02:18:23,840 [INFO] 	 model.layer4.2.bn3.bias, 2048
2025-04-02 02:18:23,841 [INFO] 	 heads.age.weight, 16384
2025-04-02 02:18:23,841 [INFO] 	 heads.age.bias, 8
2025-04-02 02:18:23,841 [INFO] Number of Learnable Parameters: 23524424

2025-04-02 02:18:23,841 [INFO] Model(
  (model): ResNet(
    (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (4): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (5): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (fc): Identity()
  )
  (heads): ModuleDict(
    (age): Linear(in_features=2048, out_features=8, bias=True)
  )
)
2025-04-02 02:18:23,842 [INFO] Number of trn data 11128
2025-04-02 02:18:23,842 [INFO] Number of val data 3274
2025-04-02 02:18:23,848 [INFO] Epoch 0/9
2025-04-02 02:18:23,849 [INFO] ----------------------------------------
2025-04-02 02:18:43,559 [INFO] [trn phase]
2025-04-02 02:18:43,559 [INFO] error: 1.9858 age_error:1.9858
2025-04-02 02:18:43,559 [INFO] loss: 0.6583 age_loss:0.6583
2025-04-02 02:18:50,229 [INFO] [val phase]
2025-04-02 02:18:50,229 [INFO] error: 2.0724 age_error:2.0724
2025-04-02 02:18:50,229 [INFO] loss: 0.6167 age_loss:0.6167
2025-04-02 02:18:50,229 [INFO] Best Epoch: 0
2025-04-02 02:18:50,704 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_0.pth
2025-04-02 02:18:50,743 [INFO] Epoch 1/9
2025-04-02 02:18:50,743 [INFO] ----------------------------------------
2025-04-02 02:19:09,468 [INFO] [trn phase]
2025-04-02 02:19:09,471 [INFO] error: 1.7766 age_error:1.7766
2025-04-02 02:19:09,471 [INFO] loss: 0.5142 age_loss:0.5142
2025-04-02 02:19:16,107 [INFO] [val phase]
2025-04-02 02:19:16,107 [INFO] error: 1.8687 age_error:1.8687
2025-04-02 02:19:16,107 [INFO] loss: 0.5839 age_loss:0.5839
2025-04-02 02:19:16,107 [INFO] Best Epoch: 1
2025-04-02 02:19:16,622 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_1.pth
2025-04-02 02:19:16,672 [INFO] Epoch 2/9
2025-04-02 02:19:16,672 [INFO] ----------------------------------------
2025-04-02 02:19:35,205 [INFO] [trn phase]
2025-04-02 02:19:35,205 [INFO] error: 1.6511 age_error:1.6511
2025-04-02 02:19:35,205 [INFO] loss: 0.4666 age_loss:0.4666
2025-04-02 02:19:41,824 [INFO] [val phase]
2025-04-02 02:19:41,824 [INFO] error: 1.8748 age_error:1.8748
2025-04-02 02:19:41,825 [INFO] loss: 0.6156 age_loss:0.6156
2025-04-02 02:19:41,825 [INFO] Best Epoch: 1
2025-04-02 02:19:42,330 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_2.pth
2025-04-02 02:19:42,448 [INFO] Epoch 3/9
2025-04-02 02:19:42,448 [INFO] ----------------------------------------
2025-04-02 02:20:01,107 [INFO] [trn phase]
2025-04-02 02:20:01,109 [INFO] error: 1.4822 age_error:1.4822
2025-04-02 02:20:01,109 [INFO] loss: 0.4049 age_loss:0.4049
2025-04-02 02:20:07,706 [INFO] [val phase]
2025-04-02 02:20:07,706 [INFO] error: 1.5794 age_error:1.5794
2025-04-02 02:20:07,706 [INFO] loss: 0.6341 age_loss:0.6341
2025-04-02 02:20:07,706 [INFO] Best Epoch: 3
2025-04-02 02:20:08,232 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_3.pth
2025-04-02 02:20:08,310 [INFO] Epoch 4/9
2025-04-02 02:20:08,310 [INFO] ----------------------------------------
2025-04-02 02:20:26,865 [INFO] [trn phase]
2025-04-02 02:20:26,865 [INFO] error: 1.2970 age_error:1.2970
2025-04-02 02:20:26,865 [INFO] loss: 0.3432 age_loss:0.3432
2025-04-02 02:20:33,448 [INFO] [val phase]
2025-04-02 02:20:33,448 [INFO] error: 1.5944 age_error:1.5944
2025-04-02 02:20:33,448 [INFO] loss: 0.6546 age_loss:0.6546
2025-04-02 02:20:33,448 [INFO] Best Epoch: 3
2025-04-02 02:20:33,951 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_4.pth
2025-04-02 02:20:34,035 [INFO] Epoch 5/9
2025-04-02 02:20:34,035 [INFO] ----------------------------------------
2025-04-02 02:20:52,529 [INFO] [trn phase]
2025-04-02 02:20:52,532 [INFO] error: 1.1565 age_error:1.1565
2025-04-02 02:20:52,532 [INFO] loss: 0.2891 age_loss:0.2891
2025-04-02 02:20:59,105 [INFO] [val phase]
2025-04-02 02:20:59,105 [INFO] error: 1.6830 age_error:1.6830
2025-04-02 02:20:59,105 [INFO] loss: 0.7186 age_loss:0.7186
2025-04-02 02:20:59,105 [INFO] Best Epoch: 3
2025-04-02 02:20:59,611 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_5.pth
2025-04-02 02:20:59,761 [INFO] Epoch 6/9
2025-04-02 02:20:59,761 [INFO] ----------------------------------------
2025-04-02 02:21:18,569 [INFO] [trn phase]
2025-04-02 02:21:18,571 [INFO] error: 1.0324 age_error:1.0324
2025-04-02 02:21:18,571 [INFO] loss: 0.2539 age_loss:0.2539
2025-04-02 02:21:25,141 [INFO] [val phase]
2025-04-02 02:21:25,141 [INFO] error: 1.7282 age_error:1.7282
2025-04-02 02:21:25,141 [INFO] loss: 0.7140 age_loss:0.7140
2025-04-02 02:21:25,141 [INFO] Best Epoch: 3
2025-04-02 02:21:25,640 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_6.pth
2025-04-02 02:21:25,742 [INFO] Epoch 7/9
2025-04-02 02:21:25,742 [INFO] ----------------------------------------
2025-04-02 02:21:44,380 [INFO] [trn phase]
2025-04-02 02:21:44,382 [INFO] error: 0.9248 age_error:0.9248
2025-04-02 02:21:44,382 [INFO] loss: 0.2132 age_loss:0.2132
2025-04-02 02:21:50,979 [INFO] [val phase]
2025-04-02 02:21:50,979 [INFO] error: 1.6765 age_error:1.6765
2025-04-02 02:21:50,979 [INFO] loss: 0.7415 age_loss:0.7415
2025-04-02 02:21:50,979 [INFO] Best Epoch: 3
2025-04-02 02:21:51,490 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_7.pth
2025-04-02 02:21:51,606 [INFO] Epoch 8/9
2025-04-02 02:21:51,607 [INFO] ----------------------------------------
2025-04-02 02:22:10,551 [INFO] [trn phase]
2025-04-02 02:22:10,554 [INFO] error: 0.8536 age_error:0.8536
2025-04-02 02:22:10,554 [INFO] loss: 0.1894 age_loss:0.1894
2025-04-02 02:22:17,302 [INFO] [val phase]
2025-04-02 02:22:17,302 [INFO] error: 1.6457 age_error:1.6457
2025-04-02 02:22:17,302 [INFO] loss: 0.7294 age_loss:0.7294
2025-04-02 02:22:17,302 [INFO] Best Epoch: 3
2025-04-02 02:22:17,809 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_8.pth
2025-04-02 02:22:17,938 [INFO] Epoch 9/9
2025-04-02 02:22:17,938 [INFO] ----------------------------------------
2025-04-02 02:22:36,563 [INFO] [trn phase]
2025-04-02 02:22:36,563 [INFO] error: 0.7791 age_error:0.7791
2025-04-02 02:22:36,563 [INFO] loss: 0.1622 age_loss:0.1622
2025-04-02 02:22:43,263 [INFO] [val phase]
2025-04-02 02:22:43,263 [INFO] error: 1.4560 age_error:1.4560
2025-04-02 02:22:43,263 [INFO] loss: 0.7949 age_loss:0.7949
2025-04-02 02:22:43,263 [INFO] Best Epoch: 9
2025-04-02 02:22:43,769 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_9.pth
2025-04-02 02:22:43,969 [INFO] Training complete in 4m 20s
2025-04-02 02:22:43,969 [INFO] Best epoch: 9
2025-04-02 02:23:13,352 [INFO] Model evalution:
2025-04-02 02:23:13,352 [INFO] [trn set]
2025-04-02 02:23:13,352 [INFO] age (mae): 0.5908
2025-04-02 02:23:13,352 [INFO] [val set]
2025-04-02 02:23:13,352 [INFO] age (mae): 1.4575
2025-04-02 02:23:13,352 [INFO] [tst set]
2025-04-02 02:23:13,352 [INFO] age (mae): 1.0458
2025-04-02 02:38:18,866 [INFO] {'data': {'benchmark': 'facebase/benchmarks/Adience.yaml', 'img_dir': '../datasets/', 'output_dir': 'facebase/results/', 'data_dir': 'facebase/data/'}, 'heads': [{'tag': 'age', 'type': 'cjs', 'attribute': 'age', 'labels': [[0], [1], [2], [3], [4], [5], [6], [7]], 'weight': 1, 'metric': ['mae', 'cs5'], 'visual_metric': [{'tag': 'mae'}, {'tag': 'bias'}, {'tag': 'prc', 'target_class': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], 'target_class_name': 'child 0-17', 'target_class_prior': [0.1, 0.2, 0.3]}]}], 'model': {'architecture': 'resnet50', 'use_pretrained': True, 'input_size': [256, 256]}, 'optimizer': {'num_workers': 8, 'num_epochs': 15, 'batch_size': 100, 'improve_patience': 50, 'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'algo': 'adam', 'use_amp': True}, 'preprocess': {'bbox_extension': [0, 0], 'input_extension': [0.05, 0.05], 'trn': {'path': 'lib/augmentation_configs/256x256/jitter+hflip.json'}, 'val': {'path': 'lib/augmentation_configs/256x256/resize_normalize.json'}}, 'training': {'mode': 'noisy', 'base_sigma': 0.75, 'alpha': 0.1, 'beta': 0.8}}
2025-04-02 02:38:18,886 [INFO] running on: cuda:0
2025-04-02 02:38:19,274 [INFO] Model(
  (model): ResNet(
    (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (4): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (5): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (fc): Identity()
  )
  (heads): ModuleDict(
    (age): Linear(in_features=2048, out_features=8, bias=True)
  )
)
2025-04-02 02:38:19,274 [INFO] Number of trn data 11128
2025-04-02 02:38:19,274 [INFO] Number of val data 3274
2025-04-02 02:38:19,604 [INFO] Epoch 10/14
2025-04-02 02:38:19,604 [INFO] ----------------------------------------
2025-04-02 02:38:39,312 [INFO] [trn phase]
2025-04-02 02:38:39,312 [INFO] error: 0.6663 age_error:0.6663
2025-04-02 02:38:39,312 [INFO] loss: 0.1229 age_loss:0.1229
2025-04-02 02:38:46,019 [INFO] [val phase]
2025-04-02 02:38:46,019 [INFO] error: 1.5626 age_error:1.5626
2025-04-02 02:38:46,019 [INFO] loss: 0.7345 age_loss:0.7345
2025-04-02 02:38:46,019 [INFO] Best Epoch: 9
2025-04-02 02:38:46,517 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_10.pth
2025-04-02 02:38:46,666 [INFO] Epoch 11/14
2025-04-02 02:38:46,666 [INFO] ----------------------------------------
2025-04-02 02:39:05,307 [INFO] [trn phase]
2025-04-02 02:39:05,309 [INFO] error: 0.6026 age_error:0.6026
2025-04-02 02:39:05,309 [INFO] loss: 0.1034 age_loss:0.1034
2025-04-02 02:39:11,899 [INFO] [val phase]
2025-04-02 02:39:11,899 [INFO] error: 1.5476 age_error:1.5476
2025-04-02 02:39:11,899 [INFO] loss: 0.7743 age_loss:0.7743
2025-04-02 02:39:11,899 [INFO] Best Epoch: 9
2025-04-02 02:39:12,407 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_11.pth
2025-04-02 02:39:12,571 [INFO] Epoch 12/14
2025-04-02 02:39:12,571 [INFO] ----------------------------------------
2025-04-02 02:39:31,198 [INFO] [trn phase]
2025-04-02 02:39:31,200 [INFO] error: 0.5348 age_error:0.5348
2025-04-02 02:39:31,200 [INFO] loss: 0.0870 age_loss:0.0870
2025-04-02 02:39:37,758 [INFO] [val phase]
2025-04-02 02:39:37,758 [INFO] error: 1.4545 age_error:1.4545
2025-04-02 02:39:37,758 [INFO] loss: 0.7403 age_loss:0.7403
2025-04-02 02:39:37,758 [INFO] Best Epoch: 12
2025-04-02 02:39:38,269 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_12.pth
2025-04-02 02:39:38,517 [INFO] Epoch 13/14
2025-04-02 02:39:38,517 [INFO] ----------------------------------------
2025-04-02 02:39:57,427 [INFO] [trn phase]
2025-04-02 02:39:57,430 [INFO] error: 0.4877 age_error:0.4877
2025-04-02 02:39:57,430 [INFO] loss: 0.0765 age_loss:0.0765
2025-04-02 02:40:04,018 [INFO] [val phase]
2025-04-02 02:40:04,018 [INFO] error: 1.4484 age_error:1.4484
2025-04-02 02:40:04,018 [INFO] loss: 0.7960 age_loss:0.7960
2025-04-02 02:40:04,018 [INFO] Best Epoch: 13
2025-04-02 02:40:04,518 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_13.pth
2025-04-02 02:40:04,710 [INFO] Epoch 14/14
2025-04-02 02:40:04,710 [INFO] ----------------------------------------
2025-04-02 02:40:23,514 [INFO] [trn phase]
2025-04-02 02:40:23,517 [INFO] error: 0.4302 age_error:0.4302
2025-04-02 02:40:23,517 [INFO] loss: 0.0677 age_loss:0.0677
2025-04-02 02:40:30,037 [INFO] [val phase]
2025-04-02 02:40:30,037 [INFO] error: 1.4670 age_error:1.4670
2025-04-02 02:40:30,037 [INFO] loss: 0.7774 age_loss:0.7774
2025-04-02 02:40:30,037 [INFO] Best Epoch: 13
2025-04-02 02:40:30,557 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_14.pth
2025-04-02 02:40:30,765 [INFO] Training complete in 2m 11s
2025-04-02 02:40:30,765 [INFO] Best epoch: 13
2025-04-02 02:41:00,254 [INFO] Model evalution:
2025-04-02 02:41:00,254 [INFO] [trn set]
2025-04-02 02:41:00,254 [INFO] age (mae): 0.4446
2025-04-02 02:41:00,254 [INFO] [val set]
2025-04-02 02:41:00,254 [INFO] age (mae): 1.4487
2025-04-02 02:41:00,254 [INFO] [tst set]
2025-04-02 02:41:00,254 [INFO] age (mae): 1.0758
2025-04-02 02:51:57,054 [INFO] {'data': {'benchmark': 'facebase/benchmarks/Adience.yaml', 'img_dir': '../datasets/', 'output_dir': 'facebase/results/', 'data_dir': 'facebase/data/'}, 'heads': [{'tag': 'age', 'type': 'cjs', 'attribute': 'age', 'labels': [[0], [1], [2], [3], [4], [5], [6], [7]], 'weight': 1, 'metric': ['mae', 'cs5'], 'visual_metric': [{'tag': 'mae'}, {'tag': 'bias'}, {'tag': 'prc', 'target_class': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], 'target_class_name': 'child 0-17', 'target_class_prior': [0.1, 0.2, 0.3]}]}], 'model': {'architecture': 'resnet50', 'use_pretrained': True, 'input_size': [256, 256]}, 'optimizer': {'num_workers': 8, 'num_epochs': 20, 'batch_size': 100, 'improve_patience': 50, 'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'algo': 'adam', 'use_amp': True}, 'preprocess': {'bbox_extension': [0, 0], 'input_extension': [0.05, 0.05], 'trn': {'path': 'lib/augmentation_configs/256x256/jitter+hflip.json'}, 'val': {'path': 'lib/augmentation_configs/256x256/resize_normalize.json'}}, 'training': {'mode': 'noisy', 'base_sigma': 0.75, 'alpha': 0.1, 'beta': 0.8}}
2025-04-02 02:51:57,072 [INFO] running on: cuda:0
2025-04-02 02:51:57,435 [INFO] Model(
  (model): ResNet(
    (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (4): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (5): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (fc): Identity()
  )
  (heads): ModuleDict(
    (age): Linear(in_features=2048, out_features=8, bias=True)
  )
)
2025-04-02 02:51:57,435 [INFO] Number of trn data 11128
2025-04-02 02:51:57,435 [INFO] Number of val data 3274
2025-04-02 02:51:57,776 [INFO] Epoch 15/19
2025-04-02 02:51:57,776 [INFO] ----------------------------------------
2025-04-02 02:52:17,285 [INFO] [trn phase]
2025-04-02 02:52:17,286 [INFO] error: 0.3538 age_error:0.3538
2025-04-02 02:52:17,286 [INFO] loss: 0.0439 age_loss:0.0439
2025-04-02 02:52:24,108 [INFO] [val phase]
2025-04-02 02:52:24,108 [INFO] error: 1.5165 age_error:1.5165
2025-04-02 02:52:24,108 [INFO] loss: 0.7626 age_loss:0.7626
2025-04-02 02:52:24,108 [INFO] Best Epoch: 13
2025-04-02 02:52:24,603 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_15.pth
2025-04-02 02:52:24,824 [INFO] Epoch 16/19
2025-04-02 02:52:24,824 [INFO] ----------------------------------------
2025-04-02 02:52:43,494 [INFO] [trn phase]
2025-04-02 02:52:43,497 [INFO] error: 0.3054 age_error:0.3054
2025-04-02 02:52:43,497 [INFO] loss: 0.0348 age_loss:0.0348
2025-04-02 02:52:50,065 [INFO] [val phase]
2025-04-02 02:52:50,065 [INFO] error: 1.4594 age_error:1.4594
2025-04-02 02:52:50,074 [INFO] loss: 0.7528 age_loss:0.7528
2025-04-02 02:52:50,074 [INFO] Best Epoch: 13
2025-04-02 02:52:50,582 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_16.pth
2025-04-02 02:52:50,820 [INFO] Epoch 17/19
2025-04-02 02:52:50,820 [INFO] ----------------------------------------
2025-04-02 02:53:09,493 [INFO] [trn phase]
2025-04-02 02:53:09,496 [INFO] error: 0.2671 age_error:0.2671
2025-04-02 02:53:09,496 [INFO] loss: 0.0298 age_loss:0.0298
2025-04-02 02:53:16,060 [INFO] [val phase]
2025-04-02 02:53:16,060 [INFO] error: 1.4520 age_error:1.4520
2025-04-02 02:53:16,060 [INFO] loss: 0.7560 age_loss:0.7560
2025-04-02 02:53:16,060 [INFO] Best Epoch: 13
2025-04-02 02:53:16,567 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_17.pth
2025-04-02 02:53:16,875 [INFO] Epoch 18/19
2025-04-02 02:53:16,875 [INFO] ----------------------------------------
2025-04-02 02:53:35,691 [INFO] [trn phase]
2025-04-02 02:53:35,694 [INFO] error: 0.2387 age_error:0.2387
2025-04-02 02:53:35,694 [INFO] loss: 0.0261 age_loss:0.0261
2025-04-02 02:53:42,293 [INFO] [val phase]
2025-04-02 02:53:42,293 [INFO] error: 1.4160 age_error:1.4160
2025-04-02 02:53:42,293 [INFO] loss: 0.7649 age_loss:0.7649
2025-04-02 02:53:42,293 [INFO] Best Epoch: 18
2025-04-02 02:53:42,799 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_18.pth
2025-04-02 02:53:43,075 [INFO] Epoch 19/19
2025-04-02 02:53:43,075 [INFO] ----------------------------------------
2025-04-02 02:54:02,133 [INFO] [trn phase]
2025-04-02 02:54:02,136 [INFO] error: 0.2162 age_error:0.2162
2025-04-02 02:54:02,136 [INFO] loss: 0.0242 age_loss:0.0242
2025-04-02 02:54:08,686 [INFO] [val phase]
2025-04-02 02:54:08,686 [INFO] error: 1.4417 age_error:1.4417
2025-04-02 02:54:08,686 [INFO] loss: 0.7646 age_loss:0.7646
2025-04-02 02:54:08,686 [INFO] Best Epoch: 18
2025-04-02 02:54:09,194 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_19.pth
2025-04-02 02:54:09,476 [INFO] Training complete in 2m 12s
2025-04-02 02:54:09,476 [INFO] Best epoch: 18
2025-04-02 02:54:39,106 [INFO] Model evalution:
2025-04-02 02:54:39,106 [INFO] [trn set]
2025-04-02 02:54:39,106 [INFO] age (mae): 0.3359
2025-04-02 02:54:39,106 [INFO] [val set]
2025-04-02 02:54:39,106 [INFO] age (mae): 1.4163
2025-04-02 02:54:39,106 [INFO] [tst set]
2025-04-02 02:54:39,106 [INFO] age (mae): 0.9621
2025-04-02 03:05:38,494 [INFO] {'data': {'benchmark': 'facebase/benchmarks/Adience.yaml', 'img_dir': '../datasets/', 'output_dir': 'facebase/results/', 'data_dir': 'facebase/data/'}, 'heads': [{'tag': 'age', 'type': 'cjs', 'attribute': 'age', 'labels': [[0], [1], [2], [3], [4], [5], [6], [7]], 'weight': 1, 'metric': ['mae', 'cs5'], 'visual_metric': [{'tag': 'mae'}, {'tag': 'bias'}, {'tag': 'prc', 'target_class': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], 'target_class_name': 'child 0-17', 'target_class_prior': [0.1, 0.2, 0.3]}]}], 'model': {'architecture': 'resnet50', 'use_pretrained': True, 'input_size': [256, 256]}, 'optimizer': {'num_workers': 8, 'num_epochs': 25, 'batch_size': 100, 'improve_patience': 50, 'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'algo': 'adam', 'use_amp': True}, 'preprocess': {'bbox_extension': [0, 0], 'input_extension': [0.05, 0.05], 'trn': {'path': 'lib/augmentation_configs/256x256/jitter+hflip.json'}, 'val': {'path': 'lib/augmentation_configs/256x256/resize_normalize.json'}}, 'training': {'mode': 'noisy', 'base_sigma': 0.75, 'alpha': 0.1, 'beta': 0.8}}
2025-04-02 03:05:38,513 [INFO] running on: cuda:0
2025-04-02 03:05:38,857 [INFO] Model(
  (model): ResNet(
    (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (4): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (5): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (fc): Identity()
  )
  (heads): ModuleDict(
    (age): Linear(in_features=2048, out_features=8, bias=True)
  )
)
2025-04-02 03:05:38,858 [INFO] Number of trn data 11128
2025-04-02 03:05:38,858 [INFO] Number of val data 3274
2025-04-02 03:05:39,232 [INFO] Epoch 20/24
2025-04-02 03:05:39,232 [INFO] ----------------------------------------
2025-04-02 03:05:58,819 [INFO] [trn phase]
2025-04-02 03:05:58,819 [INFO] error: 0.1938 age_error:0.1938
2025-04-02 03:05:58,819 [INFO] loss: 0.0192 age_loss:0.0192
2025-04-02 03:06:05,397 [INFO] [val phase]
2025-04-02 03:06:05,398 [INFO] error: 1.4582 age_error:1.4582
2025-04-02 03:06:05,398 [INFO] loss: 0.7408 age_loss:0.7408
2025-04-02 03:06:05,398 [INFO] Best Epoch: 18
2025-04-02 03:06:05,916 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_20.pth
2025-04-02 03:06:06,218 [INFO] Epoch 21/24
2025-04-02 03:06:06,218 [INFO] ----------------------------------------
2025-04-02 03:06:24,891 [INFO] [trn phase]
2025-04-02 03:06:24,894 [INFO] error: 0.1752 age_error:0.1752
2025-04-02 03:06:24,894 [INFO] loss: 0.0165 age_loss:0.0165
2025-04-02 03:06:31,444 [INFO] [val phase]
2025-04-02 03:06:31,445 [INFO] error: 1.4441 age_error:1.4441
2025-04-02 03:06:31,445 [INFO] loss: 0.7482 age_loss:0.7482
2025-04-02 03:06:31,445 [INFO] Best Epoch: 18
2025-04-02 03:06:31,957 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_21.pth
2025-04-02 03:06:32,278 [INFO] Epoch 22/24
2025-04-02 03:06:32,278 [INFO] ----------------------------------------
2025-04-02 03:06:51,201 [INFO] [trn phase]
2025-04-02 03:06:51,203 [INFO] error: 0.1541 age_error:0.1541
2025-04-02 03:06:51,203 [INFO] loss: 0.0147 age_loss:0.0147
2025-04-02 03:06:57,939 [INFO] [val phase]
2025-04-02 03:06:57,940 [INFO] error: 1.4493 age_error:1.4493
2025-04-02 03:06:57,940 [INFO] loss: 0.7439 age_loss:0.7439
2025-04-02 03:06:57,940 [INFO] Best Epoch: 18
2025-04-02 03:06:58,448 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_22.pth
2025-04-02 03:06:58,829 [INFO] Epoch 23/24
2025-04-02 03:06:58,829 [INFO] ----------------------------------------
2025-04-02 03:07:17,550 [INFO] [trn phase]
2025-04-02 03:07:17,553 [INFO] error: 0.1418 age_error:0.1418
2025-04-02 03:07:17,553 [INFO] loss: 0.0133 age_loss:0.0133
2025-04-02 03:07:24,145 [INFO] [val phase]
2025-04-02 03:07:24,145 [INFO] error: 1.4297 age_error:1.4297
2025-04-02 03:07:24,145 [INFO] loss: 0.7297 age_loss:0.7297
2025-04-02 03:07:24,145 [INFO] Best Epoch: 18
2025-04-02 03:07:24,653 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_23.pth
2025-04-02 03:07:24,991 [INFO] Epoch 24/24
2025-04-02 03:07:24,992 [INFO] ----------------------------------------
2025-04-02 03:07:43,675 [INFO] [trn phase]
2025-04-02 03:07:43,678 [INFO] error: 0.1444 age_error:0.1444
2025-04-02 03:07:43,678 [INFO] loss: 0.0148 age_loss:0.0148
2025-04-02 03:07:50,274 [INFO] [val phase]
2025-04-02 03:07:50,274 [INFO] error: 1.4078 age_error:1.4078
2025-04-02 03:07:50,274 [INFO] loss: 0.7199 age_loss:0.7199
2025-04-02 03:07:50,274 [INFO] Best Epoch: 24
2025-04-02 03:07:50,788 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_24.pth
2025-04-02 03:07:51,144 [INFO] Training complete in 2m 12s
2025-04-02 03:07:51,144 [INFO] Best epoch: 24
2025-04-02 03:08:20,735 [INFO] Model evalution:
2025-04-02 03:08:20,735 [INFO] [trn set]
2025-04-02 03:08:20,735 [INFO] age (mae): 0.2901
2025-04-02 03:08:20,735 [INFO] [val set]
2025-04-02 03:08:20,735 [INFO] age (mae): 1.4078
2025-04-02 03:08:20,735 [INFO] [tst set]
2025-04-02 03:08:20,735 [INFO] age (mae): 0.9167
2025-04-02 03:19:23,428 [INFO] {'data': {'benchmark': 'facebase/benchmarks/Adience.yaml', 'img_dir': '../datasets/', 'output_dir': 'facebase/results/', 'data_dir': 'facebase/data/'}, 'heads': [{'tag': 'age', 'type': 'cjs', 'attribute': 'age', 'labels': [[0], [1], [2], [3], [4], [5], [6], [7]], 'weight': 1, 'metric': ['mae', 'cs5'], 'visual_metric': [{'tag': 'mae'}, {'tag': 'bias'}, {'tag': 'prc', 'target_class': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], 'target_class_name': 'child 0-17', 'target_class_prior': [0.1, 0.2, 0.3]}]}], 'model': {'architecture': 'resnet50', 'use_pretrained': True, 'input_size': [256, 256]}, 'optimizer': {'num_workers': 8, 'num_epochs': 30, 'batch_size': 100, 'improve_patience': 50, 'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'algo': 'adam', 'use_amp': True}, 'preprocess': {'bbox_extension': [0, 0], 'input_extension': [0.05, 0.05], 'trn': {'path': 'lib/augmentation_configs/256x256/jitter+hflip.json'}, 'val': {'path': 'lib/augmentation_configs/256x256/resize_normalize.json'}}, 'training': {'mode': 'noisy', 'base_sigma': 0.75, 'alpha': 0.1, 'beta': 0.8}}
2025-04-02 03:19:23,439 [INFO] running on: cuda:0
2025-04-02 03:19:23,810 [INFO] Model(
  (model): ResNet(
    (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (4): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (5): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (fc): Identity()
  )
  (heads): ModuleDict(
    (age): Linear(in_features=2048, out_features=8, bias=True)
  )
)
2025-04-02 03:19:23,811 [INFO] Number of trn data 11128
2025-04-02 03:19:23,811 [INFO] Number of val data 3274
2025-04-02 03:19:24,193 [INFO] Epoch 25/29
2025-04-02 03:19:24,193 [INFO] ----------------------------------------
2025-04-02 03:19:43,855 [INFO] [trn phase]
2025-04-02 03:19:43,855 [INFO] error: 0.1519 age_error:0.1519
2025-04-02 03:19:43,855 [INFO] loss: 0.0131 age_loss:0.0131
2025-04-02 03:19:50,594 [INFO] [val phase]
2025-04-02 03:19:50,594 [INFO] error: 1.4472 age_error:1.4472
2025-04-02 03:19:50,594 [INFO] loss: 0.7004 age_loss:0.7004
2025-04-02 03:19:50,594 [INFO] Best Epoch: 24
2025-04-02 03:19:51,089 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_25.pth
2025-04-02 03:19:51,469 [INFO] Epoch 26/29
2025-04-02 03:19:51,469 [INFO] ----------------------------------------
2025-04-02 03:20:10,117 [INFO] [trn phase]
2025-04-02 03:20:10,119 [INFO] error: 0.1465 age_error:0.1465
2025-04-02 03:20:10,119 [INFO] loss: 0.0130 age_loss:0.0130
2025-04-02 03:20:16,662 [INFO] [val phase]
2025-04-02 03:20:16,662 [INFO] error: 1.4404 age_error:1.4404
2025-04-02 03:20:16,662 [INFO] loss: 0.7248 age_loss:0.7248
2025-04-02 03:20:16,662 [INFO] Best Epoch: 24
2025-04-02 03:20:17,165 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_26.pth
2025-04-02 03:20:17,560 [INFO] Epoch 27/29
2025-04-02 03:20:17,560 [INFO] ----------------------------------------
2025-04-02 03:20:36,362 [INFO] [trn phase]
2025-04-02 03:20:36,366 [INFO] error: 0.1380 age_error:0.1380
2025-04-02 03:20:36,366 [INFO] loss: 0.0118 age_loss:0.0118
2025-04-02 03:20:43,073 [INFO] [val phase]
2025-04-02 03:20:43,073 [INFO] error: 1.4301 age_error:1.4301
2025-04-02 03:20:43,073 [INFO] loss: 0.7007 age_loss:0.7007
2025-04-02 03:20:43,073 [INFO] Best Epoch: 24
2025-04-02 03:20:43,586 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_27.pth
2025-04-02 03:20:44,054 [INFO] Epoch 28/29
2025-04-02 03:20:44,054 [INFO] ----------------------------------------
2025-04-02 03:21:02,705 [INFO] [trn phase]
2025-04-02 03:21:02,708 [INFO] error: 0.1325 age_error:0.1325
2025-04-02 03:21:02,708 [INFO] loss: 0.0110 age_loss:0.0110
2025-04-02 03:21:09,309 [INFO] [val phase]
2025-04-02 03:21:09,309 [INFO] error: 1.4172 age_error:1.4172
2025-04-02 03:21:09,309 [INFO] loss: 0.7026 age_loss:0.7026
2025-04-02 03:21:09,309 [INFO] Best Epoch: 24
2025-04-02 03:21:09,823 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_28.pth
2025-04-02 03:21:10,239 [INFO] Epoch 29/29
2025-04-02 03:21:10,239 [INFO] ----------------------------------------
2025-04-02 03:21:28,748 [INFO] [trn phase]
2025-04-02 03:21:28,752 [INFO] error: 0.1356 age_error:0.1356
2025-04-02 03:21:28,752 [INFO] loss: 0.0120 age_loss:0.0120
2025-04-02 03:21:35,337 [INFO] [val phase]
2025-04-02 03:21:35,337 [INFO] error: 1.3855 age_error:1.3855
2025-04-02 03:21:35,337 [INFO] loss: 0.6993 age_loss:0.6993
2025-04-02 03:21:35,337 [INFO] Best Epoch: 29
2025-04-02 03:21:35,843 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_29.pth
2025-04-02 03:21:36,282 [INFO] Training complete in 2m 12s
2025-04-02 03:21:36,282 [INFO] Best epoch: 29
2025-04-02 03:22:05,532 [INFO] Model evalution:
2025-04-02 03:22:05,532 [INFO] [trn set]
2025-04-02 03:22:05,532 [INFO] age (mae): 0.3077
2025-04-02 03:22:05,532 [INFO] [val set]
2025-04-02 03:22:05,532 [INFO] age (mae): 1.3757
2025-04-02 03:22:05,532 [INFO] [tst set]
2025-04-02 03:22:05,532 [INFO] age (mae): 0.8885
2025-04-02 03:33:05,935 [INFO] {'data': {'benchmark': 'facebase/benchmarks/Adience.yaml', 'img_dir': '../datasets/', 'output_dir': 'facebase/results/', 'data_dir': 'facebase/data/'}, 'heads': [{'tag': 'age', 'type': 'cjs', 'attribute': 'age', 'labels': [[0], [1], [2], [3], [4], [5], [6], [7]], 'weight': 1, 'metric': ['mae', 'cs5'], 'visual_metric': [{'tag': 'mae'}, {'tag': 'bias'}, {'tag': 'prc', 'target_class': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], 'target_class_name': 'child 0-17', 'target_class_prior': [0.1, 0.2, 0.3]}]}], 'model': {'architecture': 'resnet50', 'use_pretrained': True, 'input_size': [256, 256]}, 'optimizer': {'num_workers': 8, 'num_epochs': 35, 'batch_size': 100, 'improve_patience': 50, 'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'algo': 'adam', 'use_amp': True}, 'preprocess': {'bbox_extension': [0, 0], 'input_extension': [0.05, 0.05], 'trn': {'path': 'lib/augmentation_configs/256x256/jitter+hflip.json'}, 'val': {'path': 'lib/augmentation_configs/256x256/resize_normalize.json'}}, 'training': {'mode': 'noisy', 'base_sigma': 0.75, 'alpha': 0.1, 'beta': 0.8}}
2025-04-02 03:33:05,953 [INFO] running on: cuda:0
2025-04-02 03:33:06,306 [INFO] Model(
  (model): ResNet(
    (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (4): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (5): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (fc): Identity()
  )
  (heads): ModuleDict(
    (age): Linear(in_features=2048, out_features=8, bias=True)
  )
)
2025-04-02 03:33:06,307 [INFO] Number of trn data 11128
2025-04-02 03:33:06,307 [INFO] Number of val data 3274
2025-04-02 03:33:06,722 [INFO] Epoch 30/34
2025-04-02 03:33:06,722 [INFO] ----------------------------------------
2025-04-02 03:33:26,523 [INFO] [trn phase]
2025-04-02 03:33:26,523 [INFO] error: 0.1564 age_error:0.1564
2025-04-02 03:33:26,523 [INFO] loss: 0.0115 age_loss:0.0115
2025-04-02 03:33:33,381 [INFO] [val phase]
2025-04-02 03:33:33,381 [INFO] error: 1.4386 age_error:1.4386
2025-04-02 03:33:33,381 [INFO] loss: 0.6656 age_loss:0.6656
2025-04-02 03:33:33,381 [INFO] Best Epoch: 29
2025-04-02 03:33:33,877 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_30.pth
2025-04-02 03:33:34,313 [INFO] Epoch 31/34
2025-04-02 03:33:34,313 [INFO] ----------------------------------------
2025-04-02 03:33:52,895 [INFO] [trn phase]
2025-04-02 03:33:52,897 [INFO] error: 0.1485 age_error:0.1485
2025-04-02 03:33:52,897 [INFO] loss: 0.0109 age_loss:0.0109
2025-04-02 03:33:59,512 [INFO] [val phase]
2025-04-02 03:33:59,513 [INFO] error: 1.4261 age_error:1.4261
2025-04-02 03:33:59,513 [INFO] loss: 0.6672 age_loss:0.6672
2025-04-02 03:33:59,513 [INFO] Best Epoch: 29
2025-04-02 03:34:00,021 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_31.pth
2025-04-02 03:34:00,485 [INFO] Epoch 32/34
2025-04-02 03:34:00,485 [INFO] ----------------------------------------
2025-04-02 03:34:19,716 [INFO] [trn phase]
2025-04-02 03:34:19,719 [INFO] error: 0.1491 age_error:0.1491
2025-04-02 03:34:19,719 [INFO] loss: 0.0107 age_loss:0.0107
2025-04-02 03:34:26,325 [INFO] [val phase]
2025-04-02 03:34:26,325 [INFO] error: 1.4041 age_error:1.4041
2025-04-02 03:34:26,325 [INFO] loss: 0.6630 age_loss:0.6630
2025-04-02 03:34:26,325 [INFO] Best Epoch: 29
2025-04-02 03:34:26,842 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_32.pth
2025-04-02 03:34:27,392 [INFO] Epoch 33/34
2025-04-02 03:34:27,392 [INFO] ----------------------------------------
2025-04-02 03:34:46,052 [INFO] [trn phase]
2025-04-02 03:34:46,054 [INFO] error: 0.1431 age_error:0.1431
2025-04-02 03:34:46,054 [INFO] loss: 0.0100 age_loss:0.0100
2025-04-02 03:34:52,631 [INFO] [val phase]
2025-04-02 03:34:52,631 [INFO] error: 1.4676 age_error:1.4676
2025-04-02 03:34:52,631 [INFO] loss: 0.6705 age_loss:0.6705
2025-04-02 03:34:52,631 [INFO] Best Epoch: 29
2025-04-02 03:34:53,147 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_33.pth
2025-04-02 03:34:53,647 [INFO] Epoch 34/34
2025-04-02 03:34:53,647 [INFO] ----------------------------------------
2025-04-02 03:35:12,471 [INFO] [trn phase]
2025-04-02 03:35:12,474 [INFO] error: 0.1566 age_error:0.1566
2025-04-02 03:35:12,474 [INFO] loss: 0.0113 age_loss:0.0113
2025-04-02 03:35:19,257 [INFO] [val phase]
2025-04-02 03:35:19,257 [INFO] error: 1.4194 age_error:1.4194
2025-04-02 03:35:19,257 [INFO] loss: 0.6612 age_loss:0.6612
2025-04-02 03:35:19,257 [INFO] Best Epoch: 29
2025-04-02 03:35:19,762 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_34.pth
2025-04-02 03:35:20,280 [INFO] Training complete in 2m 14s
2025-04-02 03:35:20,280 [INFO] Best epoch: 29
2025-04-02 03:35:49,818 [INFO] Model evalution:
2025-04-02 03:35:49,818 [INFO] [trn set]
2025-04-02 03:35:49,819 [INFO] age (mae): 0.3020
2025-04-02 03:35:49,819 [INFO] [val set]
2025-04-02 03:35:49,819 [INFO] age (mae): 1.3626
2025-04-02 03:35:49,819 [INFO] [tst set]
2025-04-02 03:35:49,819 [INFO] age (mae): 0.8885
2025-04-02 03:46:55,492 [INFO] {'data': {'benchmark': 'facebase/benchmarks/Adience.yaml', 'img_dir': '../datasets/', 'output_dir': 'facebase/results/', 'data_dir': 'facebase/data/'}, 'heads': [{'tag': 'age', 'type': 'cjs', 'attribute': 'age', 'labels': [[0], [1], [2], [3], [4], [5], [6], [7]], 'weight': 1, 'metric': ['mae', 'cs5'], 'visual_metric': [{'tag': 'mae'}, {'tag': 'bias'}, {'tag': 'prc', 'target_class': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], 'target_class_name': 'child 0-17', 'target_class_prior': [0.1, 0.2, 0.3]}]}], 'model': {'architecture': 'resnet50', 'use_pretrained': True, 'input_size': [256, 256]}, 'optimizer': {'num_workers': 8, 'num_epochs': 40, 'batch_size': 100, 'improve_patience': 50, 'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'algo': 'adam', 'use_amp': True}, 'preprocess': {'bbox_extension': [0, 0], 'input_extension': [0.05, 0.05], 'trn': {'path': 'lib/augmentation_configs/256x256/jitter+hflip.json'}, 'val': {'path': 'lib/augmentation_configs/256x256/resize_normalize.json'}}, 'training': {'mode': 'noisy', 'base_sigma': 0.75, 'alpha': 0.1, 'beta': 0.8}}
2025-04-02 03:46:55,502 [INFO] running on: cuda:0
2025-04-02 03:46:55,897 [INFO] Model(
  (model): ResNet(
    (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (4): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (5): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (fc): Identity()
  )
  (heads): ModuleDict(
    (age): Linear(in_features=2048, out_features=8, bias=True)
  )
)
2025-04-02 03:46:55,898 [INFO] Number of trn data 11128
2025-04-02 03:46:55,898 [INFO] Number of val data 3274
2025-04-02 03:46:56,332 [INFO] Epoch 35/39
2025-04-02 03:46:56,332 [INFO] ----------------------------------------
2025-04-02 03:47:16,118 [INFO] [trn phase]
2025-04-02 03:47:16,118 [INFO] error: 0.1822 age_error:0.1822
2025-04-02 03:47:16,118 [INFO] loss: 0.0125 age_loss:0.0125
2025-04-02 03:47:22,853 [INFO] [val phase]
2025-04-02 03:47:22,853 [INFO] error: 1.4365 age_error:1.4365
2025-04-02 03:47:22,853 [INFO] loss: 0.6915 age_loss:0.6915
2025-04-02 03:47:22,853 [INFO] Best Epoch: 29
2025-04-02 03:47:23,358 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_35.pth
2025-04-02 03:47:23,876 [INFO] Epoch 36/39
2025-04-02 03:47:23,876 [INFO] ----------------------------------------
2025-04-02 03:47:42,791 [INFO] [trn phase]
2025-04-02 03:47:42,794 [INFO] error: 0.1715 age_error:0.1715
2025-04-02 03:47:42,794 [INFO] loss: 0.0111 age_loss:0.0111
2025-04-02 03:47:49,395 [INFO] [val phase]
2025-04-02 03:47:49,395 [INFO] error: 1.4624 age_error:1.4624
2025-04-02 03:47:49,395 [INFO] loss: 0.6438 age_loss:0.6438
2025-04-02 03:47:49,395 [INFO] Best Epoch: 29
2025-04-02 03:47:49,906 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_36.pth
2025-04-02 03:47:50,434 [INFO] Epoch 37/39
2025-04-02 03:47:50,434 [INFO] ----------------------------------------
2025-04-02 03:48:09,327 [INFO] [trn phase]
2025-04-02 03:48:09,329 [INFO] error: 0.1824 age_error:0.1824
2025-04-02 03:48:09,329 [INFO] loss: 0.0121 age_loss:0.0121
2025-04-02 03:48:15,881 [INFO] [val phase]
2025-04-02 03:48:15,881 [INFO] error: 1.4068 age_error:1.4068
2025-04-02 03:48:15,881 [INFO] loss: 0.6372 age_loss:0.6372
2025-04-02 03:48:15,881 [INFO] Best Epoch: 29
2025-04-02 03:48:16,391 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_37.pth
2025-04-02 03:48:17,001 [INFO] Epoch 38/39
2025-04-02 03:48:17,001 [INFO] ----------------------------------------
2025-04-02 03:48:35,799 [INFO] [trn phase]
2025-04-02 03:48:35,802 [INFO] error: 0.1676 age_error:0.1676
2025-04-02 03:48:35,802 [INFO] loss: 0.0104 age_loss:0.0104
2025-04-02 03:48:42,394 [INFO] [val phase]
2025-04-02 03:48:42,394 [INFO] error: 1.4472 age_error:1.4472
2025-04-02 03:48:42,394 [INFO] loss: 0.6396 age_loss:0.6396
2025-04-02 03:48:42,394 [INFO] Best Epoch: 29
2025-04-02 03:48:42,909 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_38.pth
2025-04-02 03:48:43,479 [INFO] Epoch 39/39
2025-04-02 03:48:43,479 [INFO] ----------------------------------------
2025-04-02 03:49:02,255 [INFO] [trn phase]
2025-04-02 03:49:02,258 [INFO] error: 0.1739 age_error:0.1739
2025-04-02 03:49:02,258 [INFO] loss: 0.0113 age_loss:0.0113
2025-04-02 03:49:08,833 [INFO] [val phase]
2025-04-02 03:49:08,833 [INFO] error: 1.4313 age_error:1.4313
2025-04-02 03:49:08,833 [INFO] loss: 0.6818 age_loss:0.6818
2025-04-02 03:49:08,833 [INFO] Best Epoch: 29
2025-04-02 03:49:09,342 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_39.pth
2025-04-02 03:49:09,928 [INFO] Training complete in 2m 14s
2025-04-02 03:49:09,929 [INFO] Best epoch: 29
2025-04-02 03:49:39,524 [INFO] Model evalution:
2025-04-02 03:49:39,524 [INFO] [trn set]
2025-04-02 03:49:39,524 [INFO] age (mae): 0.2989
2025-04-02 03:49:39,524 [INFO] [val set]
2025-04-02 03:49:39,524 [INFO] age (mae): 1.3332
2025-04-02 03:49:39,524 [INFO] [tst set]
2025-04-02 03:49:39,524 [INFO] age (mae): 0.8885
2025-04-02 04:00:45,772 [INFO] {'data': {'benchmark': 'facebase/benchmarks/Adience.yaml', 'img_dir': '../datasets/', 'output_dir': 'facebase/results/', 'data_dir': 'facebase/data/'}, 'heads': [{'tag': 'age', 'type': 'cjs', 'attribute': 'age', 'labels': [[0], [1], [2], [3], [4], [5], [6], [7]], 'weight': 1, 'metric': ['mae', 'cs5'], 'visual_metric': [{'tag': 'mae'}, {'tag': 'bias'}, {'tag': 'prc', 'target_class': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], 'target_class_name': 'child 0-17', 'target_class_prior': [0.1, 0.2, 0.3]}]}], 'model': {'architecture': 'resnet50', 'use_pretrained': True, 'input_size': [256, 256]}, 'optimizer': {'num_workers': 8, 'num_epochs': 45, 'batch_size': 100, 'improve_patience': 50, 'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'algo': 'adam', 'use_amp': True}, 'preprocess': {'bbox_extension': [0, 0], 'input_extension': [0.05, 0.05], 'trn': {'path': 'lib/augmentation_configs/256x256/jitter+hflip.json'}, 'val': {'path': 'lib/augmentation_configs/256x256/resize_normalize.json'}}, 'training': {'mode': 'noisy', 'base_sigma': 0.75, 'alpha': 0.1, 'beta': 0.8}}
2025-04-02 04:00:45,791 [INFO] running on: cuda:0
2025-04-02 04:00:46,157 [INFO] Model(
  (model): ResNet(
    (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (4): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (5): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (fc): Identity()
  )
  (heads): ModuleDict(
    (age): Linear(in_features=2048, out_features=8, bias=True)
  )
)
2025-04-02 04:00:46,158 [INFO] Number of trn data 11128
2025-04-02 04:00:46,158 [INFO] Number of val data 3274
2025-04-02 04:00:46,629 [INFO] Epoch 40/44
2025-04-02 04:00:46,629 [INFO] ----------------------------------------
2025-04-02 04:01:06,118 [INFO] [trn phase]
2025-04-02 04:01:06,119 [INFO] error: 0.2302 age_error:0.2302
2025-04-02 04:01:06,119 [INFO] loss: 0.0161 age_loss:0.0161
2025-04-02 04:01:12,933 [INFO] [val phase]
2025-04-02 04:01:12,933 [INFO] error: 1.4762 age_error:1.4762
2025-04-02 04:01:12,933 [INFO] loss: 0.6800 age_loss:0.6800
2025-04-02 04:01:12,933 [INFO] Best Epoch: 29
2025-04-02 04:01:13,431 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_40.pth
2025-04-02 04:01:14,012 [INFO] Epoch 41/44
2025-04-02 04:01:14,012 [INFO] ----------------------------------------
2025-04-02 04:01:32,740 [INFO] [trn phase]
2025-04-02 04:01:32,742 [INFO] error: 0.2471 age_error:0.2471
2025-04-02 04:01:32,742 [INFO] loss: 0.0201 age_loss:0.0201
2025-04-02 04:01:39,332 [INFO] [val phase]
2025-04-02 04:01:39,332 [INFO] error: 1.4646 age_error:1.4646
2025-04-02 04:01:39,332 [INFO] loss: 0.6385 age_loss:0.6385
2025-04-02 04:01:39,332 [INFO] Best Epoch: 29
2025-04-02 04:01:39,839 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_41.pth
2025-04-02 04:01:40,448 [INFO] Epoch 42/44
2025-04-02 04:01:40,448 [INFO] ----------------------------------------
2025-04-02 04:01:59,218 [INFO] [trn phase]
2025-04-02 04:01:59,221 [INFO] error: 0.2527 age_error:0.2527
2025-04-02 04:01:59,221 [INFO] loss: 0.0201 age_loss:0.0201
2025-04-02 04:02:05,803 [INFO] [val phase]
2025-04-02 04:02:05,803 [INFO] error: 1.4114 age_error:1.4114
2025-04-02 04:02:05,803 [INFO] loss: 0.6273 age_loss:0.6273
2025-04-02 04:02:05,803 [INFO] Best Epoch: 29
2025-04-02 04:02:06,322 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_42.pth
2025-04-02 04:02:07,031 [INFO] Epoch 43/44
2025-04-02 04:02:07,031 [INFO] ----------------------------------------
2025-04-02 04:02:25,949 [INFO] [trn phase]
2025-04-02 04:02:25,952 [INFO] error: 0.3436 age_error:0.3436
2025-04-02 04:02:25,952 [INFO] loss: 0.0368 age_loss:0.0368
2025-04-02 04:02:32,560 [INFO] [val phase]
2025-04-02 04:02:32,560 [INFO] error: 1.4026 age_error:1.4026
2025-04-02 04:02:32,560 [INFO] loss: 0.6620 age_loss:0.6620
2025-04-02 04:02:32,560 [INFO] Best Epoch: 29
2025-04-02 04:02:33,087 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_43.pth
2025-04-02 04:02:33,733 [INFO] Epoch 44/44
2025-04-02 04:02:33,733 [INFO] ----------------------------------------
2025-04-02 04:02:52,302 [INFO] [trn phase]
2025-04-02 04:02:52,304 [INFO] error: 0.4132 age_error:0.4132
2025-04-02 04:02:52,304 [INFO] loss: 0.0569 age_loss:0.0569
2025-04-02 04:02:58,899 [INFO] [val phase]
2025-04-02 04:02:58,899 [INFO] error: 1.5864 age_error:1.5864
2025-04-02 04:02:58,899 [INFO] loss: 0.6625 age_loss:0.6625
2025-04-02 04:02:58,899 [INFO] Best Epoch: 29
2025-04-02 04:02:59,413 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_44.pth
2025-04-02 04:03:00,086 [INFO] Training complete in 2m 14s
2025-04-02 04:03:00,086 [INFO] Best epoch: 29
2025-04-02 04:03:29,873 [INFO] Model evalution:
2025-04-02 04:03:29,873 [INFO] [trn set]
2025-04-02 04:03:29,873 [INFO] age (mae): 0.3005
2025-04-02 04:03:29,873 [INFO] [val set]
2025-04-02 04:03:29,873 [INFO] age (mae): 1.3005
2025-04-02 04:03:29,873 [INFO] [tst set]
2025-04-02 04:03:29,873 [INFO] age (mae): 0.8885
2025-04-02 04:14:38,337 [INFO] {'data': {'benchmark': 'facebase/benchmarks/Adience.yaml', 'img_dir': '../datasets/', 'output_dir': 'facebase/results/', 'data_dir': 'facebase/data/'}, 'heads': [{'tag': 'age', 'type': 'cjs', 'attribute': 'age', 'labels': [[0], [1], [2], [3], [4], [5], [6], [7]], 'weight': 1, 'metric': ['mae', 'cs5'], 'visual_metric': [{'tag': 'mae'}, {'tag': 'bias'}, {'tag': 'prc', 'target_class': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], 'target_class_name': 'child 0-17', 'target_class_prior': [0.1, 0.2, 0.3]}]}], 'model': {'architecture': 'resnet50', 'use_pretrained': True, 'input_size': [256, 256]}, 'optimizer': {'num_workers': 8, 'num_epochs': 50, 'batch_size': 100, 'improve_patience': 50, 'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'algo': 'adam', 'use_amp': True}, 'preprocess': {'bbox_extension': [0, 0], 'input_extension': [0.05, 0.05], 'trn': {'path': 'lib/augmentation_configs/256x256/jitter+hflip.json'}, 'val': {'path': 'lib/augmentation_configs/256x256/resize_normalize.json'}}, 'training': {'mode': 'noisy', 'base_sigma': 0.75, 'alpha': 0.1, 'beta': 0.8}}
2025-04-02 04:14:38,356 [INFO] running on: cuda:0
2025-04-02 04:14:38,710 [INFO] Model(
  (model): ResNet(
    (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (4): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (5): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (fc): Identity()
  )
  (heads): ModuleDict(
    (age): Linear(in_features=2048, out_features=8, bias=True)
  )
)
2025-04-02 04:14:38,710 [INFO] Number of trn data 11128
2025-04-02 04:14:38,710 [INFO] Number of val data 3274
2025-04-02 04:14:39,200 [INFO] Epoch 45/49
2025-04-02 04:14:39,200 [INFO] ----------------------------------------
2025-04-02 04:14:59,166 [INFO] [trn phase]
2025-04-02 04:14:59,167 [INFO] error: 0.5106 age_error:0.5106
2025-04-02 04:14:59,167 [INFO] loss: 0.0726 age_loss:0.0726
2025-04-02 04:15:05,994 [INFO] [val phase]
2025-04-02 04:15:05,994 [INFO] error: 1.5058 age_error:1.5058
2025-04-02 04:15:05,994 [INFO] loss: 0.7315 age_loss:0.7315
2025-04-02 04:15:05,994 [INFO] Best Epoch: 29
2025-04-02 04:15:06,493 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_45.pth
2025-04-02 04:15:07,156 [INFO] Epoch 46/49
2025-04-02 04:15:07,156 [INFO] ----------------------------------------
2025-04-02 04:15:25,948 [INFO] [trn phase]
2025-04-02 04:15:25,950 [INFO] error: 0.5013 age_error:0.5013
2025-04-02 04:15:25,950 [INFO] loss: 0.0721 age_loss:0.0721
2025-04-02 04:15:32,539 [INFO] [val phase]
2025-04-02 04:15:32,540 [INFO] error: 1.4869 age_error:1.4869
2025-04-02 04:15:32,540 [INFO] loss: 0.6675 age_loss:0.6675
2025-04-02 04:15:32,540 [INFO] Best Epoch: 29
2025-04-02 04:15:33,051 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_46.pth
2025-04-02 04:15:33,749 [INFO] Epoch 47/49
2025-04-02 04:15:33,749 [INFO] ----------------------------------------
2025-04-02 04:15:52,298 [INFO] [trn phase]
2025-04-02 04:15:52,300 [INFO] error: 0.4260 age_error:0.4260
2025-04-02 04:15:52,300 [INFO] loss: 0.0493 age_loss:0.0493
2025-04-02 04:15:58,886 [INFO] [val phase]
2025-04-02 04:15:58,886 [INFO] error: 1.4600 age_error:1.4600
2025-04-02 04:15:58,886 [INFO] loss: 0.6270 age_loss:0.6270
2025-04-02 04:15:58,886 [INFO] Best Epoch: 29
2025-04-02 04:15:59,415 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_47.pth
2025-04-02 04:16:00,206 [INFO] Epoch 48/49
2025-04-02 04:16:00,206 [INFO] ----------------------------------------
2025-04-02 04:16:18,975 [INFO] [trn phase]
2025-04-02 04:16:18,977 [INFO] error: 0.3747 age_error:0.3747
2025-04-02 04:16:18,977 [INFO] loss: 0.0357 age_loss:0.0357
2025-04-02 04:16:25,521 [INFO] [val phase]
2025-04-02 04:16:25,521 [INFO] error: 1.4157 age_error:1.4157
2025-04-02 04:16:25,521 [INFO] loss: 0.6517 age_loss:0.6517
2025-04-02 04:16:25,521 [INFO] Best Epoch: 29
2025-04-02 04:16:26,027 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_48.pth
2025-04-02 04:16:26,756 [INFO] Epoch 49/49
2025-04-02 04:16:26,756 [INFO] ----------------------------------------
2025-04-02 04:16:45,667 [INFO] [trn phase]
2025-04-02 04:16:45,668 [INFO] error: 0.3293 age_error:0.3293
2025-04-02 04:16:45,668 [INFO] loss: 0.0311 age_loss:0.0311
2025-04-02 04:16:52,252 [INFO] [val phase]
2025-04-02 04:16:52,253 [INFO] error: 1.4340 age_error:1.4340
2025-04-02 04:16:52,253 [INFO] loss: 0.6113 age_loss:0.6113
2025-04-02 04:16:52,253 [INFO] Best Epoch: 29
2025-04-02 04:16:52,764 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split2/checkpoint_49.pth
2025-04-02 04:16:53,509 [INFO] Training complete in 2m 15s
2025-04-02 04:16:53,509 [INFO] Best epoch: 29
2025-04-02 04:17:23,412 [INFO] Model evalution:
2025-04-02 04:17:23,413 [INFO] [trn set]
2025-04-02 04:17:23,413 [INFO] age (mae): 0.3053
2025-04-02 04:17:23,413 [INFO] [val set]
2025-04-02 04:17:23,413 [INFO] age (mae): 1.2688
2025-04-02 04:17:23,413 [INFO] [tst set]
2025-04-02 04:17:23,413 [INFO] age (mae): 0.8885
