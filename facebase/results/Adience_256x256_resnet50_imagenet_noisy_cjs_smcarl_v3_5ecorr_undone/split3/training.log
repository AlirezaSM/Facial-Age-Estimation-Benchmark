2025-04-02 02:23:17,469 [INFO] {'data': {'benchmark': 'facebase/benchmarks/Adience.yaml', 'img_dir': '../datasets/', 'output_dir': 'facebase/results/', 'data_dir': 'facebase/data/'}, 'heads': [{'tag': 'age', 'type': 'cjs', 'attribute': 'age', 'labels': [[0], [1], [2], [3], [4], [5], [6], [7]], 'weight': 1, 'metric': ['mae', 'cs5'], 'visual_metric': [{'tag': 'mae'}, {'tag': 'bias'}, {'tag': 'prc', 'target_class': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], 'target_class_name': 'child 0-17', 'target_class_prior': [0.1, 0.2, 0.3]}]}], 'model': {'architecture': 'resnet50', 'use_pretrained': True, 'input_size': [256, 256]}, 'optimizer': {'num_workers': 8, 'num_epochs': 10, 'batch_size': 100, 'improve_patience': 50, 'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'algo': 'adam', 'use_amp': True}, 'preprocess': {'bbox_extension': [0, 0], 'input_extension': [0.05, 0.05], 'trn': {'path': 'lib/augmentation_configs/256x256/jitter+hflip.json'}, 'val': {'path': 'lib/augmentation_configs/256x256/resize_normalize.json'}}, 'training': {'mode': 'noisy', 'base_sigma': 0.75, 'alpha': 0.1, 'beta': 0.8}}
2025-04-02 02:23:17,479 [INFO] running on: cuda:0
2025-04-02 02:23:17,859 [INFO] Params to learn:
2025-04-02 02:23:17,859 [INFO] 	 model.conv1.weight, 9408
2025-04-02 02:23:17,859 [INFO] 	 model.bn1.weight, 64
2025-04-02 02:23:17,859 [INFO] 	 model.bn1.bias, 64
2025-04-02 02:23:17,859 [INFO] 	 model.layer1.0.conv1.weight, 4096
2025-04-02 02:23:17,859 [INFO] 	 model.layer1.0.bn1.weight, 64
2025-04-02 02:23:17,859 [INFO] 	 model.layer1.0.bn1.bias, 64
2025-04-02 02:23:17,859 [INFO] 	 model.layer1.0.conv2.weight, 36864
2025-04-02 02:23:17,859 [INFO] 	 model.layer1.0.bn2.weight, 64
2025-04-02 02:23:17,859 [INFO] 	 model.layer1.0.bn2.bias, 64
2025-04-02 02:23:17,859 [INFO] 	 model.layer1.0.conv3.weight, 16384
2025-04-02 02:23:17,859 [INFO] 	 model.layer1.0.bn3.weight, 256
2025-04-02 02:23:17,859 [INFO] 	 model.layer1.0.bn3.bias, 256
2025-04-02 02:23:17,859 [INFO] 	 model.layer1.0.downsample.0.weight, 16384
2025-04-02 02:23:17,859 [INFO] 	 model.layer1.0.downsample.1.weight, 256
2025-04-02 02:23:17,859 [INFO] 	 model.layer1.0.downsample.1.bias, 256
2025-04-02 02:23:17,859 [INFO] 	 model.layer1.1.conv1.weight, 16384
2025-04-02 02:23:17,859 [INFO] 	 model.layer1.1.bn1.weight, 64
2025-04-02 02:23:17,859 [INFO] 	 model.layer1.1.bn1.bias, 64
2025-04-02 02:23:17,859 [INFO] 	 model.layer1.1.conv2.weight, 36864
2025-04-02 02:23:17,859 [INFO] 	 model.layer1.1.bn2.weight, 64
2025-04-02 02:23:17,859 [INFO] 	 model.layer1.1.bn2.bias, 64
2025-04-02 02:23:17,859 [INFO] 	 model.layer1.1.conv3.weight, 16384
2025-04-02 02:23:17,859 [INFO] 	 model.layer1.1.bn3.weight, 256
2025-04-02 02:23:17,859 [INFO] 	 model.layer1.1.bn3.bias, 256
2025-04-02 02:23:17,859 [INFO] 	 model.layer1.2.conv1.weight, 16384
2025-04-02 02:23:17,859 [INFO] 	 model.layer1.2.bn1.weight, 64
2025-04-02 02:23:17,859 [INFO] 	 model.layer1.2.bn1.bias, 64
2025-04-02 02:23:17,859 [INFO] 	 model.layer1.2.conv2.weight, 36864
2025-04-02 02:23:17,859 [INFO] 	 model.layer1.2.bn2.weight, 64
2025-04-02 02:23:17,859 [INFO] 	 model.layer1.2.bn2.bias, 64
2025-04-02 02:23:17,859 [INFO] 	 model.layer1.2.conv3.weight, 16384
2025-04-02 02:23:17,859 [INFO] 	 model.layer1.2.bn3.weight, 256
2025-04-02 02:23:17,859 [INFO] 	 model.layer1.2.bn3.bias, 256
2025-04-02 02:23:17,859 [INFO] 	 model.layer2.0.conv1.weight, 32768
2025-04-02 02:23:17,859 [INFO] 	 model.layer2.0.bn1.weight, 128
2025-04-02 02:23:17,859 [INFO] 	 model.layer2.0.bn1.bias, 128
2025-04-02 02:23:17,859 [INFO] 	 model.layer2.0.conv2.weight, 147456
2025-04-02 02:23:17,859 [INFO] 	 model.layer2.0.bn2.weight, 128
2025-04-02 02:23:17,859 [INFO] 	 model.layer2.0.bn2.bias, 128
2025-04-02 02:23:17,859 [INFO] 	 model.layer2.0.conv3.weight, 65536
2025-04-02 02:23:17,859 [INFO] 	 model.layer2.0.bn3.weight, 512
2025-04-02 02:23:17,859 [INFO] 	 model.layer2.0.bn3.bias, 512
2025-04-02 02:23:17,859 [INFO] 	 model.layer2.0.downsample.0.weight, 131072
2025-04-02 02:23:17,859 [INFO] 	 model.layer2.0.downsample.1.weight, 512
2025-04-02 02:23:17,859 [INFO] 	 model.layer2.0.downsample.1.bias, 512
2025-04-02 02:23:17,859 [INFO] 	 model.layer2.1.conv1.weight, 65536
2025-04-02 02:23:17,859 [INFO] 	 model.layer2.1.bn1.weight, 128
2025-04-02 02:23:17,859 [INFO] 	 model.layer2.1.bn1.bias, 128
2025-04-02 02:23:17,859 [INFO] 	 model.layer2.1.conv2.weight, 147456
2025-04-02 02:23:17,859 [INFO] 	 model.layer2.1.bn2.weight, 128
2025-04-02 02:23:17,859 [INFO] 	 model.layer2.1.bn2.bias, 128
2025-04-02 02:23:17,859 [INFO] 	 model.layer2.1.conv3.weight, 65536
2025-04-02 02:23:17,859 [INFO] 	 model.layer2.1.bn3.weight, 512
2025-04-02 02:23:17,859 [INFO] 	 model.layer2.1.bn3.bias, 512
2025-04-02 02:23:17,859 [INFO] 	 model.layer2.2.conv1.weight, 65536
2025-04-02 02:23:17,860 [INFO] 	 model.layer2.2.bn1.weight, 128
2025-04-02 02:23:17,860 [INFO] 	 model.layer2.2.bn1.bias, 128
2025-04-02 02:23:17,860 [INFO] 	 model.layer2.2.conv2.weight, 147456
2025-04-02 02:23:17,860 [INFO] 	 model.layer2.2.bn2.weight, 128
2025-04-02 02:23:17,860 [INFO] 	 model.layer2.2.bn2.bias, 128
2025-04-02 02:23:17,860 [INFO] 	 model.layer2.2.conv3.weight, 65536
2025-04-02 02:23:17,860 [INFO] 	 model.layer2.2.bn3.weight, 512
2025-04-02 02:23:17,860 [INFO] 	 model.layer2.2.bn3.bias, 512
2025-04-02 02:23:17,860 [INFO] 	 model.layer2.3.conv1.weight, 65536
2025-04-02 02:23:17,860 [INFO] 	 model.layer2.3.bn1.weight, 128
2025-04-02 02:23:17,860 [INFO] 	 model.layer2.3.bn1.bias, 128
2025-04-02 02:23:17,860 [INFO] 	 model.layer2.3.conv2.weight, 147456
2025-04-02 02:23:17,860 [INFO] 	 model.layer2.3.bn2.weight, 128
2025-04-02 02:23:17,860 [INFO] 	 model.layer2.3.bn2.bias, 128
2025-04-02 02:23:17,860 [INFO] 	 model.layer2.3.conv3.weight, 65536
2025-04-02 02:23:17,860 [INFO] 	 model.layer2.3.bn3.weight, 512
2025-04-02 02:23:17,860 [INFO] 	 model.layer2.3.bn3.bias, 512
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.0.conv1.weight, 131072
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.0.bn1.weight, 256
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.0.bn1.bias, 256
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.0.conv2.weight, 589824
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.0.bn2.weight, 256
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.0.bn2.bias, 256
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.0.conv3.weight, 262144
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.0.bn3.weight, 1024
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.0.bn3.bias, 1024
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.0.downsample.0.weight, 524288
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.0.downsample.1.weight, 1024
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.0.downsample.1.bias, 1024
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.1.conv1.weight, 262144
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.1.bn1.weight, 256
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.1.bn1.bias, 256
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.1.conv2.weight, 589824
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.1.bn2.weight, 256
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.1.bn2.bias, 256
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.1.conv3.weight, 262144
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.1.bn3.weight, 1024
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.1.bn3.bias, 1024
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.2.conv1.weight, 262144
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.2.bn1.weight, 256
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.2.bn1.bias, 256
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.2.conv2.weight, 589824
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.2.bn2.weight, 256
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.2.bn2.bias, 256
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.2.conv3.weight, 262144
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.2.bn3.weight, 1024
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.2.bn3.bias, 1024
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.3.conv1.weight, 262144
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.3.bn1.weight, 256
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.3.bn1.bias, 256
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.3.conv2.weight, 589824
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.3.bn2.weight, 256
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.3.bn2.bias, 256
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.3.conv3.weight, 262144
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.3.bn3.weight, 1024
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.3.bn3.bias, 1024
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.4.conv1.weight, 262144
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.4.bn1.weight, 256
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.4.bn1.bias, 256
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.4.conv2.weight, 589824
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.4.bn2.weight, 256
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.4.bn2.bias, 256
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.4.conv3.weight, 262144
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.4.bn3.weight, 1024
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.4.bn3.bias, 1024
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.5.conv1.weight, 262144
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.5.bn1.weight, 256
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.5.bn1.bias, 256
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.5.conv2.weight, 589824
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.5.bn2.weight, 256
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.5.bn2.bias, 256
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.5.conv3.weight, 262144
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.5.bn3.weight, 1024
2025-04-02 02:23:17,860 [INFO] 	 model.layer3.5.bn3.bias, 1024
2025-04-02 02:23:17,860 [INFO] 	 model.layer4.0.conv1.weight, 524288
2025-04-02 02:23:17,860 [INFO] 	 model.layer4.0.bn1.weight, 512
2025-04-02 02:23:17,860 [INFO] 	 model.layer4.0.bn1.bias, 512
2025-04-02 02:23:17,860 [INFO] 	 model.layer4.0.conv2.weight, 2359296
2025-04-02 02:23:17,861 [INFO] 	 model.layer4.0.bn2.weight, 512
2025-04-02 02:23:17,861 [INFO] 	 model.layer4.0.bn2.bias, 512
2025-04-02 02:23:17,861 [INFO] 	 model.layer4.0.conv3.weight, 1048576
2025-04-02 02:23:17,861 [INFO] 	 model.layer4.0.bn3.weight, 2048
2025-04-02 02:23:17,861 [INFO] 	 model.layer4.0.bn3.bias, 2048
2025-04-02 02:23:17,861 [INFO] 	 model.layer4.0.downsample.0.weight, 2097152
2025-04-02 02:23:17,861 [INFO] 	 model.layer4.0.downsample.1.weight, 2048
2025-04-02 02:23:17,861 [INFO] 	 model.layer4.0.downsample.1.bias, 2048
2025-04-02 02:23:17,861 [INFO] 	 model.layer4.1.conv1.weight, 1048576
2025-04-02 02:23:17,861 [INFO] 	 model.layer4.1.bn1.weight, 512
2025-04-02 02:23:17,861 [INFO] 	 model.layer4.1.bn1.bias, 512
2025-04-02 02:23:17,861 [INFO] 	 model.layer4.1.conv2.weight, 2359296
2025-04-02 02:23:17,861 [INFO] 	 model.layer4.1.bn2.weight, 512
2025-04-02 02:23:17,861 [INFO] 	 model.layer4.1.bn2.bias, 512
2025-04-02 02:23:17,861 [INFO] 	 model.layer4.1.conv3.weight, 1048576
2025-04-02 02:23:17,861 [INFO] 	 model.layer4.1.bn3.weight, 2048
2025-04-02 02:23:17,861 [INFO] 	 model.layer4.1.bn3.bias, 2048
2025-04-02 02:23:17,861 [INFO] 	 model.layer4.2.conv1.weight, 1048576
2025-04-02 02:23:17,861 [INFO] 	 model.layer4.2.bn1.weight, 512
2025-04-02 02:23:17,861 [INFO] 	 model.layer4.2.bn1.bias, 512
2025-04-02 02:23:17,861 [INFO] 	 model.layer4.2.conv2.weight, 2359296
2025-04-02 02:23:17,861 [INFO] 	 model.layer4.2.bn2.weight, 512
2025-04-02 02:23:17,861 [INFO] 	 model.layer4.2.bn2.bias, 512
2025-04-02 02:23:17,861 [INFO] 	 model.layer4.2.conv3.weight, 1048576
2025-04-02 02:23:17,861 [INFO] 	 model.layer4.2.bn3.weight, 2048
2025-04-02 02:23:17,861 [INFO] 	 model.layer4.2.bn3.bias, 2048
2025-04-02 02:23:17,861 [INFO] 	 heads.age.weight, 16384
2025-04-02 02:23:17,861 [INFO] 	 heads.age.bias, 8
2025-04-02 02:23:17,861 [INFO] Number of Learnable Parameters: 23524424

2025-04-02 02:23:17,862 [INFO] Model(
  (model): ResNet(
    (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (4): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (5): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (fc): Identity()
  )
  (heads): ModuleDict(
    (age): Linear(in_features=2048, out_features=8, bias=True)
  )
)
2025-04-02 02:23:17,862 [INFO] Number of trn data 10048
2025-04-02 02:23:17,862 [INFO] Number of val data 4380
2025-04-02 02:23:17,869 [INFO] Epoch 0/9
2025-04-02 02:23:17,869 [INFO] ----------------------------------------
2025-04-02 02:23:35,414 [INFO] [trn phase]
2025-04-02 02:23:35,415 [INFO] error: 2.0561 age_error:2.0561
2025-04-02 02:23:35,415 [INFO] loss: 0.6788 age_loss:0.6788
2025-04-02 02:23:43,731 [INFO] [val phase]
2025-04-02 02:23:43,731 [INFO] error: 1.9808 age_error:1.9808
2025-04-02 02:23:43,731 [INFO] loss: 0.5757 age_loss:0.5757
2025-04-02 02:23:43,731 [INFO] Best Epoch: 0
2025-04-02 02:23:44,266 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_0.pth
2025-04-02 02:23:44,306 [INFO] Epoch 1/9
2025-04-02 02:23:44,306 [INFO] ----------------------------------------
2025-04-02 02:24:01,140 [INFO] [trn phase]
2025-04-02 02:24:01,142 [INFO] error: 1.8454 age_error:1.8454
2025-04-02 02:24:01,142 [INFO] loss: 0.5269 age_loss:0.5269
2025-04-02 02:24:09,519 [INFO] [val phase]
2025-04-02 02:24:09,519 [INFO] error: 1.7858 age_error:1.7858
2025-04-02 02:24:09,520 [INFO] loss: 0.5760 age_loss:0.5760
2025-04-02 02:24:09,520 [INFO] Best Epoch: 1
2025-04-02 02:24:10,086 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_1.pth
2025-04-02 02:24:10,137 [INFO] Epoch 2/9
2025-04-02 02:24:10,137 [INFO] ----------------------------------------
2025-04-02 02:24:26,940 [INFO] [trn phase]
2025-04-02 02:24:26,943 [INFO] error: 1.6781 age_error:1.6781
2025-04-02 02:24:26,943 [INFO] loss: 0.4690 age_loss:0.4690
2025-04-02 02:24:35,306 [INFO] [val phase]
2025-04-02 02:24:35,306 [INFO] error: 1.6916 age_error:1.6916
2025-04-02 02:24:35,306 [INFO] loss: 0.5913 age_loss:0.5913
2025-04-02 02:24:35,306 [INFO] Best Epoch: 2
2025-04-02 02:24:35,863 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_2.pth
2025-04-02 02:24:35,980 [INFO] Epoch 3/9
2025-04-02 02:24:35,980 [INFO] ----------------------------------------
2025-04-02 02:24:52,966 [INFO] [trn phase]
2025-04-02 02:24:52,969 [INFO] error: 1.5255 age_error:1.5255
2025-04-02 02:24:52,969 [INFO] loss: 0.4122 age_loss:0.4122
2025-04-02 02:25:01,392 [INFO] [val phase]
2025-04-02 02:25:01,392 [INFO] error: 1.7573 age_error:1.7573
2025-04-02 02:25:01,392 [INFO] loss: 0.6011 age_loss:0.6011
2025-04-02 02:25:01,392 [INFO] Best Epoch: 2
2025-04-02 02:25:01,952 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_3.pth
2025-04-02 02:25:02,025 [INFO] Epoch 4/9
2025-04-02 02:25:02,025 [INFO] ----------------------------------------
2025-04-02 02:25:19,181 [INFO] [trn phase]
2025-04-02 02:25:19,183 [INFO] error: 1.3688 age_error:1.3688
2025-04-02 02:25:19,183 [INFO] loss: 0.3504 age_loss:0.3504
2025-04-02 02:25:27,719 [INFO] [val phase]
2025-04-02 02:25:27,719 [INFO] error: 1.6167 age_error:1.6167
2025-04-02 02:25:27,719 [INFO] loss: 0.6600 age_loss:0.6600
2025-04-02 02:25:27,719 [INFO] Best Epoch: 4
2025-04-02 02:25:28,287 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_4.pth
2025-04-02 02:25:28,371 [INFO] Epoch 5/9
2025-04-02 02:25:28,371 [INFO] ----------------------------------------
2025-04-02 02:25:45,417 [INFO] [trn phase]
2025-04-02 02:25:45,420 [INFO] error: 1.2076 age_error:1.2076
2025-04-02 02:25:45,420 [INFO] loss: 0.3028 age_loss:0.3028
2025-04-02 02:25:53,758 [INFO] [val phase]
2025-04-02 02:25:53,758 [INFO] error: 1.7221 age_error:1.7221
2025-04-02 02:25:53,758 [INFO] loss: 0.6553 age_loss:0.6553
2025-04-02 02:25:53,758 [INFO] Best Epoch: 4
2025-04-02 02:25:54,326 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_5.pth
2025-04-02 02:25:54,421 [INFO] Epoch 6/9
2025-04-02 02:25:54,421 [INFO] ----------------------------------------
2025-04-02 02:26:12,282 [INFO] [trn phase]
2025-04-02 02:26:12,285 [INFO] error: 1.0814 age_error:1.0814
2025-04-02 02:26:12,285 [INFO] loss: 0.2637 age_loss:0.2637
2025-04-02 02:26:20,638 [INFO] [val phase]
2025-04-02 02:26:20,638 [INFO] error: 1.6632 age_error:1.6632
2025-04-02 02:26:20,638 [INFO] loss: 0.6671 age_loss:0.6671
2025-04-02 02:26:20,638 [INFO] Best Epoch: 4
2025-04-02 02:26:21,260 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_6.pth
2025-04-02 02:26:21,366 [INFO] Epoch 7/9
2025-04-02 02:26:21,366 [INFO] ----------------------------------------
2025-04-02 02:26:38,407 [INFO] [trn phase]
2025-04-02 02:26:38,409 [INFO] error: 0.9636 age_error:0.9636
2025-04-02 02:26:38,409 [INFO] loss: 0.2274 age_loss:0.2274
2025-04-02 02:26:46,837 [INFO] [val phase]
2025-04-02 02:26:46,837 [INFO] error: 1.5922 age_error:1.5922
2025-04-02 02:26:46,837 [INFO] loss: 0.7001 age_loss:0.7001
2025-04-02 02:26:46,837 [INFO] Best Epoch: 7
2025-04-02 02:26:47,404 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_7.pth
2025-04-02 02:26:47,521 [INFO] Epoch 8/9
2025-04-02 02:26:47,521 [INFO] ----------------------------------------
2025-04-02 02:27:04,456 [INFO] [trn phase]
2025-04-02 02:27:04,457 [INFO] error: 0.8943 age_error:0.8943
2025-04-02 02:27:04,457 [INFO] loss: 0.2028 age_loss:0.2028
2025-04-02 02:27:12,816 [INFO] [val phase]
2025-04-02 02:27:12,816 [INFO] error: 1.3970 age_error:1.3970
2025-04-02 02:27:12,816 [INFO] loss: 0.7753 age_loss:0.7753
2025-04-02 02:27:12,816 [INFO] Best Epoch: 8
2025-04-02 02:27:13,378 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_8.pth
2025-04-02 02:27:13,508 [INFO] Epoch 9/9
2025-04-02 02:27:13,508 [INFO] ----------------------------------------
2025-04-02 02:27:30,863 [INFO] [trn phase]
2025-04-02 02:27:30,865 [INFO] error: 0.8105 age_error:0.8105
2025-04-02 02:27:30,865 [INFO] loss: 0.1764 age_loss:0.1764
2025-04-02 02:27:39,261 [INFO] [val phase]
2025-04-02 02:27:39,261 [INFO] error: 1.4870 age_error:1.4870
2025-04-02 02:27:39,261 [INFO] loss: 0.7330 age_loss:0.7330
2025-04-02 02:27:39,261 [INFO] Best Epoch: 8
2025-04-02 02:27:39,825 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_9.pth
2025-04-02 02:27:40,023 [INFO] Training complete in 4m 22s
2025-04-02 02:27:40,023 [INFO] Best epoch: 8
2025-04-02 02:28:09,591 [INFO] Model evalution:
2025-04-02 02:28:09,592 [INFO] [trn set]
2025-04-02 02:28:09,592 [INFO] age (mae): 0.6787
2025-04-02 02:28:09,592 [INFO] [val set]
2025-04-02 02:28:09,592 [INFO] age (mae): 1.3986
2025-04-02 02:28:09,592 [INFO] [tst set]
2025-04-02 02:28:09,592 [INFO] age (mae): 1.0192
2025-04-02 02:41:03,653 [INFO] {'data': {'benchmark': 'facebase/benchmarks/Adience.yaml', 'img_dir': '../datasets/', 'output_dir': 'facebase/results/', 'data_dir': 'facebase/data/'}, 'heads': [{'tag': 'age', 'type': 'cjs', 'attribute': 'age', 'labels': [[0], [1], [2], [3], [4], [5], [6], [7]], 'weight': 1, 'metric': ['mae', 'cs5'], 'visual_metric': [{'tag': 'mae'}, {'tag': 'bias'}, {'tag': 'prc', 'target_class': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], 'target_class_name': 'child 0-17', 'target_class_prior': [0.1, 0.2, 0.3]}]}], 'model': {'architecture': 'resnet50', 'use_pretrained': True, 'input_size': [256, 256]}, 'optimizer': {'num_workers': 8, 'num_epochs': 15, 'batch_size': 100, 'improve_patience': 50, 'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'algo': 'adam', 'use_amp': True}, 'preprocess': {'bbox_extension': [0, 0], 'input_extension': [0.05, 0.05], 'trn': {'path': 'lib/augmentation_configs/256x256/jitter+hflip.json'}, 'val': {'path': 'lib/augmentation_configs/256x256/resize_normalize.json'}}, 'training': {'mode': 'noisy', 'base_sigma': 0.75, 'alpha': 0.1, 'beta': 0.8}}
2025-04-02 02:41:03,663 [INFO] running on: cuda:0
2025-04-02 02:41:04,031 [INFO] Model(
  (model): ResNet(
    (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (4): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (5): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (fc): Identity()
  )
  (heads): ModuleDict(
    (age): Linear(in_features=2048, out_features=8, bias=True)
  )
)
2025-04-02 02:41:04,031 [INFO] Number of trn data 10048
2025-04-02 02:41:04,031 [INFO] Number of val data 4380
2025-04-02 02:41:04,347 [INFO] Epoch 10/14
2025-04-02 02:41:04,347 [INFO] ----------------------------------------
2025-04-02 02:41:22,242 [INFO] [trn phase]
2025-04-02 02:41:22,243 [INFO] error: 0.7144 age_error:0.7144
2025-04-02 02:41:22,243 [INFO] loss: 0.1437 age_loss:0.1437
2025-04-02 02:41:30,833 [INFO] [val phase]
2025-04-02 02:41:30,833 [INFO] error: 1.4450 age_error:1.4450
2025-04-02 02:41:30,833 [INFO] loss: 0.7371 age_loss:0.7371
2025-04-02 02:41:30,833 [INFO] Best Epoch: 8
2025-04-02 02:41:31,386 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_10.pth
2025-04-02 02:41:31,532 [INFO] Epoch 11/14
2025-04-02 02:41:31,533 [INFO] ----------------------------------------
2025-04-02 02:41:48,839 [INFO] [trn phase]
2025-04-02 02:41:48,841 [INFO] error: 0.6273 age_error:0.6273
2025-04-02 02:41:48,841 [INFO] loss: 0.1147 age_loss:0.1147
2025-04-02 02:41:57,216 [INFO] [val phase]
2025-04-02 02:41:57,216 [INFO] error: 1.4358 age_error:1.4358
2025-04-02 02:41:57,216 [INFO] loss: 0.7690 age_loss:0.7690
2025-04-02 02:41:57,216 [INFO] Best Epoch: 8
2025-04-02 02:41:57,776 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_11.pth
2025-04-02 02:41:57,937 [INFO] Epoch 12/14
2025-04-02 02:41:57,937 [INFO] ----------------------------------------
2025-04-02 02:42:14,962 [INFO] [trn phase]
2025-04-02 02:42:14,962 [INFO] error: 0.5702 age_error:0.5702
2025-04-02 02:42:14,962 [INFO] loss: 0.1020 age_loss:0.1020
2025-04-02 02:42:23,409 [INFO] [val phase]
2025-04-02 02:42:23,409 [INFO] error: 1.4470 age_error:1.4470
2025-04-02 02:42:23,410 [INFO] loss: 0.7214 age_loss:0.7214
2025-04-02 02:42:23,410 [INFO] Best Epoch: 8
2025-04-02 02:42:23,977 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_12.pth
2025-04-02 02:42:24,214 [INFO] Epoch 13/14
2025-04-02 02:42:24,214 [INFO] ----------------------------------------
2025-04-02 02:42:41,029 [INFO] [trn phase]
2025-04-02 02:42:41,031 [INFO] error: 0.5281 age_error:0.5281
2025-04-02 02:42:41,031 [INFO] loss: 0.0885 age_loss:0.0885
2025-04-02 02:42:49,412 [INFO] [val phase]
2025-04-02 02:42:49,412 [INFO] error: 1.4000 age_error:1.4000
2025-04-02 02:42:49,412 [INFO] loss: 0.7451 age_loss:0.7451
2025-04-02 02:42:49,412 [INFO] Best Epoch: 8
2025-04-02 02:42:49,999 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_13.pth
2025-04-02 02:42:50,195 [INFO] Epoch 14/14
2025-04-02 02:42:50,195 [INFO] ----------------------------------------
2025-04-02 02:43:07,159 [INFO] [trn phase]
2025-04-02 02:43:07,161 [INFO] error: 0.4632 age_error:0.4632
2025-04-02 02:43:07,161 [INFO] loss: 0.0757 age_loss:0.0757
2025-04-02 02:43:15,522 [INFO] [val phase]
2025-04-02 02:43:15,522 [INFO] error: 1.3970 age_error:1.3970
2025-04-02 02:43:15,522 [INFO] loss: 0.7569 age_loss:0.7569
2025-04-02 02:43:15,522 [INFO] Best Epoch: 8
2025-04-02 02:43:16,087 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_14.pth
2025-04-02 02:43:16,294 [INFO] Training complete in 2m 12s
2025-04-02 02:43:16,294 [INFO] Best epoch: 8
2025-04-02 02:43:45,812 [INFO] Model evalution:
2025-04-02 02:43:45,812 [INFO] [trn set]
2025-04-02 02:43:45,812 [INFO] age (mae): 0.6787
2025-04-02 02:43:45,812 [INFO] [val set]
2025-04-02 02:43:45,812 [INFO] age (mae): 1.3986
2025-04-02 02:43:45,812 [INFO] [tst set]
2025-04-02 02:43:45,812 [INFO] age (mae): 1.0192
2025-04-02 02:54:42,842 [INFO] {'data': {'benchmark': 'facebase/benchmarks/Adience.yaml', 'img_dir': '../datasets/', 'output_dir': 'facebase/results/', 'data_dir': 'facebase/data/'}, 'heads': [{'tag': 'age', 'type': 'cjs', 'attribute': 'age', 'labels': [[0], [1], [2], [3], [4], [5], [6], [7]], 'weight': 1, 'metric': ['mae', 'cs5'], 'visual_metric': [{'tag': 'mae'}, {'tag': 'bias'}, {'tag': 'prc', 'target_class': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], 'target_class_name': 'child 0-17', 'target_class_prior': [0.1, 0.2, 0.3]}]}], 'model': {'architecture': 'resnet50', 'use_pretrained': True, 'input_size': [256, 256]}, 'optimizer': {'num_workers': 8, 'num_epochs': 20, 'batch_size': 100, 'improve_patience': 50, 'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'algo': 'adam', 'use_amp': True}, 'preprocess': {'bbox_extension': [0, 0], 'input_extension': [0.05, 0.05], 'trn': {'path': 'lib/augmentation_configs/256x256/jitter+hflip.json'}, 'val': {'path': 'lib/augmentation_configs/256x256/resize_normalize.json'}}, 'training': {'mode': 'noisy', 'base_sigma': 0.75, 'alpha': 0.1, 'beta': 0.8}}
2025-04-02 02:54:42,852 [INFO] running on: cuda:0
2025-04-02 02:54:43,244 [INFO] Model(
  (model): ResNet(
    (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (4): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (5): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (fc): Identity()
  )
  (heads): ModuleDict(
    (age): Linear(in_features=2048, out_features=8, bias=True)
  )
)
2025-04-02 02:54:43,244 [INFO] Number of trn data 10048
2025-04-02 02:54:43,244 [INFO] Number of val data 4380
2025-04-02 02:54:43,593 [INFO] Epoch 15/19
2025-04-02 02:54:43,593 [INFO] ----------------------------------------
2025-04-02 02:55:01,454 [INFO] [trn phase]
2025-04-02 02:55:01,454 [INFO] error: 0.3870 age_error:0.3870
2025-04-02 02:55:01,454 [INFO] loss: 0.0510 age_loss:0.0510
2025-04-02 02:55:10,050 [INFO] [val phase]
2025-04-02 02:55:10,050 [INFO] error: 1.4228 age_error:1.4228
2025-04-02 02:55:10,050 [INFO] loss: 0.7307 age_loss:0.7307
2025-04-02 02:55:10,050 [INFO] Best Epoch: 8
2025-04-02 02:55:10,611 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_15.pth
2025-04-02 02:55:10,833 [INFO] Epoch 16/19
2025-04-02 02:55:10,833 [INFO] ----------------------------------------
2025-04-02 02:55:27,797 [INFO] [trn phase]
2025-04-02 02:55:27,799 [INFO] error: 0.3200 age_error:0.3200
2025-04-02 02:55:27,799 [INFO] loss: 0.0387 age_loss:0.0387
2025-04-02 02:55:36,395 [INFO] [val phase]
2025-04-02 02:55:36,395 [INFO] error: 1.3776 age_error:1.3776
2025-04-02 02:55:36,396 [INFO] loss: 0.7309 age_loss:0.7309
2025-04-02 02:55:36,396 [INFO] Best Epoch: 16
2025-04-02 02:55:36,973 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_16.pth
2025-04-02 02:55:37,208 [INFO] Epoch 17/19
2025-04-02 02:55:37,208 [INFO] ----------------------------------------
2025-04-02 02:55:54,329 [INFO] [trn phase]
2025-04-02 02:55:54,331 [INFO] error: 0.2819 age_error:0.2819
2025-04-02 02:55:54,331 [INFO] loss: 0.0352 age_loss:0.0352
2025-04-02 02:56:02,771 [INFO] [val phase]
2025-04-02 02:56:02,772 [INFO] error: 1.3751 age_error:1.3751
2025-04-02 02:56:02,772 [INFO] loss: 0.7443 age_loss:0.7443
2025-04-02 02:56:02,772 [INFO] Best Epoch: 17
2025-04-02 02:56:03,355 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_17.pth
2025-04-02 02:56:03,667 [INFO] Epoch 18/19
2025-04-02 02:56:03,667 [INFO] ----------------------------------------
2025-04-02 02:56:20,817 [INFO] [trn phase]
2025-04-02 02:56:20,820 [INFO] error: 0.2563 age_error:0.2563
2025-04-02 02:56:20,820 [INFO] loss: 0.0291 age_loss:0.0291
2025-04-02 02:56:29,268 [INFO] [val phase]
2025-04-02 02:56:29,268 [INFO] error: 1.3687 age_error:1.3687
2025-04-02 02:56:29,268 [INFO] loss: 0.7491 age_loss:0.7491
2025-04-02 02:56:29,268 [INFO] Best Epoch: 18
2025-04-02 02:56:29,836 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_18.pth
2025-04-02 02:56:30,103 [INFO] Epoch 19/19
2025-04-02 02:56:30,103 [INFO] ----------------------------------------
2025-04-02 02:56:47,049 [INFO] [trn phase]
2025-04-02 02:56:47,051 [INFO] error: 0.2267 age_error:0.2267
2025-04-02 02:56:47,051 [INFO] loss: 0.0256 age_loss:0.0256
2025-04-02 02:56:55,516 [INFO] [val phase]
2025-04-02 02:56:55,516 [INFO] error: 1.3715 age_error:1.3715
2025-04-02 02:56:55,516 [INFO] loss: 0.7352 age_loss:0.7352
2025-04-02 02:56:55,516 [INFO] Best Epoch: 18
2025-04-02 02:56:56,090 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_19.pth
2025-04-02 02:56:56,372 [INFO] Training complete in 2m 13s
2025-04-02 02:56:56,372 [INFO] Best epoch: 18
2025-04-02 02:57:25,945 [INFO] Model evalution:
2025-04-02 02:57:25,945 [INFO] [trn set]
2025-04-02 02:57:25,945 [INFO] age (mae): 0.3398
2025-04-02 02:57:25,945 [INFO] [val set]
2025-04-02 02:57:25,945 [INFO] age (mae): 1.3667
2025-04-02 02:57:25,945 [INFO] [tst set]
2025-04-02 02:57:25,945 [INFO] age (mae): 0.9725
2025-04-02 03:08:24,412 [INFO] {'data': {'benchmark': 'facebase/benchmarks/Adience.yaml', 'img_dir': '../datasets/', 'output_dir': 'facebase/results/', 'data_dir': 'facebase/data/'}, 'heads': [{'tag': 'age', 'type': 'cjs', 'attribute': 'age', 'labels': [[0], [1], [2], [3], [4], [5], [6], [7]], 'weight': 1, 'metric': ['mae', 'cs5'], 'visual_metric': [{'tag': 'mae'}, {'tag': 'bias'}, {'tag': 'prc', 'target_class': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], 'target_class_name': 'child 0-17', 'target_class_prior': [0.1, 0.2, 0.3]}]}], 'model': {'architecture': 'resnet50', 'use_pretrained': True, 'input_size': [256, 256]}, 'optimizer': {'num_workers': 8, 'num_epochs': 25, 'batch_size': 100, 'improve_patience': 50, 'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'algo': 'adam', 'use_amp': True}, 'preprocess': {'bbox_extension': [0, 0], 'input_extension': [0.05, 0.05], 'trn': {'path': 'lib/augmentation_configs/256x256/jitter+hflip.json'}, 'val': {'path': 'lib/augmentation_configs/256x256/resize_normalize.json'}}, 'training': {'mode': 'noisy', 'base_sigma': 0.75, 'alpha': 0.1, 'beta': 0.8}}
2025-04-02 03:08:24,431 [INFO] running on: cuda:0
2025-04-02 03:08:24,812 [INFO] Model(
  (model): ResNet(
    (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (4): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (5): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (fc): Identity()
  )
  (heads): ModuleDict(
    (age): Linear(in_features=2048, out_features=8, bias=True)
  )
)
2025-04-02 03:08:24,812 [INFO] Number of trn data 10048
2025-04-02 03:08:24,812 [INFO] Number of val data 4380
2025-04-02 03:08:25,177 [INFO] Epoch 20/24
2025-04-02 03:08:25,177 [INFO] ----------------------------------------
2025-04-02 03:08:42,895 [INFO] [trn phase]
2025-04-02 03:08:42,895 [INFO] error: 0.1946 age_error:0.1946
2025-04-02 03:08:42,895 [INFO] loss: 0.0198 age_loss:0.0198
2025-04-02 03:08:51,653 [INFO] [val phase]
2025-04-02 03:08:51,653 [INFO] error: 1.3648 age_error:1.3648
2025-04-02 03:08:51,653 [INFO] loss: 0.7303 age_loss:0.7303
2025-04-02 03:08:51,653 [INFO] Best Epoch: 20
2025-04-02 03:08:52,204 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_20.pth
2025-04-02 03:08:52,495 [INFO] Epoch 21/24
2025-04-02 03:08:52,495 [INFO] ----------------------------------------
2025-04-02 03:09:09,762 [INFO] [trn phase]
2025-04-02 03:09:09,764 [INFO] error: 0.1629 age_error:0.1629
2025-04-02 03:09:09,764 [INFO] loss: 0.0160 age_loss:0.0160
2025-04-02 03:09:18,291 [INFO] [val phase]
2025-04-02 03:09:18,291 [INFO] error: 1.3500 age_error:1.3500
2025-04-02 03:09:18,291 [INFO] loss: 0.7291 age_loss:0.7291
2025-04-02 03:09:18,291 [INFO] Best Epoch: 21
2025-04-02 03:09:18,853 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_21.pth
2025-04-02 03:09:19,159 [INFO] Epoch 22/24
2025-04-02 03:09:19,159 [INFO] ----------------------------------------
2025-04-02 03:09:36,150 [INFO] [trn phase]
2025-04-02 03:09:36,152 [INFO] error: 0.1661 age_error:0.1661
2025-04-02 03:09:36,152 [INFO] loss: 0.0170 age_loss:0.0170
2025-04-02 03:09:44,517 [INFO] [val phase]
2025-04-02 03:09:44,517 [INFO] error: 1.3717 age_error:1.3717
2025-04-02 03:09:44,517 [INFO] loss: 0.7259 age_loss:0.7259
2025-04-02 03:09:44,517 [INFO] Best Epoch: 21
2025-04-02 03:09:45,079 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_22.pth
2025-04-02 03:09:45,463 [INFO] Epoch 23/24
2025-04-02 03:09:45,463 [INFO] ----------------------------------------
2025-04-02 03:10:02,586 [INFO] [trn phase]
2025-04-02 03:10:02,588 [INFO] error: 0.1582 age_error:0.1582
2025-04-02 03:10:02,588 [INFO] loss: 0.0151 age_loss:0.0151
2025-04-02 03:10:10,976 [INFO] [val phase]
2025-04-02 03:10:10,976 [INFO] error: 1.3269 age_error:1.3269
2025-04-02 03:10:10,976 [INFO] loss: 0.7515 age_loss:0.7515
2025-04-02 03:10:10,976 [INFO] Best Epoch: 23
2025-04-02 03:10:11,550 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_23.pth
2025-04-02 03:10:11,894 [INFO] Epoch 24/24
2025-04-02 03:10:11,894 [INFO] ----------------------------------------
2025-04-02 03:10:28,807 [INFO] [trn phase]
2025-04-02 03:10:28,807 [INFO] error: 0.1384 age_error:0.1384
2025-04-02 03:10:28,807 [INFO] loss: 0.0133 age_loss:0.0133
2025-04-02 03:10:37,224 [INFO] [val phase]
2025-04-02 03:10:37,224 [INFO] error: 1.3765 age_error:1.3765
2025-04-02 03:10:37,224 [INFO] loss: 0.7430 age_loss:0.7430
2025-04-02 03:10:37,224 [INFO] Best Epoch: 23
2025-04-02 03:10:37,788 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_24.pth
2025-04-02 03:10:38,142 [INFO] Training complete in 2m 13s
2025-04-02 03:10:38,142 [INFO] Best epoch: 23
2025-04-02 03:11:08,223 [INFO] Model evalution:
2025-04-02 03:11:08,224 [INFO] [trn set]
2025-04-02 03:11:08,224 [INFO] age (mae): 0.3529
2025-04-02 03:11:08,224 [INFO] [val set]
2025-04-02 03:11:08,224 [INFO] age (mae): 1.3215
2025-04-02 03:11:08,224 [INFO] [tst set]
2025-04-02 03:11:08,224 [INFO] age (mae): 0.9429
2025-04-02 03:22:08,817 [INFO] {'data': {'benchmark': 'facebase/benchmarks/Adience.yaml', 'img_dir': '../datasets/', 'output_dir': 'facebase/results/', 'data_dir': 'facebase/data/'}, 'heads': [{'tag': 'age', 'type': 'cjs', 'attribute': 'age', 'labels': [[0], [1], [2], [3], [4], [5], [6], [7]], 'weight': 1, 'metric': ['mae', 'cs5'], 'visual_metric': [{'tag': 'mae'}, {'tag': 'bias'}, {'tag': 'prc', 'target_class': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], 'target_class_name': 'child 0-17', 'target_class_prior': [0.1, 0.2, 0.3]}]}], 'model': {'architecture': 'resnet50', 'use_pretrained': True, 'input_size': [256, 256]}, 'optimizer': {'num_workers': 8, 'num_epochs': 30, 'batch_size': 100, 'improve_patience': 50, 'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'algo': 'adam', 'use_amp': True}, 'preprocess': {'bbox_extension': [0, 0], 'input_extension': [0.05, 0.05], 'trn': {'path': 'lib/augmentation_configs/256x256/jitter+hflip.json'}, 'val': {'path': 'lib/augmentation_configs/256x256/resize_normalize.json'}}, 'training': {'mode': 'noisy', 'base_sigma': 0.75, 'alpha': 0.1, 'beta': 0.8}}
2025-04-02 03:22:08,836 [INFO] running on: cuda:0
2025-04-02 03:22:09,205 [INFO] Model(
  (model): ResNet(
    (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (4): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (5): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (fc): Identity()
  )
  (heads): ModuleDict(
    (age): Linear(in_features=2048, out_features=8, bias=True)
  )
)
2025-04-02 03:22:09,206 [INFO] Number of trn data 10048
2025-04-02 03:22:09,206 [INFO] Number of val data 4380
2025-04-02 03:22:09,593 [INFO] Epoch 25/29
2025-04-02 03:22:09,593 [INFO] ----------------------------------------
2025-04-02 03:22:27,373 [INFO] [trn phase]
2025-04-02 03:22:27,374 [INFO] error: 0.1305 age_error:0.1305
2025-04-02 03:22:27,374 [INFO] loss: 0.0110 age_loss:0.0110
2025-04-02 03:22:36,052 [INFO] [val phase]
2025-04-02 03:22:36,052 [INFO] error: 1.3427 age_error:1.3427
2025-04-02 03:22:36,052 [INFO] loss: 0.6833 age_loss:0.6833
2025-04-02 03:22:36,052 [INFO] Best Epoch: 23
2025-04-02 03:22:36,609 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_25.pth
2025-04-02 03:22:36,984 [INFO] Epoch 26/29
2025-04-02 03:22:36,984 [INFO] ----------------------------------------
2025-04-02 03:22:53,856 [INFO] [trn phase]
2025-04-02 03:22:53,858 [INFO] error: 0.1278 age_error:0.1278
2025-04-02 03:22:53,858 [INFO] loss: 0.0108 age_loss:0.0108
2025-04-02 03:23:02,269 [INFO] [val phase]
2025-04-02 03:23:02,270 [INFO] error: 1.3696 age_error:1.3696
2025-04-02 03:23:02,270 [INFO] loss: 0.7039 age_loss:0.7039
2025-04-02 03:23:02,270 [INFO] Best Epoch: 23
2025-04-02 03:23:02,851 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_26.pth
2025-04-02 03:23:03,236 [INFO] Epoch 27/29
2025-04-02 03:23:03,236 [INFO] ----------------------------------------
2025-04-02 03:23:20,346 [INFO] [trn phase]
2025-04-02 03:23:20,346 [INFO] error: 0.1453 age_error:0.1453
2025-04-02 03:23:20,346 [INFO] loss: 0.0128 age_loss:0.0128
2025-04-02 03:23:28,701 [INFO] [val phase]
2025-04-02 03:23:28,701 [INFO] error: 1.3288 age_error:1.3288
2025-04-02 03:23:28,701 [INFO] loss: 0.6874 age_loss:0.6874
2025-04-02 03:23:28,701 [INFO] Best Epoch: 23
2025-04-02 03:23:29,273 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_27.pth
2025-04-02 03:23:29,746 [INFO] Epoch 28/29
2025-04-02 03:23:29,747 [INFO] ----------------------------------------
2025-04-02 03:23:46,949 [INFO] [trn phase]
2025-04-02 03:23:46,951 [INFO] error: 0.1440 age_error:0.1440
2025-04-02 03:23:46,951 [INFO] loss: 0.0120 age_loss:0.0120
2025-04-02 03:23:55,337 [INFO] [val phase]
2025-04-02 03:23:55,337 [INFO] error: 1.3329 age_error:1.3329
2025-04-02 03:23:55,338 [INFO] loss: 0.7148 age_loss:0.7148
2025-04-02 03:23:55,338 [INFO] Best Epoch: 23
2025-04-02 03:23:55,906 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_28.pth
2025-04-02 03:23:56,328 [INFO] Epoch 29/29
2025-04-02 03:23:56,328 [INFO] ----------------------------------------
2025-04-02 03:24:13,376 [INFO] [trn phase]
2025-04-02 03:24:13,379 [INFO] error: 0.1462 age_error:0.1462
2025-04-02 03:24:13,379 [INFO] loss: 0.0122 age_loss:0.0122
2025-04-02 03:24:21,804 [INFO] [val phase]
2025-04-02 03:24:21,804 [INFO] error: 1.3683 age_error:1.3683
2025-04-02 03:24:21,804 [INFO] loss: 0.7182 age_loss:0.7182
2025-04-02 03:24:21,804 [INFO] Best Epoch: 23
2025-04-02 03:24:22,376 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_29.pth
2025-04-02 03:24:22,815 [INFO] Training complete in 2m 14s
2025-04-02 03:24:22,815 [INFO] Best epoch: 23
2025-04-02 03:24:52,352 [INFO] Model evalution:
2025-04-02 03:24:52,352 [INFO] [trn set]
2025-04-02 03:24:52,352 [INFO] age (mae): 0.3474
2025-04-02 03:24:52,352 [INFO] [val set]
2025-04-02 03:24:52,352 [INFO] age (mae): 1.3039
2025-04-02 03:24:52,352 [INFO] [tst set]
2025-04-02 03:24:52,352 [INFO] age (mae): 0.9429
2025-04-02 03:35:53,482 [INFO] {'data': {'benchmark': 'facebase/benchmarks/Adience.yaml', 'img_dir': '../datasets/', 'output_dir': 'facebase/results/', 'data_dir': 'facebase/data/'}, 'heads': [{'tag': 'age', 'type': 'cjs', 'attribute': 'age', 'labels': [[0], [1], [2], [3], [4], [5], [6], [7]], 'weight': 1, 'metric': ['mae', 'cs5'], 'visual_metric': [{'tag': 'mae'}, {'tag': 'bias'}, {'tag': 'prc', 'target_class': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], 'target_class_name': 'child 0-17', 'target_class_prior': [0.1, 0.2, 0.3]}]}], 'model': {'architecture': 'resnet50', 'use_pretrained': True, 'input_size': [256, 256]}, 'optimizer': {'num_workers': 8, 'num_epochs': 35, 'batch_size': 100, 'improve_patience': 50, 'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'algo': 'adam', 'use_amp': True}, 'preprocess': {'bbox_extension': [0, 0], 'input_extension': [0.05, 0.05], 'trn': {'path': 'lib/augmentation_configs/256x256/jitter+hflip.json'}, 'val': {'path': 'lib/augmentation_configs/256x256/resize_normalize.json'}}, 'training': {'mode': 'noisy', 'base_sigma': 0.75, 'alpha': 0.1, 'beta': 0.8}}
2025-04-02 03:35:53,493 [INFO] running on: cuda:0
2025-04-02 03:35:53,879 [INFO] Model(
  (model): ResNet(
    (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (4): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (5): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (fc): Identity()
  )
  (heads): ModuleDict(
    (age): Linear(in_features=2048, out_features=8, bias=True)
  )
)
2025-04-02 03:35:53,879 [INFO] Number of trn data 10048
2025-04-02 03:35:53,879 [INFO] Number of val data 4380
2025-04-02 03:35:54,285 [INFO] Epoch 30/34
2025-04-02 03:35:54,285 [INFO] ----------------------------------------
2025-04-02 03:36:12,200 [INFO] [trn phase]
2025-04-02 03:36:12,200 [INFO] error: 0.1415 age_error:0.1415
2025-04-02 03:36:12,200 [INFO] loss: 0.0110 age_loss:0.0110
2025-04-02 03:36:20,937 [INFO] [val phase]
2025-04-02 03:36:20,937 [INFO] error: 1.3292 age_error:1.3292
2025-04-02 03:36:20,937 [INFO] loss: 0.6591 age_loss:0.6591
2025-04-02 03:36:20,937 [INFO] Best Epoch: 23
2025-04-02 03:36:21,496 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_30.pth
2025-04-02 03:36:21,934 [INFO] Epoch 31/34
2025-04-02 03:36:21,934 [INFO] ----------------------------------------
2025-04-02 03:36:38,742 [INFO] [trn phase]
2025-04-02 03:36:38,744 [INFO] error: 0.1465 age_error:0.1465
2025-04-02 03:36:38,744 [INFO] loss: 0.0107 age_loss:0.0107
2025-04-02 03:36:47,152 [INFO] [val phase]
2025-04-02 03:36:47,152 [INFO] error: 1.3941 age_error:1.3941
2025-04-02 03:36:47,152 [INFO] loss: 0.6735 age_loss:0.6735
2025-04-02 03:36:47,152 [INFO] Best Epoch: 23
2025-04-02 03:36:47,728 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_31.pth
2025-04-02 03:36:48,185 [INFO] Epoch 32/34
2025-04-02 03:36:48,185 [INFO] ----------------------------------------
2025-04-02 03:37:05,182 [INFO] [trn phase]
2025-04-02 03:37:05,184 [INFO] error: 0.1777 age_error:0.1777
2025-04-02 03:37:05,184 [INFO] loss: 0.0140 age_loss:0.0140
2025-04-02 03:37:13,593 [INFO] [val phase]
2025-04-02 03:37:13,593 [INFO] error: 1.3345 age_error:1.3345
2025-04-02 03:37:13,593 [INFO] loss: 0.6368 age_loss:0.6368
2025-04-02 03:37:13,593 [INFO] Best Epoch: 23
2025-04-02 03:37:14,169 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_32.pth
2025-04-02 03:37:14,705 [INFO] Epoch 33/34
2025-04-02 03:37:14,705 [INFO] ----------------------------------------
2025-04-02 03:37:31,843 [INFO] [trn phase]
2025-04-02 03:37:31,845 [INFO] error: 0.1743 age_error:0.1743
2025-04-02 03:37:31,845 [INFO] loss: 0.0137 age_loss:0.0137
2025-04-02 03:37:40,241 [INFO] [val phase]
2025-04-02 03:37:40,241 [INFO] error: 1.3479 age_error:1.3479
2025-04-02 03:37:40,241 [INFO] loss: 0.6506 age_loss:0.6506
2025-04-02 03:37:40,241 [INFO] Best Epoch: 23
2025-04-02 03:37:40,814 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_33.pth
2025-04-02 03:37:41,310 [INFO] Epoch 34/34
2025-04-02 03:37:41,310 [INFO] ----------------------------------------
2025-04-02 03:37:58,615 [INFO] [trn phase]
2025-04-02 03:37:58,617 [INFO] error: 0.1831 age_error:0.1831
2025-04-02 03:37:58,617 [INFO] loss: 0.0151 age_loss:0.0151
2025-04-02 03:38:06,979 [INFO] [val phase]
2025-04-02 03:38:06,979 [INFO] error: 1.3283 age_error:1.3283
2025-04-02 03:38:06,979 [INFO] loss: 0.6726 age_loss:0.6726
2025-04-02 03:38:06,979 [INFO] Best Epoch: 23
2025-04-02 03:38:07,545 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_34.pth
2025-04-02 03:38:08,055 [INFO] Training complete in 2m 14s
2025-04-02 03:38:08,055 [INFO] Best epoch: 23
2025-04-02 03:38:37,859 [INFO] Model evalution:
2025-04-02 03:38:37,859 [INFO] [trn set]
2025-04-02 03:38:37,859 [INFO] age (mae): 0.3400
2025-04-02 03:38:37,859 [INFO] [val set]
2025-04-02 03:38:37,859 [INFO] age (mae): 1.2760
2025-04-02 03:38:37,859 [INFO] [tst set]
2025-04-02 03:38:37,859 [INFO] age (mae): 0.9429
2025-04-02 03:49:42,837 [INFO] {'data': {'benchmark': 'facebase/benchmarks/Adience.yaml', 'img_dir': '../datasets/', 'output_dir': 'facebase/results/', 'data_dir': 'facebase/data/'}, 'heads': [{'tag': 'age', 'type': 'cjs', 'attribute': 'age', 'labels': [[0], [1], [2], [3], [4], [5], [6], [7]], 'weight': 1, 'metric': ['mae', 'cs5'], 'visual_metric': [{'tag': 'mae'}, {'tag': 'bias'}, {'tag': 'prc', 'target_class': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], 'target_class_name': 'child 0-17', 'target_class_prior': [0.1, 0.2, 0.3]}]}], 'model': {'architecture': 'resnet50', 'use_pretrained': True, 'input_size': [256, 256]}, 'optimizer': {'num_workers': 8, 'num_epochs': 40, 'batch_size': 100, 'improve_patience': 50, 'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'algo': 'adam', 'use_amp': True}, 'preprocess': {'bbox_extension': [0, 0], 'input_extension': [0.05, 0.05], 'trn': {'path': 'lib/augmentation_configs/256x256/jitter+hflip.json'}, 'val': {'path': 'lib/augmentation_configs/256x256/resize_normalize.json'}}, 'training': {'mode': 'noisy', 'base_sigma': 0.75, 'alpha': 0.1, 'beta': 0.8}}
2025-04-02 03:49:42,856 [INFO] running on: cuda:0
2025-04-02 03:49:43,215 [INFO] Model(
  (model): ResNet(
    (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (4): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (5): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (fc): Identity()
  )
  (heads): ModuleDict(
    (age): Linear(in_features=2048, out_features=8, bias=True)
  )
)
2025-04-02 03:49:43,216 [INFO] Number of trn data 10048
2025-04-02 03:49:43,216 [INFO] Number of val data 4380
2025-04-02 03:49:43,652 [INFO] Epoch 35/39
2025-04-02 03:49:43,652 [INFO] ----------------------------------------
2025-04-02 03:50:01,640 [INFO] [trn phase]
2025-04-02 03:50:01,640 [INFO] error: 0.1851 age_error:0.1851
2025-04-02 03:50:01,640 [INFO] loss: 0.0125 age_loss:0.0125
2025-04-02 03:50:10,246 [INFO] [val phase]
2025-04-02 03:50:10,246 [INFO] error: 1.3233 age_error:1.3233
2025-04-02 03:50:10,246 [INFO] loss: 0.6201 age_loss:0.6201
2025-04-02 03:50:10,246 [INFO] Best Epoch: 35
2025-04-02 03:50:10,797 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_35.pth
2025-04-02 03:50:11,301 [INFO] Epoch 36/39
2025-04-02 03:50:11,301 [INFO] ----------------------------------------
2025-04-02 03:50:28,317 [INFO] [trn phase]
2025-04-02 03:50:28,319 [INFO] error: 0.1904 age_error:0.1904
2025-04-02 03:50:28,319 [INFO] loss: 0.0132 age_loss:0.0132
2025-04-02 03:50:36,749 [INFO] [val phase]
2025-04-02 03:50:36,749 [INFO] error: 1.3313 age_error:1.3313
2025-04-02 03:50:36,749 [INFO] loss: 0.6064 age_loss:0.6064
2025-04-02 03:50:36,749 [INFO] Best Epoch: 35
2025-04-02 03:50:37,313 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_36.pth
2025-04-02 03:50:37,834 [INFO] Epoch 37/39
2025-04-02 03:50:37,834 [INFO] ----------------------------------------
2025-04-02 03:50:54,842 [INFO] [trn phase]
2025-04-02 03:50:54,845 [INFO] error: 0.2265 age_error:0.2265
2025-04-02 03:50:54,845 [INFO] loss: 0.0167 age_loss:0.0167
2025-04-02 03:51:03,267 [INFO] [val phase]
2025-04-02 03:51:03,267 [INFO] error: 1.4491 age_error:1.4491
2025-04-02 03:51:03,267 [INFO] loss: 0.6427 age_loss:0.6427
2025-04-02 03:51:03,267 [INFO] Best Epoch: 35
2025-04-02 03:51:03,833 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_37.pth
2025-04-02 03:51:04,469 [INFO] Epoch 38/39
2025-04-02 03:51:04,469 [INFO] ----------------------------------------
2025-04-02 03:51:21,975 [INFO] [trn phase]
2025-04-02 03:51:21,977 [INFO] error: 0.2420 age_error:0.2420
2025-04-02 03:51:21,977 [INFO] loss: 0.0206 age_loss:0.0206
2025-04-02 03:51:30,364 [INFO] [val phase]
2025-04-02 03:51:30,364 [INFO] error: 1.3815 age_error:1.3815
2025-04-02 03:51:30,364 [INFO] loss: 0.6235 age_loss:0.6235
2025-04-02 03:51:30,364 [INFO] Best Epoch: 35
2025-04-02 03:51:30,937 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_38.pth
2025-04-02 03:51:31,507 [INFO] Epoch 39/39
2025-04-02 03:51:31,507 [INFO] ----------------------------------------
2025-04-02 03:51:48,458 [INFO] [trn phase]
2025-04-02 03:51:48,461 [INFO] error: 0.2548 age_error:0.2548
2025-04-02 03:51:48,461 [INFO] loss: 0.0235 age_loss:0.0235
2025-04-02 03:51:56,854 [INFO] [val phase]
2025-04-02 03:51:56,854 [INFO] error: 1.3365 age_error:1.3365
2025-04-02 03:51:56,854 [INFO] loss: 0.6437 age_loss:0.6437
2025-04-02 03:51:56,854 [INFO] Best Epoch: 35
2025-04-02 03:51:57,429 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_39.pth
2025-04-02 03:51:58,009 [INFO] Training complete in 2m 15s
2025-04-02 03:51:58,009 [INFO] Best epoch: 35
2025-04-02 03:52:27,315 [INFO] Model evalution:
2025-04-02 03:52:27,315 [INFO] [trn set]
2025-04-02 03:52:27,315 [INFO] age (mae): 0.2928
2025-04-02 03:52:27,315 [INFO] [val set]
2025-04-02 03:52:27,315 [INFO] age (mae): 1.2482
2025-04-02 03:52:27,315 [INFO] [tst set]
2025-04-02 03:52:27,315 [INFO] age (mae): 0.9154
2025-04-02 04:03:33,884 [INFO] {'data': {'benchmark': 'facebase/benchmarks/Adience.yaml', 'img_dir': '../datasets/', 'output_dir': 'facebase/results/', 'data_dir': 'facebase/data/'}, 'heads': [{'tag': 'age', 'type': 'cjs', 'attribute': 'age', 'labels': [[0], [1], [2], [3], [4], [5], [6], [7]], 'weight': 1, 'metric': ['mae', 'cs5'], 'visual_metric': [{'tag': 'mae'}, {'tag': 'bias'}, {'tag': 'prc', 'target_class': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], 'target_class_name': 'child 0-17', 'target_class_prior': [0.1, 0.2, 0.3]}]}], 'model': {'architecture': 'resnet50', 'use_pretrained': True, 'input_size': [256, 256]}, 'optimizer': {'num_workers': 8, 'num_epochs': 45, 'batch_size': 100, 'improve_patience': 50, 'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'algo': 'adam', 'use_amp': True}, 'preprocess': {'bbox_extension': [0, 0], 'input_extension': [0.05, 0.05], 'trn': {'path': 'lib/augmentation_configs/256x256/jitter+hflip.json'}, 'val': {'path': 'lib/augmentation_configs/256x256/resize_normalize.json'}}, 'training': {'mode': 'noisy', 'base_sigma': 0.75, 'alpha': 0.1, 'beta': 0.8}}
2025-04-02 04:03:33,894 [INFO] running on: cuda:0
2025-04-02 04:03:34,281 [INFO] Model(
  (model): ResNet(
    (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (4): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (5): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (fc): Identity()
  )
  (heads): ModuleDict(
    (age): Linear(in_features=2048, out_features=8, bias=True)
  )
)
2025-04-02 04:03:34,282 [INFO] Number of trn data 10048
2025-04-02 04:03:34,282 [INFO] Number of val data 4380
2025-04-02 04:03:34,749 [INFO] Epoch 40/44
2025-04-02 04:03:34,749 [INFO] ----------------------------------------
2025-04-02 04:03:52,551 [INFO] [trn phase]
2025-04-02 04:03:52,551 [INFO] error: 0.2800 age_error:0.2800
2025-04-02 04:03:52,551 [INFO] loss: 0.0259 age_loss:0.0259
2025-04-02 04:04:01,237 [INFO] [val phase]
2025-04-02 04:04:01,237 [INFO] error: 1.3338 age_error:1.3338
2025-04-02 04:04:01,237 [INFO] loss: 0.5683 age_loss:0.5683
2025-04-02 04:04:01,237 [INFO] Best Epoch: 35
2025-04-02 04:04:01,807 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_40.pth
2025-04-02 04:04:02,404 [INFO] Epoch 41/44
2025-04-02 04:04:02,404 [INFO] ----------------------------------------
2025-04-02 04:04:19,409 [INFO] [trn phase]
2025-04-02 04:04:19,412 [INFO] error: 0.3202 age_error:0.3202
2025-04-02 04:04:19,412 [INFO] loss: 0.0312 age_loss:0.0312
2025-04-02 04:04:27,809 [INFO] [val phase]
2025-04-02 04:04:27,809 [INFO] error: 1.3863 age_error:1.3863
2025-04-02 04:04:27,809 [INFO] loss: 0.6600 age_loss:0.6600
2025-04-02 04:04:27,809 [INFO] Best Epoch: 35
2025-04-02 04:04:28,379 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_41.pth
2025-04-02 04:04:28,998 [INFO] Epoch 42/44
2025-04-02 04:04:28,998 [INFO] ----------------------------------------
2025-04-02 04:04:46,037 [INFO] [trn phase]
2025-04-02 04:04:46,037 [INFO] error: 0.3816 age_error:0.3816
2025-04-02 04:04:46,037 [INFO] loss: 0.0491 age_loss:0.0491
2025-04-02 04:04:54,445 [INFO] [val phase]
2025-04-02 04:04:54,445 [INFO] error: 1.4043 age_error:1.4043
2025-04-02 04:04:54,446 [INFO] loss: 0.6665 age_loss:0.6665
2025-04-02 04:04:54,446 [INFO] Best Epoch: 35
2025-04-02 04:04:55,021 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_42.pth
2025-04-02 04:04:55,726 [INFO] Epoch 43/44
2025-04-02 04:04:55,726 [INFO] ----------------------------------------
2025-04-02 04:05:12,655 [INFO] [trn phase]
2025-04-02 04:05:12,657 [INFO] error: 0.5704 age_error:0.5704
2025-04-02 04:05:12,657 [INFO] loss: 0.0923 age_loss:0.0923
2025-04-02 04:05:21,064 [INFO] [val phase]
2025-04-02 04:05:21,064 [INFO] error: 1.4507 age_error:1.4507
2025-04-02 04:05:21,064 [INFO] loss: 0.6384 age_loss:0.6384
2025-04-02 04:05:21,064 [INFO] Best Epoch: 35
2025-04-02 04:05:21,636 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_43.pth
2025-04-02 04:05:22,295 [INFO] Epoch 44/44
2025-04-02 04:05:22,295 [INFO] ----------------------------------------
2025-04-02 04:05:39,727 [INFO] [trn phase]
2025-04-02 04:05:39,729 [INFO] error: 0.5596 age_error:0.5596
2025-04-02 04:05:39,729 [INFO] loss: 0.0881 age_loss:0.0881
2025-04-02 04:05:48,150 [INFO] [val phase]
2025-04-02 04:05:48,150 [INFO] error: 1.4361 age_error:1.4361
2025-04-02 04:05:48,150 [INFO] loss: 0.6061 age_loss:0.6061
2025-04-02 04:05:48,150 [INFO] Best Epoch: 35
2025-04-02 04:05:48,720 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_44.pth
2025-04-02 04:05:49,389 [INFO] Training complete in 2m 15s
2025-04-02 04:05:49,389 [INFO] Best epoch: 35
2025-04-02 04:06:18,979 [INFO] Model evalution:
2025-04-02 04:06:18,979 [INFO] [trn set]
2025-04-02 04:06:18,979 [INFO] age (mae): 0.2845
2025-04-02 04:06:18,979 [INFO] [val set]
2025-04-02 04:06:18,979 [INFO] age (mae): 1.2055
2025-04-02 04:06:18,979 [INFO] [tst set]
2025-04-02 04:06:18,979 [INFO] age (mae): 0.9154
2025-04-02 04:17:27,076 [INFO] {'data': {'benchmark': 'facebase/benchmarks/Adience.yaml', 'img_dir': '../datasets/', 'output_dir': 'facebase/results/', 'data_dir': 'facebase/data/'}, 'heads': [{'tag': 'age', 'type': 'cjs', 'attribute': 'age', 'labels': [[0], [1], [2], [3], [4], [5], [6], [7]], 'weight': 1, 'metric': ['mae', 'cs5'], 'visual_metric': [{'tag': 'mae'}, {'tag': 'bias'}, {'tag': 'prc', 'target_class': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], 'target_class_name': 'child 0-17', 'target_class_prior': [0.1, 0.2, 0.3]}]}], 'model': {'architecture': 'resnet50', 'use_pretrained': True, 'input_size': [256, 256]}, 'optimizer': {'num_workers': 8, 'num_epochs': 50, 'batch_size': 100, 'improve_patience': 50, 'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'algo': 'adam', 'use_amp': True}, 'preprocess': {'bbox_extension': [0, 0], 'input_extension': [0.05, 0.05], 'trn': {'path': 'lib/augmentation_configs/256x256/jitter+hflip.json'}, 'val': {'path': 'lib/augmentation_configs/256x256/resize_normalize.json'}}, 'training': {'mode': 'noisy', 'base_sigma': 0.75, 'alpha': 0.1, 'beta': 0.8}}
2025-04-02 04:17:27,086 [INFO] running on: cuda:0
2025-04-02 04:17:27,470 [INFO] Model(
  (model): ResNet(
    (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer2): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer3): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (3): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (4): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (5): Bottleneck(
        (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (layer4): Sequential(
      (0): Bottleneck(
        (conv1): Conv2d(1024, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (downsample): Sequential(
          (0): Conv2d(1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
      (2): Bottleneck(
        (conv1): Conv2d(2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (conv3): Conv2d(512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False)
        (bn3): BatchNorm2d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
      )
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (fc): Identity()
  )
  (heads): ModuleDict(
    (age): Linear(in_features=2048, out_features=8, bias=True)
  )
)
2025-04-02 04:17:27,471 [INFO] Number of trn data 10048
2025-04-02 04:17:27,471 [INFO] Number of val data 4380
2025-04-02 04:17:27,961 [INFO] Epoch 45/49
2025-04-02 04:17:27,961 [INFO] ----------------------------------------
2025-04-02 04:17:45,919 [INFO] [trn phase]
2025-04-02 04:17:45,919 [INFO] error: 0.4949 age_error:0.4949
2025-04-02 04:17:45,919 [INFO] loss: 0.0668 age_loss:0.0668
2025-04-02 04:17:54,660 [INFO] [val phase]
2025-04-02 04:17:54,660 [INFO] error: 1.3790 age_error:1.3790
2025-04-02 04:17:54,660 [INFO] loss: 0.5982 age_loss:0.5982
2025-04-02 04:17:54,660 [INFO] Best Epoch: 35
2025-04-02 04:17:55,217 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_45.pth
2025-04-02 04:17:55,900 [INFO] Epoch 46/49
2025-04-02 04:17:55,900 [INFO] ----------------------------------------
2025-04-02 04:18:12,837 [INFO] [trn phase]
2025-04-02 04:18:12,839 [INFO] error: 0.4286 age_error:0.4286
2025-04-02 04:18:12,839 [INFO] loss: 0.0468 age_loss:0.0468
2025-04-02 04:18:21,274 [INFO] [val phase]
2025-04-02 04:18:21,274 [INFO] error: 1.3824 age_error:1.3824
2025-04-02 04:18:21,274 [INFO] loss: 0.5759 age_loss:0.5759
2025-04-02 04:18:21,274 [INFO] Best Epoch: 35
2025-04-02 04:18:21,850 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_46.pth
2025-04-02 04:18:22,551 [INFO] Epoch 47/49
2025-04-02 04:18:22,551 [INFO] ----------------------------------------
2025-04-02 04:18:39,202 [INFO] [trn phase]
2025-04-02 04:18:39,205 [INFO] error: 0.3995 age_error:0.3995
2025-04-02 04:18:39,205 [INFO] loss: 0.0408 age_loss:0.0408
2025-04-02 04:18:47,717 [INFO] [val phase]
2025-04-02 04:18:47,717 [INFO] error: 1.3584 age_error:1.3584
2025-04-02 04:18:47,717 [INFO] loss: 0.5769 age_loss:0.5769
2025-04-02 04:18:47,717 [INFO] Best Epoch: 35
2025-04-02 04:18:48,291 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_47.pth
2025-04-02 04:18:49,080 [INFO] Epoch 48/49
2025-04-02 04:18:49,080 [INFO] ----------------------------------------
2025-04-02 04:19:06,210 [INFO] [trn phase]
2025-04-02 04:19:06,212 [INFO] error: 0.3371 age_error:0.3371
2025-04-02 04:19:06,212 [INFO] loss: 0.0268 age_loss:0.0268
2025-04-02 04:19:14,710 [INFO] [val phase]
2025-04-02 04:19:14,710 [INFO] error: 1.3479 age_error:1.3479
2025-04-02 04:19:14,710 [INFO] loss: 0.5500 age_loss:0.5500
2025-04-02 04:19:14,710 [INFO] Best Epoch: 35
2025-04-02 04:19:15,279 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_48.pth
2025-04-02 04:19:16,003 [INFO] Epoch 49/49
2025-04-02 04:19:16,003 [INFO] ----------------------------------------
2025-04-02 04:19:33,556 [INFO] [trn phase]
2025-04-02 04:19:33,559 [INFO] error: 0.2942 age_error:0.2942
2025-04-02 04:19:33,559 [INFO] loss: 0.0213 age_loss:0.0213
2025-04-02 04:19:41,990 [INFO] [val phase]
2025-04-02 04:19:41,990 [INFO] error: 1.3208 age_error:1.3208
2025-04-02 04:19:41,990 [INFO] loss: 0.5483 age_loss:0.5483
2025-04-02 04:19:41,990 [INFO] Best Epoch: 49
2025-04-02 04:19:42,568 [INFO] Checkpoint saved to facebase/results/Adience_256x256_resnet50_imagenet_noisy_cjs/split3/checkpoint_49.pth
2025-04-02 04:19:43,314 [INFO] Training complete in 2m 16s
2025-04-02 04:19:43,314 [INFO] Best epoch: 49
2025-04-02 04:20:12,795 [INFO] Model evalution:
2025-04-02 04:20:12,795 [INFO] [trn set]
2025-04-02 04:20:12,795 [INFO] age (mae): 0.3223
2025-04-02 04:20:12,795 [INFO] [val set]
2025-04-02 04:20:12,795 [INFO] age (mae): 1.1724
2025-04-02 04:20:12,795 [INFO] [tst set]
2025-04-02 04:20:12,795 [INFO] age (mae): 0.8916
